<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.5.0">Jekyll</generator><link href="//isapanah.com/feed.xml" rel="self" type="application/atom+xml" /><link href="//isapanah.com/" rel="alternate" type="text/html" /><updated>2018-04-13T15:27:16+04:30</updated><id>//isapanah.com/</id><title type="html">وبلاگ صدرا املشی</title><subtitle>سلام! من صدرا عیسی پناه املشی هستم. توسعه دهنده اپلیکیشن iOS و Android.
</subtitle><entry><title type="html">دسترسی به Nested Objectها در JavaScript</title><link href="//isapanah.com/2017/accessing-nested-objects-on-javascript" rel="alternate" type="text/html" title="دسترسی به Nested Objectها در JavaScript" /><published>2017-11-27T00:00:00+03:30</published><updated>2017-11-27T00:00:00+03:30</updated><id>//isapanah.com/2017/accessing-nested-objects-on-javascript</id><content type="html" xml:base="//isapanah.com/2017/accessing-nested-objects-on-javascript">&lt;p&gt;همونطور که احتمالا خیلی‌هاتون بامن هم‌عقیده هستین، جاوا اسکریپت زبان در دسترس، جالب و گاهی اوقات فوق‌العاده‌ایه. اما بعضی چیزا توی جاوا اسکریپت هست که واقعا عجیبه و غریبه! یکی از اون چیزا، وقتیه که سعی میکنیم یه آبجک نستد شده رو بگیریم و یهو این خطا به ما برمیگرده:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Cannot read property ‘foo’ of undefined&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;خیلی وقتایی که داریم در پروژه‌ جاوا اسکریپت کد میزینم، لازمه که از نستد آبجکت‌ها استفاده کرده و دیتا رو بطور امن دریافت کنیم، نه اینکه ازین خطاهای مزخرف بده و یکساعت بگردی ببینی کجای کارو اشتباه رفتی و چه مشکلی بوجود اومده.&lt;/p&gt;

&lt;p&gt;میخوایم ببینیم برای حل این مشکل چه کارایی میشه انجام داد، بیایید با یه مثال بریم جلوو، فرض کنین همچین آبجکتی داریم:&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kr&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;user&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;101&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;email&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'sadra@dev.com'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;personalInfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Sadra'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;line1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'kakh square'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;line2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'5 azar st'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;city&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'gorgan'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;na&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'GOLESTAN'&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;برای دسترسی به اسم یا شهر userمون اینجوری مینویسیم:&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kr&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;personalInfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kr&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;userCity&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;personalInfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;city&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;خب این ساده و مستقیمه.&lt;/p&gt;

&lt;p&gt;اما یه موقع‌هایی اصلا آبجکت user فیلدی به نام personalInfo نداره.  (الالخصوص وقتی داری با دیتابیس‌های non-relational مثل mongo کار میکنی). اونوق آبجکتت این شکلی میشه:&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kr&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;user&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;101&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;email&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'jack@dev.com'&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;خب حالا وقتی تلاش میکنی که به مقدار name دسترسی پیدا کنی، با خطای &lt;em&gt;Cannot read property ‘name’ of undefined&lt;/em&gt; مواجه میشی.&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kr&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;personalInfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// Cannot read property 'name' of undefined&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;این برای اینه که سعی میکنیم به آبجکت &lt;code class=&quot;highlighter-rouge&quot;&gt;name&lt;/code&gt; دسترسی پیدا کنیم، درحالی که حتی وجود خارجی نداره!&lt;/p&gt;

&lt;p&gt;معمول‌ترین راه برای حل این مشکل که خیلی‌ها هم استفاده میکنن اینه:&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kr&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;user&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;personalInfo&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;personalInfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// undefined error will NOT be thrown as we check for existence before access&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;خب اینم یه راهه، ولی تا موقعی که آبجکتت مثل چیزی که بالا مثال زدیم ساده باشه. اگه یه آبجکت تودرتو تا ۵ ۶ مرحله داشته باشیم، اونموقع دستور شرطی که مینوسیم یه چیز احمقانه و عجیب قریبی مثل این میشه:&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;city&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;user&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;personalInfo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;personalInfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addressDetails&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;personalInfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addressDetails&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;primaryAddress&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;city&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;personalInfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addressDetails&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;primaryAddress&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;اینجا چندتا راه حل هست تا بتونیم این قضیه رو به درستی هندل کنیم.&lt;/p&gt;

&lt;h2 id=&quot;الگوی-دسترسی-به-نستد-آبجکتِ-oliver-steele&quot;&gt;الگوی دسترسی به نستد آبجکتِ Oliver Steele&lt;/h2&gt;

&lt;p&gt;این یکی از محبوب‌ترین روش‌های دسترسی به یک شی نستد هست که کار رو کلی &lt;strong&gt;ساده&lt;/strong&gt; و &lt;strong&gt;تمیز&lt;/strong&gt; میکنه. من این راه حل رو خیلی وقت پیش توی  &lt;strong&gt;&lt;a href=&quot;https://stackoverflow.com/a/4034468/5330668&quot;&gt;Stackoverflow&lt;/a&gt;&lt;/strong&gt; پیدا کرده بودم و بنظرم خیلی حرفه‌ای میومد.&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kr&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;user&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;personalInfo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;با این notationای که استفاده کردیم، عمرا دیگه به خطای &lt;em&gt;Cannot read property ‘name’ of undefined&lt;/em&gt; بربخوریم 😬.&lt;/p&gt;

&lt;p&gt;اگه بخوام روش کنم که دقیقا چیکار کردیم، باید بگم داریم چک میکنیم اگر آبجکت &lt;code class=&quot;highlighter-rouge&quot;&gt;user&lt;/code&gt; وجود نداره یه آبجکت خالی همینجوری رو هوا بساز و اگه وجود داشت، مرحله مرحله جلو میریم تا به property مورد نظرمون برسیم. و این باعث میشه که &lt;strong&gt;تاهیچوقتِ تاریخ، به خطایِ نبودنِ شیِ موردِ نظر&lt;/strong&gt; بر نخوریم!&lt;/p&gt;

&lt;p&gt;اما خب، متاسفانه با این روش نمیتونین به &lt;strong&gt;nester array object&lt;/strong&gt; دسترسی داشته باشین!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2018-04-13/screaming_from_js.gif&quot; alt=&quot;Screaming from js&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;استفاده-از-array-reduce-برای-دسترسی-به-آبجکتی-از-آرایهی-نستد-شده&quot;&gt;استفاده از Array Reduce برای دسترسی به آبجکتی از آرایه‌ی نستد شده!&lt;/h2&gt;

&lt;p&gt;متد Array Reduce یه راه قدرتمند و امن برای دسترسی به همچین مواردی هست. به مثال توجه کنید.&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kr&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;getNestedObject&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;nestedObj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;pathArr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;pathArr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;reduce&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;obj&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!==&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'undefined'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;undefined&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;nestedObj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// pass in your object structure as array elements&lt;/span&gt;
&lt;span class=&quot;kr&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;getNestedObject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'personalInfo'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'name'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// to access nested array, just pass in array index as an element the path array.&lt;/span&gt;
&lt;span class=&quot;kr&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;city&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;getNestedObject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'personalInfo'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'addresses'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'city'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// this will return the city from the first address item.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h2 id=&quot;کتابخونه-typy&quot;&gt;کتابخونه Typy&lt;/h2&gt;

&lt;p&gt;و در نهایت، این کتابخونه میتونه حلال همه مشکلاتتون باشه.&lt;/p&gt;

&lt;p&gt;این کتابخونه علاوه به اینکه بهتون کمک میکنه تا به راحتی و با خیال راحت به هر آبجکت نستدی دسترسی پیدا کنید، بلکه کلی امکانات دیگه هم در ختیارتن میگذاره. این ابزار کاربردی از طریق کتابخونه npm در دسترس شماست - &lt;a href=&quot;https://github.com/flexdinesh/typy&quot;&gt;Typy&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;خب، برای همون مثال بالا اگه بخواییم از Typy استفاده کنیم، اینجوری میشه&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kr&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'typy'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kr&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'personalInfo.name'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;safeObject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kr&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;city&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'personalInfo.addresses[0].city'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;safeObject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// address is an array&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h2 id=&quot;کلام-آخر&quot;&gt;کلام آخر&lt;/h2&gt;

&lt;p&gt;کلی راه حل مختلف برای حل این مشکل وجود داره که میتونید در &lt;a href=&quot;https://stackoverflow.com/a/41532415/5330668&quot;&gt;این کامنت&lt;/a&gt; ۱۰ تاشونو ببینین، ولی خب من سعی کردم به اون ۲ ۳ تایی که واقعا بدرد بخور بودن بپردازم.&lt;/p&gt;

&lt;p&gt;البته یه سری لایبرری دیگه هم هستن که خیلی میتونن تو این قضیه کمکتون کنن، کتابخونه‌هایی مثل Lodash و Ramda.&lt;/p&gt;

&lt;p&gt;اما در پروژه‌‌های که کدهاتون لازمه در سبک‌ترین حالت ممکنن قرار بگیره (مثلا پروژه‌های front-end) و الالخصوص جاهایی که به یکی دو تا ازین متد‌ها بیشتر احتیاج ندارین، سعی کنین شخصا کد و متد موردنیازتون رو بنویسین و خودتون رو همیشه از شر دیپندنسی‌هاو لایبررهای عجیب غریب همیشه در امان نگهدارید 😎.&lt;/p&gt;

&lt;p&gt;اگه سوال یا موردی بود، مثل همیشه در &lt;a href=&quot;https://twitter.com/sadra_amlashi&quot;&gt;توییتر&lt;/a&gt; یا در &lt;a href=&quot;https://t.me/amlashi&quot;&gt;تلگرام&lt;/a&gt; میتونیم باهم در ارتباط باشیم. 😉🍷&lt;/p&gt;</content><author><name>صدرا املشی</name></author><category term="JavaScript" /><category term="ES6" /><summary type="html">همونطور که احتمالا خیلی‌هاتون بامن هم‌عقیده هستین، جاوا اسکریپت زبان در دسترس، جالب و گاهی اوقات فوق‌العاده‌ایه. اما بعضی چیزا توی جاوا اسکریپت هست که واقعا عجیبه و غریبه! یکی از اون چیزا، وقتیه که سعی میکنیم یه آبجک نستد شده رو بگیریم و یهو این خطا به ما برمیگرده:</summary></entry><entry><title type="html">Promise تابحال هیچوقت انقدر آسون نبوده</title><link href="//isapanah.com/2017/js-promise" rel="alternate" type="text/html" title="Promise تابحال هیچوقت انقدر آسون نبوده" /><published>2017-11-27T00:00:00+03:30</published><updated>2017-11-27T00:00:00+03:30</updated><id>//isapanah.com/2017/js-promise</id><content type="html" xml:base="//isapanah.com/2017/js-promise">&lt;h2 id=&quot;مقدمه&quot;&gt;مقدمه&lt;/h2&gt;

&lt;p&gt;خیلی وقت پیش در حین انجام یک پروژه در NodeJs نیاز پیدا کردم که چندتا متد رو بصورت متوالی و nested استفاده کنم، و متد ها هم به این صورت بود که باید صبر میکردن تا داخلی ترین متد انجام بشه و بعد متد خارجی با استفاده از نتیجه متد داخلی وظیفه خودش رو انجام بده، و این توالی تا آخرین متد خارجی ادامه داشت. (تا جایی که یادم میاد تا ۴ مرحله نست شده بود.)&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-11-27/js-promise-nested-blocks.jpg&quot; alt=&quot;Nested Blocks&quot; /&gt;&lt;/p&gt;

&lt;p&gt;جدا از این مورد، مشکل دیگه ای که وجود داشته این بود که اولا این متد‌ها Async بودن، و دوما اینکه ممکن بود نتیجه sucessfull یا failed بشه. خلاصه به هر کثافتی که بود کارو انجام دادم.
چند وقت بعد &lt;a href=&quot;http://moshtaghi.ir/&quot;&gt;مهدی&lt;/a&gt; بهم گفت که میتونی از &lt;strong&gt;Promise&lt;/strong&gt; برای این معضل استفاده کنی. و اینجوری بود که زندگی زیبا می‌شود!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-11-27/js-promise-yeah.gif&quot; alt=&quot;Yes&quot; /&gt;&lt;/p&gt;

&lt;p&gt;از چندتا از دوستان شنیدم که هنوز پرامیس رو درک نکردن و نمیدونن که فرقش با چیزای دیگه مثل Callback چیه. در این پست قصد دارم به ساده‌ترین روش ممکن راجع به Promiseها و اینکه واقعا چطوری باید ازشون استفاده کرد صحبت کنم. پس حرف رو کوتاه کنیم و بریم سر اصل مطلب.&lt;/p&gt;

&lt;p&gt;در ادامه فهرستی از سرفصل مطالبی که میخوام در این پست صحبت کنم با لینک به همون تیتر قرار دادم.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#subject&quot;&gt;شرح&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#how-to-create-a-Promise&quot;&gt;ساختن یک Promise&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#how-to-user-promise&quot;&gt;استفاده از Promise&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#chain-of-promises&quot;&gt;زنجیره Promiseها&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#asynchronous-promise&quot;&gt;پرامیس‌ها Asynchronous هستند&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#promises-in-variety-of-js&quot;&gt;پرامیس در ES5، ES6, ES7&lt;/a&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#promise-in-es5&quot;&gt;ES5 - در اکثر مرورگرها پشتیبانی میشه&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#promise-in-es6&quot;&gt;ES6 - در مرورگرهای مدرن، و NodeJs v6 پشتیبانی میشه&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#promise-in-es7&quot;&gt;ES7 - استفاده از Async Await سینتکس رو قابل خوندن میکنه&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#when-and-why-promises&quot;&gt;چرا و چه موقع از Promise استفاده کنیم؟&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#callback&quot;&gt;دنیا قبل از پرامیس: Callback&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#scape-from-callback-hell&quot;&gt;فرار از Callback Hell&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#observable&quot;&gt;عضو جدید این خانواده: Observables&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#conclusion&quot;&gt;نتیجه‌گیری&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;subject&quot;&gt;شرح&lt;/h2&gt;

&lt;p&gt;بزارین همین اول کار، پرامیس رو با طرح یک مثال براتون ساده کنم:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;فرض کنید یه &lt;strong&gt;بچه&lt;/strong&gt; هستید. و &lt;strong&gt;مادرتون&lt;/strong&gt; بهتون &lt;strong&gt;قول میده&lt;/strong&gt; که هفته دیگه یه &lt;strong&gt;گوشی جدید&lt;/strong&gt; براتون بخره.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;شما اولا نمی‌دونید که آیا هفته دیگه یه گوشی براتون میخره یا نه؟ ثانیا اینکه آیا واقعا مادرتون برای شما یه گوشی جدید میخره؟ ثالثا ممکنه اصلا اون هفته از دستتون ناراحت باشه و کلا بیخیال خرید گوشی بشه!&lt;/p&gt;

&lt;p&gt;این کامل‌ترین مثالی بود که از Promise می‌تونستم بزنم. هر پرامیس ۳وضعیت داره:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;پرامیس در حال بررسیه &lt;strong&gt;Pending&lt;/strong&gt;: شما نمی‌دونید که آیا هفته دیگه براتون گوشی میخره یا نه.&lt;/li&gt;
  &lt;li&gt;پرامیس حل شده &lt;strong&gt;Resolved&lt;/strong&gt;: مادرتون واقعا یه گوشی جدید براتون خریده.&lt;/li&gt;
  &lt;li&gt;پرامیس رد شده &lt;strong&gt;Rejected&lt;/strong&gt;: مادرتون براتون گوشی جدید نخریده، چون واقعا از دستتون ناراحت بوده.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;حالا که با مفهوم و حالت‌های پرامیس آشنا شدید، بریم ببینم که چجوری میشه ازش استفاده کرد.&lt;/p&gt;

&lt;h2 id=&quot;how-to-create-a-Promise&quot;&gt;ساختن یک Promise&lt;/h2&gt;

&lt;p&gt;اجازه بدید در همین اولین قدم، چیزهایی که بالا گفتیم رو به کد جاوا اسکریپت تبدیل کنیم.&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cm&quot;&gt;/* ES6 */&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;isMomHappy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;//Promise&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;willGetNewPhone&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;resolve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;reject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;isMomHappy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;phone&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;brand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'iPhone X'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'gray'&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;resolve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;phone&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//fulfilled&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;reason&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Mom is angry.'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;reject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;reason&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//reject&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;فکر میکنم که خودش به اندازه کافی گویا هست.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;ما یک متغییر بولین بنام &lt;code class=&quot;highlighter-rouge&quot;&gt;isMomHappy&lt;/code&gt; داریم، که برامون مشخص میکنه آیا مامان OK هست واسه خریدن یا نه.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;یه پرامیس هم بنام &lt;code class=&quot;highlighter-rouge&quot;&gt;willGetNewPhone&lt;/code&gt; داریم. که این پارمیس، هم میتونه حل &lt;code class=&quot;highlighter-rouge&quot;&gt;Resolved&lt;/code&gt; بشه (مامان برات یه گوشی جدید بخره)، هم میتونه رد &lt;code class=&quot;highlighter-rouge&quot;&gt;Rejected&lt;/code&gt; بشه (مامان از دستت عصبانیه، و عمرا برات گوشی جدید بخره).&lt;/p&gt;

    &lt;p&gt;یک syntax استاندارد برای نوشتن &lt;code class=&quot;highlighter-rouge&quot;&gt;Promise&lt;/code&gt; جدید وجود داره که بر اساس &lt;a href=&quot;https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Promise&quot;&gt;داکیومنت MDN&lt;/a&gt;، این سینتکس اینجوریه:&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;//Promise syntax looks like this&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/* executor */&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;resolve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;reject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;تنها چیزهایی که لازمه بخاطر بسپارین این که، وقتی نتیجه کار موفقیت‌آمیزه، باید متد &lt;code class=&quot;highlighter-rouge&quot;&gt;resolve(your_success_value)&lt;/code&gt; رو فراخوانی کرده، و به هر دلیلی اگه نتیجه موفقیت‌آمیز نیست، باید متد &lt;code class=&quot;highlighter-rouge&quot;&gt;reject(your_fail_value)&lt;/code&gt; رو فراخوانی کنید. هردوی اینها باید در داخل متد &lt;code class=&quot;highlighter-rouge&quot;&gt;Promise&lt;/code&gt; انجام بشه.
   همونطور هم که در مثال می‌بینید ازونجایی که مامان عصبانی بود، ما مجبور شدیم درخواست رو رد کرده و با فرواخوانی متد &lt;code class=&quot;highlighter-rouge&quot;&gt;reject(reason)&lt;/code&gt; و پاس کردن مقدار reason این مقوله رو به سرانجام برسونیم. البته، اگرهم مامان اوکی بود و گوشی جدید رو خرید، با فراخوانی متد &lt;code class=&quot;highlighter-rouge&quot;&gt;resolve&lt;/code&gt; به همراه مقدار JSON از مشخصات گوشی خریداری شده، نتیجه &lt;strong&gt;قول&lt;/strong&gt; رو اعلام می‌کردیم.&lt;/p&gt;

&lt;h2 id=&quot;how-to-user-promise&quot;&gt;استفاده از Promise&lt;/h2&gt;

&lt;p&gt;حالا که فهمیدیم چطوری میشه یه پرامیس ساخته، بهتره نحوه استفاده کردن ازش رو هم یاد بگیریم.&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cm&quot;&gt;/* ES6 */&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// call our promise&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;askMom&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;willGetNewPhone&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fulfilled&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;c1&quot;&gt;//yay, you got a new phone&lt;/span&gt;
			&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fulfilled&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
			&lt;span class=&quot;c1&quot;&gt;//output: { brand: 'iPhone X', color: 'gray' }&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;}).&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;c1&quot;&gt;//oops, mom don't buy it&lt;/span&gt;
			&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
			&lt;span class=&quot;c1&quot;&gt;//output: 'Mom is angry.'&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;askMom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;در اینجا ما متد &lt;code class=&quot;highlighter-rouge&quot;&gt;askMom&lt;/code&gt; رو فراخونی میکنیم. و در داخل اون، متد پرامیسی که ساخته بودیم، یعنی &lt;code class=&quot;highlighter-rouge&quot;&gt;willGetNewPhone&lt;/code&gt;، رو صدا میزنیم.&lt;/p&gt;

&lt;p&gt;ما میخواییم وقتی که پرامیس بهمون جواب میده بتونیم اکشن مناسب رو نشون بدیم. برای مواقعی که پاسخ &lt;strong&gt;resolve&lt;/strong&gt; هست متد &lt;code class=&quot;highlighter-rouge&quot;&gt;then&lt;/code&gt; استفاده میشه؛ و برای مواقعی که پاسخ &lt;strong&gt;reject&lt;/strong&gt; هست، متد &lt;code class=&quot;highlighter-rouge&quot;&gt;catch&lt;/code&gt; صدا میشه.&lt;/p&gt;

&lt;p&gt;در این مثال، در داخل &lt;code class=&quot;highlighter-rouge&quot;&gt;.then&lt;/code&gt; ما متد &lt;code class=&quot;highlighter-rouge&quot;&gt;function(fulfilled) {…}&lt;/code&gt; رو داریم. مقدار این متغییرِ &lt;code class=&quot;highlighter-rouge&quot;&gt;fulfilled&lt;/code&gt; چیه؟ دقیقا همون چیزیه که شما در متد &lt;code class=&quot;highlighter-rouge&quot;&gt;resolve(your-success_value)&lt;/code&gt; پاس کردین. که در اینجا همون مشخصات گوشی جدیده ست.&lt;/p&gt;

&lt;p&gt;همینطور در داخل &lt;code class=&quot;highlighter-rouge&quot;&gt;.catch‍&lt;/code&gt; هم متد &lt;code class=&quot;highlighter-rouge&quot;&gt;function(error) {…}&lt;/code&gt; رو داریم. که مقدار &lt;code class=&quot;highlighter-rouge&quot;&gt;error&lt;/code&gt; برابر با مقداری هست که ما با &lt;code class=&quot;highlighter-rouge&quot;&gt;reject(your_fail_value)&lt;/code&gt; پاسش کردیم. در این مثال مقدار error برابر بود با دلیل ریجکت شدن درخواست.&lt;/p&gt;

&lt;p&gt;اجازه بدید کدهایی که تا الان زدیم رو اجرا کنیم و نتیجه کار رو ببینیم.
اجرای دمو از &lt;a href=&quot;https://jsbin.com/luceriy/4/edit?js,console&quot;&gt;این لینک&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-11-27/js-promise-mom-promise-demo.gif&quot; alt=&quot;Mom Promise Demo&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;chain-of-promises&quot;&gt;زنجیره Promiseها&lt;/h2&gt;

&lt;p&gt;پرامیس‌ها قابلیت زنجیره (متوالی) شدن رو دارند.&lt;/p&gt;

&lt;p&gt;برای مثال، فرض کنید شما همون کودک مثال قبل هستید. حالا به دوستتون &lt;strong&gt;قول می‌دید&lt;/strong&gt; که وقتی مامان واستون گوشی جدید رو خرید، بهش &lt;strong&gt;نشون بدید.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;خب، پس بریم پرامیس بعدی رو بنویسیم.&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// 2nd promise&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;showNewPhone&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;phone&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
		&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;resolve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;reject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
			&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;message&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Hey friend, I have a new '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;phone&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;color&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;phone&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;brand&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'.'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;nx&quot;&gt;resolve&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;نکات:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;در این مثال احتمالا متوجه شدید که ما از &lt;code class=&quot;highlighter-rouge&quot;&gt;reject&lt;/code&gt; استفاده نکردیم. خب این متد یه چیز optional و انتخابیه، فقط موقعی که نیاز هست ازش استفاده کنید.&lt;/p&gt;

&lt;p&gt;ما حتی میتونیم با استفاده از &lt;code class=&quot;highlighter-rouge&quot;&gt;Promise.solve&lt;/code&gt; این متد رو ساده‌تر هم بنویسیم .&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// shorten it&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// 2nd promise&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;showNewPhone&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;phone&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;message&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Hey friend, I have a new '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;phone&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;color&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;phone&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;brand&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'.'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;resolve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;خب، حالا وقت زنجیر کردن پرامیس‌هاست. شما - اون بچه داستان - فقط وقتی می‌تونید به دوستتون اون گوشی جدید رو نشون بدید &lt;code class=&quot;highlighter-rouge&quot;&gt;showNewPhone&lt;/code&gt;، بعد از اینکه مامان اون گوشی رو واستون خریده باشه &lt;code class=&quot;highlighter-rouge&quot;&gt;willGetNewPhone&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// call our promise&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;askMom&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;nx&quot;&gt;willGetNewPhone&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;showNewPhone&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// chain it here&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fulfilled&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;c1&quot;&gt;//yay, you got a new phone&lt;/span&gt;
			&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fulfilled&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
			&lt;span class=&quot;c1&quot;&gt;//output: 'Hey friend, I have a new gray iPhone X.'&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;}).&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;c1&quot;&gt;//oops, mom don't buy it&lt;/span&gt;
			&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
			&lt;span class=&quot;c1&quot;&gt;//output: 'Mom is angry.'&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;به همین راحتی می‌تونید پرامیس‌ها رو به همن زنجیر کنید.&lt;/p&gt;

&lt;h2 id=&quot;asynchronous-promise&quot;&gt;پرامیس‌ها Asynchronous هستند&lt;/h2&gt;

&lt;p&gt;این خیلی واضحه که پرامیس‌ها آسنکرون هستن. اصلا اجازه بدید برای اثبات این موضوع چندتا لاگ بندازیم.&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// call our promise&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;askMom&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'before asking Mom'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// log before&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;willGetNewPhone&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;showNewPhone&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fulfilled&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fulfilled&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;}).&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'after asking mom'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// log after&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;فکر می‌کنید نتیجه‌ چی میشه؟ احتمالا انتظار دارید همچین چیزی دریافت کنید:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Log&quot;&gt;1. before asking Mom
2. Hey friend, I have a new black Samsung phone.
3. after asking mom
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ولی چیزی که واقعا دریافت میکنیم اینه:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Log&quot;&gt;1. before asking Mom
2. after asking mom
3. Hey friend, I have a new black Samsung phone.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-11-27/js-promise-chain-demo.gif&quot; alt=&quot;Chain Demo&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;چرا؟ چون زندگی (یا JS) منتظر هیچ کسی نمی‌مونه&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;شما، یا درواقع همون بچه، از بازی کردن دست نمی‌کشید موقعی که منتظرید تا مامانتون به قولش (خریدن موبایل جدید) عمل کنه؛ غیر از اینه؟ این همون چیزیه که ما بهش میگیم asynchronous، کد کاملا اجرا میشه، بدون اینکه سرویسمون رو بلاک کنه یا منتظر جواب بشه. هرموقع جواب رسید، بهش واکنش مناسب رو نشون میده. هرکاری که قراره موقع عمل کردن مامان به قولش  انجام بدید، فقط کافیه بزارینش داخل &lt;code class=&quot;highlighter-rouge&quot;&gt;.then&lt;/code&gt; 😉 .&lt;/p&gt;

&lt;h2 id=&quot;promises-in-variety-of-js&quot;&gt;پرامیس در ES5، ES6, ES7&lt;/h2&gt;

&lt;p&gt;&lt;b id=&quot;promise-in-es5&quot;&gt;ES5 - در اکثر مرورگرها پشتیبانی میشه&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;سرویسی که نوشتیم در اکثر مرورگرها و البته در NodeJs قابل استفاده است. البته در ES5 این ابزار همینجوری قابل استفاده نیست و برای استفاده ازش باید از لایبرری &lt;a href=&quot;http://bluebirdjs.com/docs/getting-started.html&quot;&gt;Bluebird&lt;/a&gt; استفاده کنید. البته لایبرری معروف دیگه‌ای هم برای اینکار هست به اسم &lt;a href=&quot;https://github.com/kriskowal/q&quot;&gt;Q&lt;/a&gt; که توسط Kris Kowal توسعه داده شده.&lt;/p&gt;

&lt;p&gt;&lt;b id=&quot;promise-in-es6&quot;&gt;ES6 - در مرورگرهای مدرن، و NodeJs v6 پشتیبانی میشه&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;سرویسی که نوشتیم بصورت نیتیو در ES6 اجرا میشه و احتیاج به هیچ لایبرری خارجی وجود نداره. البته ما در ES6 میتونیم با استفاده از &lt;code class=&quot;highlighter-rouge&quot;&gt;fat arrow =&amp;gt;&lt;/code&gt; فاکنکشن‌ها کدمون رو ساده‌تر هم بنویسیم.&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cm&quot;&gt;/* ES6 */&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;isMomHappy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;//Promise&lt;/span&gt;
&lt;span class=&quot;kr&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;willGetNewPhone&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;resolve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;reject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//fat arrow&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;isMomHappy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;phone&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;brand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'iPhone X'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'gray'&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;resolve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;phone&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;reason&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Mom is angry.'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;reject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;reason&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;kr&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;showNewPhone&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;phone&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;message&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Hey friend, I have a new '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;phone&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;color&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;phone&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;brand&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'.'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;resolve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// call our promise&lt;/span&gt;
&lt;span class=&quot;kr&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;askMom&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;nx&quot;&gt;willGetNewPhone&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;showNewPhone&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fulfilled&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fulfilled&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// fat arrow&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;error&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// fat arrow&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;askMom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;اگه با ES6 آشنایی ندارید، توجه کنید که من همه متغیر هایی که قابل تغییر بودند رو با &lt;code class=&quot;highlighter-rouge&quot;&gt;let&lt;/code&gt; مشخص کردم و اونهایی رو هم که immutable و بدون تغییر هستند رو با &lt;code class=&quot;highlighter-rouge&quot;&gt;const&lt;/code&gt; مشخص کردم. همه فانکشنهایی هم که بصورت &lt;code class=&quot;highlighter-rouge&quot;&gt;function(arguments)&lt;/code&gt; بود رو به &lt;code class=&quot;highlighter-rouge&quot;&gt;(argument) =&amp;gt;&lt;/code&gt; تغییر دادم. برای آشنایی بیشتر با ES6 می‌تونید لینک‌های زیر رو مطالعه کنید:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://strongloop.com/strongblog/es6-variable-declarations/&quot;&gt;JavaScript ES6 Variable Declarations with let and const&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://strongloop.com/strongblog/an-introduction-to-javascript-es6-arrow-functions/&quot;&gt;An introduction to Javascript ES6 arrow functions&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;b id=&quot;promise-in-es7&quot;&gt;ES7 - استفاده از Async Await سینتکس رو قابل خوندن میکنه&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;اگه قرار باشه این سرویس رو با ES7 بنویسیم، میتونیم با استفاده از تگ های &lt;code class=&quot;highlighter-rouge&quot;&gt;async&lt;/code&gt; و &lt;code class=&quot;highlighter-rouge&quot;&gt;await&lt;/code&gt; کدمون رو تمیزتر کنیم. اینطوری میتونیم &lt;code class=&quot;highlighter-rouge&quot;&gt;then&lt;/code&gt; و &lt;code class=&quot;highlighter-rouge&quot;&gt;catch&lt;/code&gt; رو از کدمون حذف کنیم.&lt;/p&gt;

&lt;p&gt;پس چیزی که درنهایت بازنویسی میکنیم در ES7 میشه این:&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cm&quot;&gt;/* ES7 */&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;isMomHappy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;//Promise&lt;/span&gt;
&lt;span class=&quot;kr&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;willGetNewPhone&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;resolve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;reject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//fat arrow&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;isMomHappy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;phone&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;brand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'iPhone X'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'gray'&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;resolve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;phone&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;reason&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Mom is angry.'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;reject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;reason&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;//2nd promise&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;showNewPhone&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;phone&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;resolve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;reject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;message&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Hey friend, I have a new '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;phone&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;color&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;phone&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;brand&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'.'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;resolve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;//call our promise&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;askMom&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'before asking Mom'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;phone&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;willIGetNewPhone&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;message&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;showNewPhone&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;phone&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'after asking mom'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;askMom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;})();&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;ol&gt;
  &lt;li&gt;هرموقع که نیاز داشتید یه پرامیس return کنید، فقط کافیه متد مورد نظر رو با &lt;code class=&quot;highlighter-rouge&quot;&gt;async&lt;/code&gt; نشانه گذاری کنید.
برای مثال:
&lt;code class=&quot;highlighter-rouge&quot;&gt;async function showNewPhone(phone)&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;هرموقع که احتیاج داشتید پرامیس رو فراخوانی کنید، کافیه قبلش با &lt;code class=&quot;highlighter-rouge&quot;&gt;await&lt;/code&gt; نشانه‌گذاری کنید. برای مثال:
&lt;code class=&quot;highlighter-rouge&quot;&gt;let phone = await willIGetNewPhone;&lt;/code&gt; و &lt;code class=&quot;highlighter-rouge&quot;&gt;let message = await showNewPhone(phone);&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;و در نهایت با استفاده از &lt;code class=&quot;highlighter-rouge&quot;&gt;try { ... } catch(error) { … }&lt;/code&gt; میتونید قضیه &lt;strong&gt;resolved&lt;/strong&gt; و &lt;strong&gt;rejected&lt;/strong&gt; پرامیس رو هم هندل کنید.&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;when-and-why-promises&quot;&gt;چرا و چه موقع از Promise استفاده کنیم؟&lt;/h2&gt;

&lt;p&gt;واقعا چرا به پرامیس احتیاج داریم؟ دنیا قبل از پرامیس چه شکلی بود؟ بزارید قبل از جواب دادن به این سوال ها، کمی برگردیم عقب و ببینیم قبلا اوضاع رو چجوری هندل می‌کردیم.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;متد معمولی برای جمع دو عدد&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// add two numbers normally&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;add&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;num1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;num2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;num1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;num2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kr&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// you get result = 3 immediately&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;متد Async برای جمع دو عدد&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// add two numbers remotely&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// get the result by calling an API&lt;/span&gt;
&lt;span class=&quot;kr&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;getAddResultFromServer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'http://www.example.com?num1=1&amp;amp;num2=2'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// you get result  = &quot;undefined&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;اگه شما عددهارو با متد معمولی جمع بزنید، همون لحظه جوابشو می‌گیرید. اما برعکس،‌ وقتی میخوایید به یک API ریکوئست بزنید که این دوتا عدد رو براتون جمع بزنه، اونموقع باید صبر کنید تا جواب برگرده،‌و نمی‌تونید همون لحظه به جوابتون برسید.&lt;/p&gt;

&lt;p&gt;مورد دیگه‌ای هم وجود داره، اگه شما به این شکل بخواهید جوابتون رو بگیرید، معلوم نیست که جواب سرور چیه، و ممکنه حتی سایت دان باشه، یا سرعت پاسخگویی خیلی کم باشه، یا هر مشکل دیگه‌ای. و اینو هم میدونیم که شما قرار نیست کل سرویستون رو بلاک یا فریز کنید و منتظر وایستید تا بلکه بلاخره جوابی برسه.&lt;/p&gt;

&lt;p&gt;فراخوانی APIها، دانلود کردن فایل، خواندن فایل و چیزهایی مثل این، مواردی هستند که باید با استفاده از متد های Async باهاشون کار کرد.&lt;/p&gt;

&lt;h2 id=&quot;callback&quot;&gt;دنیا قبل از پرامیس: Callback&lt;/h2&gt;

&lt;p&gt;آیا حتما باید از پرامیس برای فراخوانی متدهای Async استفاده کنیم؟ خیر. قبل از پرامیس، ما از callback استفاده می‌کردیم.
فانکشن callback فقط برای مواقعی که میخواهیم نتیجه بازگشتی رو دریافت کنیم به کار میره. اجازه بدید با توجه به چیزی که حالا راجع به کال‌بک میدونیم، متد قبلی رو بازنویسی کنیم.&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// add two numbers remotely&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// get the result by calling an API&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;addAsync&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;num1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;num2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// use the famous jQuery getJSON callback API&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getJSON&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'http://www.example.com'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;num1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;num1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;num2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;num2&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;addAsync&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;success&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// callback&lt;/span&gt;
    &lt;span class=&quot;kr&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;success&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// you get result = 3 here&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;خب، با این توصیف، پس دیگه به پرامیس چه احتیاجی داریم؟&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;اگر قرارباشه یکسری اکشن‌های متوالی آسنکرون انجام بدید، چیکار می‌کنید؟&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;خب بزارید ببینیم چی داریم، قرار حالا بجای اینکه یه بار عمل جمع رو انجام بدیم، ۳بار اینکارو انجام بدیم. با کد زدن معمولی همچین چیزی میشه:&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// add two numbers normally&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;resultA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;resultB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;resultC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

 &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;add&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;num1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;num2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;num1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;num2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;resultA&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// you get resultA = 3 immediately&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;resultB&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;resultA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// you get resultB = 6 immediately&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;resultC&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;resultB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// you get resultC = 10 immediately&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'total'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;resultC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;resultA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;resultB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;resultC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;حالا اگه بخواهیم همون کارو با callback انجام بدیم چطور؟&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// add two numbers remotely&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// get the result by calling an API&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;resultA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;resultB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;resultC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;addAsync&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;num1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;num2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// use the famous jQuery getJSON callback API&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getJSON&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'http://www.example.com'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;num1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;num1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;num2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;num2&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;addAsync&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;success&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// callback 1&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;resultA&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;success&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// you get result = 3 here&lt;/span&gt;

    &lt;span class=&quot;nx&quot;&gt;addAsync&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;resultA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;success&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// callback 2&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;resultB&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;success&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// you get result = 6 here&lt;/span&gt;

        &lt;span class=&quot;nx&quot;&gt;addAsync&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;resultB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;success&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;// callback 3&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;resultC&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;success&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// you get result = 10 here&lt;/span&gt;

            &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'total'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;resultC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;resultA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;resultB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;resultC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;این syntax اصلا یوزرفرندلی نیست. خیلی دیگه بخواییم خوشبین باشیم، مثل اهرام ثلاثه شده! 😒 اما توسعه دهنده‌های خارجی به همچین چیزی میگن &lt;Callback Hell=&quot;&quot;&gt;، بخاطر اینکه هر کال‌بک در داخل شکم کال‌بک دیگه‌ای قرار گرفته. تصور کنید که ۱۰تا کال‌بک دارید، کدتون ۱۰ بار نِست می‌شد!&lt;/Callback&gt;&lt;/p&gt;

&lt;h2 id=&quot;scape-from-callback-hell&quot;&gt;فرار از Callback Hell&lt;/h2&gt;

&lt;p&gt;و در این لحظه بود که قهرمان داستان ما، Promise وارد شد 👨🏻‍🎤. بزارید ببینیم کدمون حالا چطوری میشه.&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// add two numbers remotely using observable&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;resultA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;resultB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;resultC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;addAsync&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;num1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;num2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// use ES6 fetch API, which return a promise&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;fetch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;http&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//www.example.com?num1=${num1}&amp;amp;num2=${num2}`)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;());&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;addAsync&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;success&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;resultA&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;success&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;resultA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;success&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;addAsync&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;success&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;success&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;resultB&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;success&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;resultB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;success&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;addAsync&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;success&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;success&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;resultC&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;success&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;resultC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;success&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'total: '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;success&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;resultA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;resultB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;resultC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;با استفاده از پرامیس‌ها، ما بجای callback از &lt;code class=&quot;highlighter-rouge&quot;&gt;.then&lt;/code&gt; کمک می‌گیریم. در همین نگاه اول متوجه میشیم که چقدر کدهامون با حذف کال‌بک‌های nested یا تودرتو تروتمیزتر شده. البته که با استفاده از سینکتس &lt;code class=&quot;highlighter-rouge&quot;&gt;asyn&lt;/code&gt; و &lt;code class=&quot;highlighter-rouge&quot;&gt;await&lt;/code&gt; کدهامون بازم ساده‌تر و تروتمیزتر از چیزی که الان هست میشه. دیگه مثال این رو هم میزارم به عهده خودتون 😬🖐.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-11-27/js-promise-relaxing.gif&quot; alt=&quot;Relaxing&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;observable&quot;&gt;عضو جدید این خانواده: Observables&lt;/h2&gt;

&lt;p&gt;قبل از اینکه خیلی با پرامیس حال کرده و کف خون قاطی کنید، این رو باید اضافه کنم، یه چیزی وجود داره که قضیه مدیریت فانکشن‌های async رو از اینی که هست هم آسونتر کرده، و بهش میگن &lt;code class=&quot;highlighter-rouge&quot;&gt;Observable&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;واضحترین تعریفی که میتونم راجع به Observabale بهتون بگم اینه:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;قابل‌مشاهده یا Observable یک جریانی از رویداد‌های تنبله که میتونه میتونه صفر یا بی‌نهایت رویداد رو منتشر کنه، و این قضیه میتونه پایانی داشته یا نداشته باشه.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;و اگه بخوام ساده‌ترش کنم:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;فانکشن Observable از خودش مقادیری رو منتشر میکنه، و با یک &lt;strong&gt;Observer&lt;/strong&gt; یا مشاهده‌گر میتونیم بشینیم و این مقدار رو رَصَد کنیم. در نتیجه هرموقع این Observabale از خودش چیزی منتشر کرد، سریع متوجه میشیم و متناسب با این مقدار، ری‌اکشن موردنظر رو نشون بدیم.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;فانکشن یا مقادیر Observable از مفهوم  ReactiveX Programming اومده و در همه زبان‌هایی که از RX پشتیبانی میکنن وجود داره، در جاوا اسکریپت بهش میگیم RxJs. برای اطلاعات بیشتر لینک‌های زیر مطالب خوب و کاملی دارند:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://reactivex.io/&quot;&gt;ReactiveX&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://xgrommx.github.io/rx-book/index.html&quot;&gt;RxJS v4.0&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://blog.pusher.com/building-realtime-applications-with-cyclejs-and-rxjs/&quot;&gt;Building realtime applications with CycleJS and RxJS&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;و برای آشنایی بیشتر با Observable پیشنهاد میکنم لینک‌های زیر رو مطالعه کنید:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://reactivex.io/documentation/observable.html&quot;&gt;Observable&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://xgrommx.github.io/rx-book/content/observable/index.html&quot;&gt;Observable object&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://egghead.io/lessons/javascript-introducing-the-observable&quot;&gt;Introducing the Observable&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://cycle.js.org/streams.html&quot;&gt;Stream: Reactive Programming&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://medium.com/@benlesh/learning-observable-by-building-observable-d5da57405d87&quot;&gt;Learning Observable By Building Observable&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;اما برگردیم سر بحث خودمون. یکسری تفاوت‌ها بین Observable و Promise وجود داره:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Observable قابلیت لغو شدن داره (Cancellable)&lt;/li&gt;
  &lt;li&gt;Observable اصولا تنبله (Lazy)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;نترسین، در ادامه یه مثال درباره اینکه از آبزروبل چطوری میتونم استفاده کنیم آوردم. در مثال زیر من از قابلیت‌های RxJs برای پیاده کردن Observable استفاده کردم.&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Observable&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Rx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Observable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;resultA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;resultB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;resultC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;addAsync&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;num1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;num2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// use ES6 fetch API, which return a promise&lt;/span&gt;
    &lt;span class=&quot;kr&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;promise&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;fetch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;http&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//www.example.com?num1=${num1}&amp;amp;num2=${num2}`)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;());&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Observable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fromPromise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;promise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;addAsync&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;resultA&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;flatMap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;addAsync&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;resultB&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;flatMap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;addAsync&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;resultC&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;subscribe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'total: '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;resultA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;resultB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;resultC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;نکته:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;متد &lt;code class=&quot;highlighter-rouge&quot;&gt;Observable.fromPromise&lt;/code&gt; مقدار Promise ما رو به یه استریم از observable تبدیل می‌کنه.&lt;/li&gt;
  &lt;li&gt;اوپراتورهای &lt;code class=&quot;highlighter-rouge&quot;&gt;.do&lt;/code&gt; و &lt;code class=&quot;highlighter-rouge&quot;&gt;.flatMap&lt;/code&gt; به ما در مدیریت رویداد‌های منتشره از Observable کمک می‌کنند.&lt;/li&gt;
  &lt;li&gt;استریم‌های Observable تنبل یا lazy هستند. متد &lt;code class=&quot;highlighter-rouge&quot;&gt;addAsync&lt;/code&gt; موقعی اجرا میشه که ما بهش &lt;code class=&quot;highlighter-rouge&quot;&gt;.subscribe&lt;/code&gt; کرده باشیم.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;فانکش‌های Observable امکانات باحالتری هم به ما می‌دن. مثلا در مثال زیر من با استفاده از اوپراتور &lt;code class=&quot;highlighter-rouge&quot;&gt;delay&lt;/code&gt; بهش گفتم در اجرای فانکشن ۳۰۰۰میلی‌ثانیه تاخیر ایجاد کنی و بعد کارتو انجام بده.&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;addAsync&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;delay&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// delay 3 seconds&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;resultA&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;تا همین‌جارو داشته باشین، و اجازه بدین راجع به Observable در یه پست دیگه مفصل‌تر صحبت کنم.&lt;/p&gt;

&lt;h2 id=&quot;conclusion&quot;&gt;نتیجه گیری&lt;/h2&gt;

&lt;p&gt;سعی کنید با انجام مثال‌های بیشتر یا مطالعه مقاله‌های دیگه با Promiseها و Callbackها بیشتر آشنا بشید. اونهارو کامل درک کنید و واقعا در پروژه‌هاتون استفاده کنید. درباره Observable هم نگران نباشید، این یه موضوع جدیده و حالا حالا وقت هست واسه اینکه توش مهارت پیدا کنید.
دوباره تکرار میکنم، با هرسه این مفاهیم و ابزارها آشنا بشید و ببینید واقعا کجا بدردتون میخوره، تا متناسب با اون ازشون استفاده کنید.&lt;/p&gt;

&lt;p&gt;می‌تونید از لینک‌های زیر هم مثالی که درباره &lt;code class=&quot;highlighter-rouge&quot;&gt;Mom Promise to buy new phone&lt;/code&gt; رو ببینید:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://gist.github.com/sadra/60429ffd4d5f1d8e7b0533c66d7f510d#file-mom-promise-in-es5-js&quot;&gt;Mom Promise in ES5&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://gist.github.com/sadra/60429ffd4d5f1d8e7b0533c66d7f510d#file-mom-promise-in-es6-js&quot;&gt;Mom Promise in ES6&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://gist.github.com/sadra/60429ffd4d5f1d8e7b0533c66d7f510d#file-mom-promise-in-es7-js&quot;&gt;Mom Promise in ES7&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;خب همش همین بود. امیدوارم مبحث Promise رو ساده توضیح داده باشم و شما هم راحت درک ‌باشینش. اگه سوال یا موردی بود، مثل همیشه در &lt;a href=&quot;https://twitter.com/sadra_amlashi&quot;&gt;توییتر&lt;/a&gt; یا در &lt;a href=&quot;https://t.me/amlashi&quot;&gt;تلگرام&lt;/a&gt; میتونیم باهم در ارتباط باشیم. 😉🍷&lt;/p&gt;</content><author><name>صدرا املشی</name></author><category term="Prmise" /><category term="RxJs" /><category term="JavaScript" /><category term="ES6" /><summary type="html">مقدمه</summary></entry><entry><title type="html">فایربیس ۱: سرویس Firebase Cloud Messaging</title><link href="//isapanah.com/2017/how-to-fcm-android" rel="alternate" type="text/html" title="فایربیس ۱: سرویس Firebase Cloud Messaging" /><published>2017-10-24T00:00:00+03:30</published><updated>2017-10-24T00:00:00+03:30</updated><id>//isapanah.com/2017/how-to-fcm-android</id><content type="html" xml:base="//isapanah.com/2017/how-to-fcm-android">&lt;p&gt;بنا بر قولی که در &lt;a href=&quot;http://isapanah.com/2017/set-fire-into-the-problems-with-firebase&quot;&gt;پست قبلی&lt;/a&gt; داده بودم، میخوام در یک مجموعه نوشته درباره پیاده سازی و استفاده از سرویس‌های مختلف فایربیس (تا جایی که این امکان برای ما در ایران وجود داشته باشه) صحبت کنم. شما می‌تونید پست‌های این بلاگ را، در رابطه با سرویس‌های فایربیس، از این &lt;a href=&quot;http://isapanah.com/tag/firebase&quot;&gt;لینک موضوعی&lt;/a&gt; مطالعه کنید.&lt;/p&gt;

&lt;p&gt;ازونجایی که مطالب زیاد بود و همچنین دسته بندی‌ها تودرتو، در ادامه فهرستی از کل مطالب و تیترهای موجود در این پست رو لیست کردم. با کلیک روی هر تیتر به اون موضوع هدایت می‌شید.&lt;/p&gt;

&lt;h2 id=&quot;فهرست-مطالب&quot;&gt;فهرست مطالب&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#introduction&quot;&gt;معرفی Firebase Cloud Messaging&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#fcm-account&quot;&gt;افتتاح حساب و ایجاد یک پروژه اندروید در فایربیس&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#basic-app-settings-for-fcm&quot;&gt;تنظیمات اولیه اپلیکیشن اندروید&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#node-service&quot;&gt;سرویس پوش‌ناتیفیکیشن با Node.js&lt;/a&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#prepare-node-service&quot;&gt;آماده‌سازی سرویس Node.js&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#using-nodejs&quot;&gt;استفاده از سرویس Node.js&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#node-notification&quot;&gt;Notification&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#node-data&quot;&gt;Data&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#node-combined-message&quot;&gt;Combined Message&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#prepare-app-for-fcm&quot;&gt;آماده سازی اپلیکیشن برای دریافت ناتیفیکیشن&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#receiving-notification&quot;&gt;دریافت ناتیفیکیشن&lt;/a&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#send-and-receive-notification&quot;&gt;ارسال و دریافت ناتیفیکیشن برای گروهی از کاربران&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#user-topics&quot;&gt;ارسال و دریافت ناتیفیکیشن بر اساس Topic یا موضوعی خاص&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#send-message-to-all&quot;&gt;ارسال پیام برای همه‌ی کاربران&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#other-settings&quot;&gt;دیگر تنظیمات ارسال پیام&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#other-settings-priority&quot;&gt;اولویت Priority&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#other-settings-time-to-alive&quot;&gt;زمان اعتبار پیام timeToLive&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#other-settings-collapse-key&quot;&gt;کلید جایگزینی پیام collapse_key&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#conclusion&quot;&gt;نتیجه‌گیری&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;introduction&quot;&gt;معرفی Firebase Cloud Messaging&lt;/h2&gt;

&lt;p&gt;فایربیس کلاد مسیجینگ یا به اختصار FCM یکی از سرویس‌های کاربردی فایربیس هست که به شما کمک میکنه تا بتونین پیام‌هاتون رو در کمترین زمان و بدون هیچ هزینه‌ای به دست کاربرتون در پلتفرم‌های مختلفی مثل Android, iOS, WebApplication, C++, Unituy برسونید.پیام شما می‌تونه به یک کاربر، یا گروهی از کاربران، یا بر اساس یه تاپیک و موضوع ارسال بشه.
ایجاد یک سرویس و ارسال پیام به کاربران شما خیلی ساده‌ست. اول از همه با اضافه کردن SDK فایبربیس به اپلیکیشنتون، کاربرانتون رو در شبکه کلاد فایبربیس رجیستر می‌کنید. و بعد در سمت سرورتون یکسری کد می‌نویسید، تا توسط اون بتونید پیام‌هاتون رو به کاربر یا گروهی از کاربران ارسال کنید.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-10-24/fcm-13.png&quot; alt=&quot;Firebase Cloud Messaging Console&quot; /&gt;&lt;/p&gt;

&lt;p&gt;شما می‌تونید ده‌ها، هزاران، یا حتی میلیون‌ها پیام در روز بدون هزینه و با دقت ۹۵٪ در کمتر از ۲۵۰میلی‌ثانیه بدون توجه به پلتفرم کاربر به دستشون برسونید. به همین سادگی، به همین خوشمزگی.😍&lt;/p&gt;

&lt;h2 id=&quot;fcm-account&quot;&gt;افتتاح حساب و ایجاد یک پروژه اندروید در فایربیس&lt;/h2&gt;

&lt;p&gt;پس از ثبت‌نام و ورود به &lt;a href=&quot;https://console.firebase.google.com/&quot;&gt;کنسول فایربیس،&lt;/a&gt; می‌بینید که یک پروژه آماده و البته دمو به اسم &lt;strong&gt;&lt;a href=&quot;https://console.firebase.google.com/project/fir-demo-project/overview&quot;&gt;Firebase Demo Project&lt;/a&gt;&lt;/strong&gt; وجود داره، این پروژه فقط درحالت View Only و تنها برای دیدن امکانات فایربیس ایجاد شده. برای ایجاد اولین پروژه فقط کافیه روی Add Project کلیک کنید.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-10-24/fcm-0.png&quot; alt=&quot;Firebase Cloud Messaging Console&quot; /&gt;&lt;/p&gt;

&lt;p&gt;در پنجره باز شده اسمی برای پروژه (FirebaseApp) می‌نویسیم. بهتره Country/region روی همون UnitedStates باقی بمونه. توجه کنید که برای استفاده از Firebase محدودیت وجود داره و فقط می‌تونید ۳ پروژه ایجاد کنید! برای ساختن بیشتر از ۳ پروژه یا باید با یه حساب کاربری دیگه وارد بشید یا اینکه هزینه پرداخت کرده و ظرفیت کنسولتون رو افزایش بدید.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-10-24/fcm-1.png&quot; alt=&quot;Firebase Cloud Messaging Console&quot; /&gt;&lt;/p&gt;

&lt;p&gt;پروژه اولیه ایجاد شده. حالا وقتی وارد پنل می‌شید ۳تا گزینه دارید، ما از بین گزینه‌های پایین، Android App رو انتخاب می‌کنیم.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-10-24/fcm-2.png&quot; alt=&quot;Firebase Cloud Messaging Console&quot; /&gt;&lt;/p&gt;

&lt;p&gt;خب، در این مرحله باید مشخصات اپ رو ثبت کنیم. اول از همه &lt;strong&gt;Package Address&lt;/strong&gt; اپ رو وارد می‌کنیم، و بعد در &lt;strong&gt;App nickname&lt;/strong&gt; همونطور که از اسمش مشخصه یه اسم برای پروژمون می‌نویسیم. در بخش &lt;strong&gt;SHA-1&lt;/strong&gt; میتونید امضای امنیتی اپتون رو وارد کنید، درصورتی که خواستید امنیت بیشتری لحاظ کنید که فقط روی همون پکیج با همون امضا کار کنه (ما که خالی میزاریم 😇). و بعدش هم که &lt;strong&gt;Register App&lt;/strong&gt; رو می‌زنیم.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-10-24/fcm-3.png&quot; alt=&quot;Firebase Cloud Messaging Console&quot; /&gt;&lt;/p&gt;

&lt;p&gt;خب پروژه ایجاد شده، فقط کافیه فایل &lt;strong&gt;google-service.json&lt;/strong&gt; رو دانلود کنیم و سپس روی Continue کلیک کنیم.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-10-24/fcm-4.png&quot; alt=&quot;fcm-4&quot; /&gt;&lt;/p&gt;

&lt;p&gt;حالا اون فایل JSON رو، مثل تصویر زیر، به پروژه اپلیکیشنمون (که امیدوارم از قبل درسته کرده بوده باشید) در مسیر &lt;code class=&quot;highlighter-rouge&quot;&gt;../Project/app&lt;/code&gt; کپی می‌کنیم.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-10-24/fcm-5.png&quot; alt=&quot;Firebase Cloud Messaging Console&quot; /&gt;&lt;/p&gt;

&lt;p&gt;خب پروژمون ایجاد شده و کار تمومه.با کلیک روی پروژه اپلیکیشن ایجاد شده در کنسول فایربیس، می‌تونیم وارد پنل بشیم و کارهای که لازمه داریم رو انجام بدیم.&lt;/p&gt;

&lt;h2 id=&quot;basic-app-settings-for-fcm&quot;&gt;تنظیمات اولیه اپلیکیشن اندروید&lt;/h2&gt;

&lt;p&gt;قبل شروع همه‌چیز این رو بگم با مراجعه به &lt;a href=&quot;https://github.com/sadra/FirebaseApp&quot;&gt;این ریپوی گیتهاب&lt;/a&gt;، می‌تونید به نمونه اپلیکیشنی که برای همین منظور ایجاد کردم دسترسی داشته باشید.&lt;/p&gt;

&lt;p&gt;اول از همه در فایل build.gradle مربوط به &lt;strong&gt;project&lt;/strong&gt;، خطوط زیر رو اصلاح و اضافه میکنیم.&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// Project-level build.gradle (&amp;lt;project&amp;gt;/build.gradle):&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;buildscript&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;dependencies&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// Add this line&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;classpath&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'com.google.gms:google-services:3.1.0'&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;و در فایل build.gradle مربوط به &lt;strong&gt;app.module&lt;/strong&gt; خطوط زیر رو در انتهای محتویات قبلی اضافه می‌کنیم:&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// App-level build.gradle (&amp;lt;project&amp;gt;/&amp;lt;app-module&amp;gt;/build.gradle):&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// Add to the bottom of the file&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;apply&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;plugin:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'com.google.gms.google-services'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;و همچنین لازمه که لایبرری های مربوط به فایربیس رو هم به &lt;strong&gt;dependencies&lt;/strong&gt; اضافه کنیم.&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// Project-level build.gradle (&amp;lt;project&amp;gt;/build.gradle):&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dependencies&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// Add this line&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;compile&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;com.google.firebase:firebase-core:11.+&quot;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;compile&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;com.google.firebase:firebase-messaging:11.+&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;و در نهایت باید گریدل رو Sync کنیم. بعد از اینکه Gradle کتابخونه‌های مد نظرش رو دریافت و آماده استفاده شد میریم سراغ مرحله بعد.&lt;/p&gt;

&lt;p&gt;خب، حالا اول از همه در مسیر اپلیکیشن یک دایرکتوری به اسم &lt;code class=&quot;highlighter-rouge&quot;&gt;PushNotification&lt;/code&gt; ایجاد کرده، و در اون یک کلاس به اسم &lt;code class=&quot;highlighter-rouge&quot;&gt;FCMInstanceIDService&lt;/code&gt;، که از &lt;code class=&quot;highlighter-rouge&quot;&gt;FirebaseInstanceIdService&lt;/code&gt; ارث‌بری میکنه، ایجاد میکنیم. این کلاس وظیفه ساخت توکن و بروزرسانی اون درصورتی که اکسپایر شده رو بر عهده داره.&lt;/p&gt;

&lt;p&gt;وقتی که کاربر یک توکن دریافت کرده یا توکن قبلی وی باطل و توکن جدید صادر شد، تابع &lt;code class=&quot;highlighter-rouge&quot;&gt;onTokenRefresh&lt;/code&gt; در این کلاس صدا فراخونی میشه. (&lt;a href=&quot;https://github.com/sadra/FirebaseApp/blob/master/app/src/main/java/com/isapanah/firebase/PushNotification/FCMInstanceIDService.java&quot;&gt;مشاهده کلاس در گیتهاب&lt;/a&gt;)&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;FCMInstanceIDService&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FirebaseInstanceIdService&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;onTokenRefresh&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;onTokenRefresh&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;refreshedToken&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FirebaseInstanceId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getToken&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
	&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;خب بعد از اینکه کاربر توکن دریافت کرد میتونه از سرویس FCM استفاده کنه، پس ما هم باید یه کلاس ایجاد کنیم که پیام‌های دریافتی FCM رو مدیریت کنه. برای این منظور کلاسی به نام &lt;code class=&quot;highlighter-rouge&quot;&gt;FCMService&lt;/code&gt; ایجاد کرده و اون رو  &lt;strong&gt;extend&lt;/strong&gt; می‌کنیم از &lt;code class=&quot;highlighter-rouge&quot;&gt;FirebaseMessagingService&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;در این کلاس ما می‌تونیم با استفاده از تابع &lt;code class=&quot;highlighter-rouge&quot;&gt;onMessageReceived&lt;/code&gt; در هنگام دریافت پیامی از FCM اون رو مدیریت کرده و هر بلایی که میخواییم سرش بیاریم 😈 (&lt;a href=&quot;https://github.com/sadra/FirebaseApp/blob/master/app/src/main/java/com/isapanah/firebase/PushNotification/FCMService.java&quot;&gt;مشاهده کلاس در گیتهاب&lt;/a&gt;)&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;FCMService&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FirebaseMessagingService&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;onMessageReceived&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RemoteMessage&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;remoteMessage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;Log&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;FCM&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;New notification from: &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;remoteMessage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getFrom&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;بعد از اینکه دو کلاس &lt;strong&gt;FCMInstanceIDService&lt;/strong&gt; و &lt;strong&gt;FCMService&lt;/strong&gt; رو آماده کردیم، وقتشه که اونهارو در &lt;code class=&quot;highlighter-rouge&quot;&gt;AndroidManifest&lt;/code&gt; هم به عنوان سرویس رویداد‌های &lt;code class=&quot;highlighter-rouge&quot;&gt;INSTANCE_ID_EVENT&lt;/code&gt; و &lt;code class=&quot;highlighter-rouge&quot;&gt;MESSAGING_EVENT&lt;/code&gt; معرفی کنیم.&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- ADD this lines before &amp;lt;/application&amp;gt; close tag --&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;service&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;android:name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;.PushNotification.FCMInstanceIDService&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;intent-filter&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;action&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;android:name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;com.google.firebase.INSTANCE_ID_EVENT&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/intent-filter&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/service&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;&amp;lt;service&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;android:name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;.PushNotification.FCMService&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;intent-filter&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;action&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;android:name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;com.google.firebase.MESSAGING_EVENT&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/intent-filter&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/service&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;خب در همینجا هم میتونیم آیکون ناتیفیکیشن و رنگ پیش‌زمینه اون رو در منیفست مشخص کنیم. (&lt;a href=&quot;https://github.com/sadra/FirebaseApp/blob/master/app/src/main/AndroidManifest.xml&quot;&gt;مشاهده AndroidManifest در گیتهاب&lt;/a&gt;)&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- ADD this lines before &amp;lt;/application&amp;gt; close tag --&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;meta-data&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;android:name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;com.google.firebase.messaging.default_notification_icon&quot;&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;android:resource=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;@mipmap/ic_launcher&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;&amp;lt;meta-data&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;android:name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;com.google.firebase.messaging.default_notification_color&quot;&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;android:resource=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;@color/colorPrimary&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;البته این دو متا دیتا فقط برای ورژن های اندروید 21 یعنی Lolipop به بالا کار میکنه!&lt;/p&gt;

&lt;h2 id=&quot;node-service&quot;&gt;سرویس پوش‌ناتیفیکیشن با Node.js&lt;/h2&gt;

&lt;p&gt;خب قبل از اینکه بریم سراغ تنظیمات بعدی و آماده‌سازی اپلیکیشن، لازمه که یه سرویسی هم فراهم کنیم برای اینکه بتونیم با استفاده از API گوگل برای تلفن‌های همراهی که اپلیکیشن مارو نصب دارند پیام ارسال کنیم.&lt;/p&gt;

&lt;h3 id=&quot;prepare-node-service&quot;&gt;آماده سازی سرویس Node.js&lt;/h3&gt;

&lt;p&gt;من برای اینکه شما درگیر کارهای مربوط به تهیه این سرویس نشید از قبل اون رو با Node.js نوشتم و در &lt;a href=&quot;https://github.com/sadra/FCMPushNotification&quot;&gt;ریپوزیتوری گیتهاب&lt;/a&gt; قرار دادم.
فقط کافیه ترمینال رو باز کرده و با دستور &lt;code class=&quot;highlighter-rouge&quot;&gt;git clone REPO_ADDRESS&lt;/code&gt; اون رو در جایی که میخواهید کلون بگیرید.
بعد از کلون گرفتن (با استفاده از ترمینال یا CMD) وارد دایرکتوری اصلی پروژه node شده و دستور &lt;code class=&quot;highlighter-rouge&quot;&gt;npm install&lt;/code&gt; رو اجرا کنید تا پکیج‌های مورد نیاز رو دانلود کنه. در نهایت بعد از نصب شدن پکیج ها فقط با اجرای دستور &lt;code class=&quot;highlighter-rouge&quot;&gt;npm start&lt;/code&gt; سرویس آماده استفاده ست و با آدرس &lt;code class=&quot;highlighter-rouge&quot;&gt;http://localhost:3000&lt;/code&gt; در دسترس شماست. پس:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;➜  git clone git@github.com:sadra/FCMPushNotification.git
➜  &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ~/FCMPushNotification
➜  FCMPushNotification git:&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;master&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; ✗ npm install
➜  FCMPushNotification git:&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;master&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; ✗ npm start
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;اگر فایل &lt;code class=&quot;highlighter-rouge&quot;&gt;app.js&lt;/code&gt; رو در این پروژه باز کنید چند کلید وجود داره، اول از همه لازمه که کلید امنیتی استفاده از FCM رو از کنسول فایربیس پروژتون دریافت کرده و بجای API_KEY قرار بدید. برای دریافت API Key به کنسول فایربیس مراجعه کرده، روی پروژه FirebaseApp، و بعد هم روی منوی پروژه اپ اندروید Firebase کلیک کنید و به Settings این اپ برید.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-10-24/fcm-6.png&quot; alt=&quot;Firebase Cloud Messaging Console&quot; /&gt;&lt;/p&gt;

&lt;p&gt;در پنجره باز شده به سربرگ Cloud Messaging رفته کد Server Key رو کپی کرده و در پروژه Node.js بجای &lt;code class=&quot;highlighter-rouge&quot;&gt;API_KEY&lt;/code&gt; قرار بدید.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-10-24/fcm-7.png&quot; alt=&quot;Firebase Cloud Messaging Console&quot; /&gt;&lt;/p&gt;

&lt;p&gt;در بعد از اون هم لازمه توکن اون اپلیکیشنی برای تست استفاده می‌کنید رو برای &lt;code class=&quot;highlighter-rouge&quot;&gt;USER_KEY&lt;/code&gt; مقدار‌دهی کنید. (این گزینه انتخابیست و الزامی نداره، اما بهتره یک یوزر تست داشته باشیم برای جلوگیری از خطاهای انسانی و تست اپ.)&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;/// PATH: ../FCMPushNotification/app.js&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;API_KEY&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;key=&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;AAAAr_E2NCM:APA91bEgmznGj0R5PpRg1ek7GKeMmpADJ5Bj...&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// Your FCM server API key&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;USER_KEY&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;eWRAtJC2zTs:APA91bEZ_zgxYiEWFaxpHI_wMDO5IApmEt...&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// User FCM Token ID&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;using-nodejs&quot;&gt;استفاده از سرویس پوش Node.js&lt;/h3&gt;

&lt;p&gt;قبل از اینکه به توضیحات استفاده از این سرویس بپردازم لازمه بدونید که ما چند نوع پیام می‌تونیم ارسال کنیم. مطابق با مستندات FCM ما فقط ۲ نوع پیام داریم: &lt;strong&gt;Notification&lt;/strong&gt; و &lt;strong&gt;Data&lt;/strong&gt;. اما هرکدوم چی هستن و چه فرقی باهم دارن؟&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;h4 id=&quot;node-notification&quot;&gt;Notification&lt;/h4&gt;

    &lt;p&gt;این نوع پیام فقط ۲ بخش داره، &lt;code class=&quot;highlighter-rouge&quot;&gt;title&lt;/code&gt; و &lt;code class=&quot;highlighter-rouge&quot;&gt;body&lt;/code&gt;. شما فقط می‌تونید یه پیام ساده با یک عنوان و یک متن ارسال کنید که محدودیت کارکتر هم دارید. ساختار این پیام به این شکله:&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;payload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;notification&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Title of the notification message&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;This is Body of the notification message.&quot;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;h4 id=&quot;node-data&quot;&gt;Data&lt;/h4&gt;

    &lt;p&gt;اما اگر پیام شما از نوع Data باشه، شما این امکان رو دارید که پیامتون رو بصورت JSON و با هر ساختار و مقادیری که دوست دارید ارسال کنید، برای مثال:&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;payload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;850&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;2:45&quot;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;h4 id=&quot;node-combined-message&quot;&gt;Combined Message&lt;/h4&gt;

    &lt;p&gt;جالب اینجاست که شما می‌تونید هردو نوع Notification و Data رو باهم یکجا بفرستید. برای مثال یه پیام ناتیفیکیشن دارید که میخواهید هم به کاربر پیامی نشون بده هم مقداری رو در دیتابیس اپلیکیشن تغییر بده:&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;payload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;notification&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;$GOOG up 1.43% on the day&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;$GOOG gained 11.80 points to close at 835.67, up 1.43% on the day.&quot;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;stock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;GOOG&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;829.62&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;635.67&quot;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;من در این پروژه با استفاده از Express و بر پایه REST API یکسری Route آماده کردم تا شما بتونید بدون دردسر پیام‌هاتون رو ارسال کنید. ما 4 روت داریم، که هرکدوم به ترتیب وظایف زیر رو برعهده دارند:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;با این روت می‌تونید یک پیام به صورت notification ساده ارسال کنید.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-http highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;err&quot;&gt;POST /send/notification
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;با این روت می‌تونید یک پیام data ساده ارسال کنید.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-http highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;err&quot;&gt;POST /send/data-notification
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;توسط این روت یک پیام data برای یک دسته خاص از کاربرانمون که VIP هستند ارسال می‌کنیم (در ادامه توضیح خواهم داد).&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-http highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;err&quot;&gt;POST /send/data-notification/VIP
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;توسط این روت هم یک پیام combined برای یک دسته خاص از کاربرانمون که VIP هستند ارسال می‌کنیم.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-http highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;err&quot;&gt;POST /send/combined-notification/VIP
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;برای استفاده از این روت‌ها می‌تونید از دستور CURL در ترمینال کمک بگیرید. اما من توصیه میکنم از &lt;a href=&quot;https://www.getpostman.com/&quot;&gt;Postman&lt;/a&gt; برای ریکوئست زدن استفاده کنید. کالکشن این ریکوئست‌هارو هم من از قبل برای شما آماده کردم و در پروژه قرار دادم. فقط کافیه از داخل دایرکتوری پروژه، در فولدر postman-export و یا &lt;a href=&quot;https://github.com/sadra/FCMPushNotification/blob/master/postman-export/Firebase%20Push%20Notification.postman_collection&quot;&gt;از اینجا در ریپوی گیتهاب&lt;/a&gt; اون رو دریافت کرده و به &lt;a href=&quot;https://www.getpostman.com/docs/postman/collections/data_formats&quot;&gt;Postmanتون import&lt;/a&gt; کنید. و یا &lt;a href=&quot;https://www.getpostman.com/collections/3776ad8010e1b7ae2c6e&quot;&gt;از اینجا&lt;/a&gt; بطور مستقیم به پست‌منتون اضافه کنید.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-10-24/fcm-8.png&quot; alt=&quot;Firebase Cloud Messaging Console&quot; /&gt;&lt;/p&gt;

&lt;p&gt;حالا تنها کاری که لازمه انجام بدید اینه که سرویس رو با &lt;code class=&quot;highlighter-rouge&quot;&gt;npm start&lt;/code&gt; اجرا کرده و با Postman ریکوئست‌هاتون رو ارسال کنید. خب کارمون با سرویس Node.js و Postman تا اینجا تموم شد.&lt;/p&gt;

&lt;h2 id=&quot;prepare-app-for-fcm&quot;&gt;آماده سازی اپلیکیشن برای دریافت ناتیفیکیشن&lt;/h2&gt;

&lt;p&gt;خب رسیدیم به اصل ماجرا، حالا هم اپلیکیشن آماده است هم سرویس Node.js. اگه پیام رو ارسال کنید اپلیکیشن بدون هیچ مشکلی اون رو دریافت می‌کنه اما چیزی نشون نمیده، چون ما هنوز بهش نگفتیم با پیامی که دریافت کرده چه کاری بکنه.&lt;/p&gt;

&lt;h3 id=&quot;receiving-notification&quot;&gt;دریافت ناتیفیکیشن&lt;/h3&gt;

&lt;p&gt;همونطور که در قسمت قبلی گفتم پیام‌ها توسط کلاس &lt;code class=&quot;highlighter-rouge&quot;&gt;FCMService&lt;/code&gt; در تابع &lt;code class=&quot;highlighter-rouge&quot;&gt;onMessageReceived&lt;/code&gt; می‌تونیم دریافت کنیم. و همچنین گفتم که ۲نوع پیام داریم، که یا notification هستند یا data ( و یا هردو باهم ). برای دریافت پیام notification باید تابع &lt;code class=&quot;highlighter-rouge&quot;&gt;getNotification&lt;/code&gt; و برای data از تابع &lt;code class=&quot;highlighter-rouge&quot;&gt;getData&lt;/code&gt; استفاده می‌کنیم.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;onMessageReceived&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RemoteMessage&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;remoteMessage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;Log&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TAG&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;New notification from: &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;remoteMessage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getFrom&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;remoteMessage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getNotification&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;Log&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TAG&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Notification message: &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;remoteMessage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getNotification&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;notificationMessageReceived&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;remoteMessage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getNotification&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getTitle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;remoteMessage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getNotification&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getBody&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;remoteMessage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getData&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;Log&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TAG&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Data Payload: &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;remoteMessage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getData&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;dataMessageReceived&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;remoteMessage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getData&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;اگر پیام که ارسال شده از نوع &lt;strong&gt;notification&lt;/strong&gt; بود، فقط کافیه title و body رو گرفته و با استفاده از &lt;code class=&quot;highlighter-rouge&quot;&gt;NotificationCompat&lt;/code&gt; اون رو نشون بدیم.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;notificationMessageReceived&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;NotificationCompat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Builder&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;notificationBuilder&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;NotificationCompat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Builder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setContentTitle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setContentText&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setAutoCancel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setSmallIcon&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getNotificationIcon&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setLargeIcon&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BitmapFactory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;decodeResource&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getResources&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;mipmap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;ic_launcher&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setColor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ContextCompat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getColor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;colorPrimary&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;NotificationManager&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;notificationManager&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NotificationManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getSystemService&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Context&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;NOTIFICATION_SERVICE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;notificationManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;notify&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getNotify&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;notificationBuilder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;و اگر پیام از نوع &lt;strong&gt;data&lt;/strong&gt; بود، با کمک &lt;code class=&quot;highlighter-rouge&quot;&gt;getData&lt;/code&gt; محتوی پیام رو گرفته، به فایل &lt;strong&gt;JSONObject&lt;/strong&gt; تبدیل کرده و ازش استفاده می‌کنیم.&lt;/p&gt;

&lt;p&gt;من در این پروژه نمونه برای پیام data یک آبجکت بنام &lt;code class=&quot;highlighter-rouge&quot;&gt;type&lt;/code&gt; تعریف کردم. و بر اساس &lt;strong&gt;type&lt;/strong&gt; پیامِ دیتا، مشخص میکنم که چه رفتاری باید از اپلیکیشن سر بزنه.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;dataMessageReceived&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;java&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;util&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;java&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;lang&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;java&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;lang&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;JSONObject&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bodyObjects&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JSONObject&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bodyObjects&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;equals&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;banner&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)){&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;showNotificationWithBanner&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bodyObjects&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;title&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bodyObjects&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;message&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bodyObjects&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;banner_url&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bodyObjects&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;equals&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;dialog_message&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)){&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;broadcastTheMessage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bodyObjects&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;title&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bodyObjects&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;message&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Log&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;There is a problem&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Exception: &quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;اگه type برابر banner باشه، اول پیام رو دریافت کرده، و بعد یه &lt;code class=&quot;highlighter-rouge&quot;&gt;BigPictureStyle&lt;/code&gt; برای &lt;code class=&quot;highlighter-rouge&quot;&gt;NotificationCompat&lt;/code&gt; میسازیم، و در نهایت اون رو به &lt;code class=&quot;highlighter-rouge&quot;&gt;NotificationCompat.Builder&lt;/code&gt; نسبت‌دهی می‌کنیم.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;showNotificationWithBanner&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bannerURL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;//Style for showing notification With Banner&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Bitmap&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;remote_picture&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BitmapFactory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;decodeResource&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getResources&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;drawable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;gray_banner&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;NotificationCompat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;BigPictureStyle&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;notiStyle&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;NotificationCompat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;BigPictureStyle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;remote_picture&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BitmapFactory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;decodeStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;InputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;URL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bannerURL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getContent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IOException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;printStackTrace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;notiStyle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;bigPicture&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;remote_picture&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;NotificationCompat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Builder&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;notificationBuilder&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;NotificationCompat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Builder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setContentTitle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setContentText&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setAutoCancel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setSmallIcon&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getNotificationIcon&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setLargeIcon&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BitmapFactory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;decodeResource&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getResources&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;mipmap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;ic_launcher&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setColor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ContextCompat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getColor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;colorPrimary&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setStyle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;notiStyle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;NotificationManager&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;notificationManager&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NotificationManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getSystemService&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Context&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;NOTIFICATION_SERVICE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;notificationManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;notify&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getNotify&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;notificationBuilder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;مواقعی هست که ما نمی‌خواهیم پیام دریافتی رو بصورت ناتیفیکیشن دریافت کنیم. بلکه میخوایم مثلا اطلاعات دریافتی رو در دیتابیس ذخیره کنیم، یا میخواهیم چیزی رو به کاربر نشون بدیم. من در این نمونه میخواستم که به کاربر یه دیالوگ نشون بدم.
من مقدار &lt;strong&gt;type&lt;/strong&gt; پیام رو برابر &lt;code class=&quot;highlighter-rouge&quot;&gt;dialog_message&lt;/code&gt; گذاشتم. که بعدش تابع &lt;code class=&quot;highlighter-rouge&quot;&gt;broadcastTheMessage&lt;/code&gt; فراخونی میشه، و این تابع دیتای دریافتی رو در داخل اپلیکیشن &lt;strong&gt;BroadCast&lt;/strong&gt; میکنه.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;broadcastTheMessage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Intent&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;notification&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Intent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FCM_ACTION_NEW_NOTIFICATION&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;notification&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;putExtra&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;title&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;notification&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;putExtra&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;message&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;LocalBroadcastManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;sendBroadcast&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;notification&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;خوب وقتشه تظیمات مربوط به اونجایی که قراره دیالوگ رو نشون بده هم انجام بدیم. پس در MainActivity اول میام یه &lt;code class=&quot;highlighter-rouge&quot;&gt;BroadcastReceiver&lt;/code&gt; ایجاد میکنم و بهش میگم هرموقع پیامی دریافت کردی که کلید &lt;strong&gt;FCM_ACTION_NEW_NOTIFICATION&lt;/strong&gt; رو داشت، متد مورد نظر من رو صدا کن.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BroadcastReceiver&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mRegistrationBroadcastReceiver&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;onCreate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Bundle&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;savedInstanceState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;mRegistrationBroadcastReceiver&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BroadcastReceiver&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;onReceive&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Context&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Intent&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;intent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;switch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;intent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getAction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;FCM_ACTION_NEW_NOTIFICATION:&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;showDialog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;intent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//Call the method that shows AlertDialog&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;};&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;و بعدش هم در متد &lt;code class=&quot;highlighter-rouge&quot;&gt;onResume&lt;/code&gt; لازمه که بگم این اکتیویتی رو برای پیام برودکست شده ای که کلیدش &lt;strong&gt;FCM_ACTION_NEW_NOTIFICATION&lt;/strong&gt; هست، رجیستر کن.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;onResume&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;onResume&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;LocalBroadcastManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;registerReceiver&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mRegistrationBroadcastReceiver&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IntentFilter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FCM_ACTION_NEW_NOTIFICATION&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;نکته:&lt;/strong&gt; توجه کنید که رجیستر کردن برای یک برادکست حتما باید بعد از ساختن BroadcastReceiver باشه.&lt;/p&gt;

&lt;p&gt;همه چی آمادست. اگه پیام معمولی ارسال کنیم یا بصورت دیتای بنری، به راحتی ناتیفیکیشن رو نشون میده.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-10-24/fcm-9.png&quot; alt=&quot;Firebase Notification&quot; /&gt;&lt;/p&gt;

&lt;p&gt;و اگر هم نوع پیام data بصورت dialog باشه، برادکست به راحتی دریافت شده و دیالوگ نشون داده میشه.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-10-24/fcm-11.jpg&quot; alt=&quot;Firebase Notification&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;send-and-receive-notification&quot;&gt;ارسال و دریافت ناتیفیکیشن برای گروهی از کاربران&lt;/h3&gt;

&lt;p&gt;خب تا الان یاد گرفتیم که برای کاربران اپلیکیشنمون ناتیفیکیشن بفرستیم. اما مواقعی پیش میاد که نمیخواییم برای همه کاربرها پیام ارسال کنیم، بلکه میخوایم فقط گروهی از اونها پیام مارو دریافت کنند. اما چطوری؟&lt;/p&gt;

&lt;p&gt;ما به دو صورت می‌تونیم پیام ارسال کنیم:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;ارسال پیام بر اساس توکن کاربر (بصورت فردی یا گروهی)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ارسال پیام بر اساس Topic&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;تا قبل از این ما بر اساس توکن به کاربر پیام می‌فرستادیم. بهتره یه نگاهی به ساختار ریکوئستی که برای FCM ارسال میکنیم بندازیم:&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;payload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
   &lt;span class=&quot;na&quot;&gt;notification&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
       &lt;span class=&quot;s2&quot;&gt;&quot;title&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
       &lt;span class=&quot;s2&quot;&gt;&quot;body&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;message&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
   &lt;span class=&quot;na&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;USER_KEY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;c1&quot;&gt;// to : TOPIC_GLOBAL,&lt;/span&gt;
   &lt;span class=&quot;c1&quot;&gt;// to : TOPIC_VIP_USER,&lt;/span&gt;
   &lt;span class=&quot;c1&quot;&gt;// condition : &quot;'onscreen' in topics &amp;amp;&amp;amp; 'vip_user' in topics&quot;,&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;ما در &lt;strong&gt;payload&lt;/strong&gt; (درواقع درخواستی که به سمت FCM ارسال میشه)، دو بخش اصلی داریم، اولی &lt;code class=&quot;highlighter-rouge&quot;&gt;notification&lt;/code&gt; یا &lt;code class=&quot;highlighter-rouge&quot;&gt;data&lt;/code&gt; که حامل پیام ما به کاربر هستند و &lt;code class=&quot;highlighter-rouge&quot;&gt;to&lt;/code&gt; یا &lt;code class=&quot;highlighter-rouge&quot;&gt;condition&lt;/code&gt; که مقصد و دریافت کننده پیام رو مشخص میکنه. اما هرکدوم چیکار می‌کنند:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;مقصد مشخص &lt;strong&gt;to&lt;/strong&gt;&lt;/p&gt;

    &lt;p&gt;ما با دونستن توکن کاربر می‌تونیم پیام رو به یه کاربر خاص یا مجموعه ای از کاربرها ارسال کنیم. برای مثال:&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;XXXXX:YYYYYYYUUUUUIIIIOOOOOO&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;//or&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;XXXXX:YYYYYYYUUUUUIIIIAAAAA&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;XXXXX:YYYYYYYUUUUUIIIIBBBBB&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;XXXXX:YYYYYYYUUUUUIIIICCCCC&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;سرویس FCM به ما اجازه می‌ده که کاربرنامون رو در &lt;code class=&quot;highlighter-rouge&quot;&gt;Topic&lt;/code&gt; یا موضوع (و موضوع‌های) خاصی عضو کنیم. و بدین ترتیب پیام فقط برای کاربرانی که در فلان موضوع عضو هستند ارسال بشه. به این منظور مقصد دریافت رو با کلیدواژه &lt;strong&gt;topics&lt;/strong&gt; و نام تاپیک می‌نویسیم. برای مثال در زیر، مقصدِ پیام برای کاربرانی که عضو موضوع &lt;code class=&quot;highlighter-rouge&quot;&gt;vip_user&lt;/code&gt; هستند تعریف شده:&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/topics/vip_user&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;مقصد شرطی &lt;strong&gt;condition&lt;/strong&gt;&lt;/p&gt;

    &lt;p&gt;مقصد شرطی یا conditional به ما این امکان رو میده که پیام رو به کاربران بر اساس شرط عضویت اونها در تاپیک‌های خاصی بصورت AND و OR ارسال کنیم. برای مثال در زیر پیام برای کاربرانی که عضو VIP بوده و همچنین خانم هستند ارسال میشه:&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;condition&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;'gender_female' in topics &amp;amp;&amp;amp; 'vip_user' in topics&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;user-topics&quot;&gt;ارسال و دریافت ناتیفیکیشن بر اساس Topic یا موضوعی خاص&lt;/h3&gt;

&lt;p&gt;در این پروژه ای که برای نمونه ساختم، خواستم پیام برای کاربرانی که درحال حاضر صفحه اپلیکیشنشون باز بوده و از نوع VIP بودن ارسال کنم. پس اول از همه موقعی که اپلیکیشن لانچ شد در متد &lt;code class=&quot;highlighter-rouge&quot;&gt;onResume&lt;/code&gt; اونهارو در تاپیک &lt;code class=&quot;highlighter-rouge&quot;&gt;onscreen&lt;/code&gt; عضو کردم:&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;onResume&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
   &lt;span class=&quot;kd&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;onResume&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;FirebaseMessaging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;subscribeToTopic&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;onscreen&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;و وقتی هم میره روی &lt;code class=&quot;highlighter-rouge&quot;&gt;onPause&lt;/code&gt; عضویتش رو از اون تاپیک لغو میکنم:&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;onPause&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
   &lt;span class=&quot;kd&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;onPause&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;FirebaseMessaging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;unsubscribeFromTopic&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;onscreen&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;و حالا برای عضویت در حالت VIP یه FloatActionButton ساختم که وقتی کاربر روش کلیک میکنه اون رو عضو VIP کرده یا عضویتش رو لغو میکنه.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;setUserVIP&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;isVIP&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;View&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;getSharedPreferences&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FCM&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;edit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;putBoolean&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;VIP_USER&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;isVIP&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;apply&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;VIPUser&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setImageResource&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;isVIP&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;drawable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;special&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;drawable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;not_special&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isVIP&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;Snackbar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;make&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;You are a VIP user.&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Snackbar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;LENGTH_LONG&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;FirebaseMessaging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;subscribeToTopic&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;vip_user&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;Snackbar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;make&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;You are a regular user&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Snackbar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;LENGTH_LONG&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;FirebaseMessaging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;unsubscribeFromTopic&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;vip_user&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;خب، همه‌چی آمادست، و فقط کافیه از Postman یه ریکئوست روی  &lt;code class=&quot;highlighter-rouge&quot;&gt;/send/data-notification/VIP&lt;/code&gt; بفرستیم، و نتیجه اینکه:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-10-24/fcm-10.png&quot; alt=&quot;Firebase Notification&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;send-message-to-all&quot;&gt;ارسال پیام برای همه کاربران&lt;/h3&gt;

&lt;p&gt;حالا اگه بخواییم پیام برای همه کاربرا ارسال بشه چی؟ آیا باید توکن همه کابرارو لیست کنیم و بفرستیم؟ نه، نیازی به اینکار نیست! فقط کافیه همون اول که اپلیکیشن کاربر رو عضو تاپیک &lt;code class=&quot;highlighter-rouge&quot;&gt;global&lt;/code&gt; کنید و بدین صورت همه کاربرانتون عضو این تاپیک میشن.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;onResume&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;onResume&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;FirebaseMessaging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;subscribeToTopic&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;global&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;وبعد، هرموقع خواستید پیام برای همه کاربران ارسال بشه، فقط کافیه سمت سرور تاپیکِ مقصد رو روی &lt;code class=&quot;highlighter-rouge&quot;&gt;global&lt;/code&gt; ست کنید:&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/topics/global&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;other-settings&quot;&gt;دیگر تنظیمات ارسال پیام&lt;/h3&gt;

&lt;p&gt;&lt;b id=&quot;other-settings-priority&quot;&gt;اولویت Priority:&lt;/b&gt; شما میتونید برای پیامی که ارسال می‌کنید اولویت گذاری کنید. ما به ازای هر پیام دو اولویت  &lt;code class=&quot;highlighter-rouge&quot;&gt;normal&lt;/code&gt;  و &lt;code class=&quot;highlighter-rouge&quot;&gt;high&lt;/code&gt; داریم.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;high: این اولویت برای مواقعی‌ست که میخواییم پیام در سریعترین زمان ممکن به دست کاربر برسه،‌و اگر اولویت همین باشه، حتی موقعی که گوشی لاک بوده و اینترنتش برای صرفه‌جویی برق قطع باشه، اینترنت رو وصل میکنه، پیام رو دریافت میکنه و به کاربر نشون میده. این حالت برای اپ‌هایی که پیام‌رسان هستند یا باید پیام همون لحظه به دست کاربر برسه، بیشتر استفاده میشه. در حالت پیشفرض برای پیام‌های notification اولویت روی high قرار داره.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;normal: این اولویت برای مواقعی‌ست که زمان رسیدن پیام اهمیت نداره،‌و به محض اینکه کاربر گوشیشو از لاک در بیاره و اینترنتش وصل بشه پیام رو بهش نشون میده. درحالت پیشفرض برای پیام‌های data اولویت روی normal قرار داره.&lt;/p&gt;

    &lt;p&gt;البته شما‌ می‌تونید خودتون بصورت دستی هم اولویت رو برای اون پیام مشخص کنید.&lt;/p&gt;

    &lt;p&gt;برای این منظور در سرویس Node.js و در بخش options، آیتم مربوط به priority رو اضافه می‌کنیم.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;b id=&quot;other-settings-time-to-alive&quot;&gt;زمان اعتبار پیام timeToLive:&lt;/b&gt; ممکن است شما بخوایید برای پیام خودتون اعتبار زمانی اعمال کنید، و اگه پیام تا فلان موقع رسید دست کاربر که هیچ، اگه نرسید دیگه به درد نمیخوره نرسون بهش. بصورت پیشفرض این مقدار روی ۰ قرار داره. سرویس FCM تمام تلاششو میکنه تا پیامتون حتما به کاربر برسه ولی خب اعتقاد داره “Now or Never”، یعنی پیامتون یا همین الان به دست کاربر میرسه یا اصن نمیرسه! 😎
برای این مورد در سرویس Node.js و در بخش options، آیتم مربوط به timeToLive رو اضافه می‌کنیم.&lt;/p&gt;

&lt;p&gt;&lt;b id=&quot;other-settings-collapse-key&quot;&gt;کلید جایگزینی پیام collapse_key:&lt;/b&gt; البته معنی تحت الفضیه این عبارت میشه (کلید اضمحلال 😐🤣). فرض کنید اولویت پیام درحالت normal قرار داره. یه پیام برای کاربر که میفرستین که مثلا میگه فلان جنس ۲۵٪ تخفیف داره اگه همین الان بخری. بعد نیم‌ساعت تصمیم گرفتین که درصد رو کاهش بدین به ۱۰٪. اونهایی که هنوز پیام رو ندیدن لازم نباشه پیام قبلیو ببینن که گیج بشن، همین ۱۰٪ رو ببینن کافیه. برای اینکار از &lt;code class=&quot;highlighter-rouge&quot;&gt;collapse_key&lt;/code&gt; استفاده می‌کنیم.&lt;/p&gt;

&lt;p&gt;هنگامی که اپلیکیشن در حالت Lock قرار داره، پیام رو به کاربر نشون نمیده تا  موقعی که کاربر گوشیشو unlock کنه، اگر پیام جدید با همون کلید دریافت کرد،‌ پیام قبلی رو discard کرده و بجاش این پیام جدید رو نگه می‌داره تا نشون بده.
برای این مورد در سرویس Node.js و در بخش options، آیتم مربوط به collapse_key رو اضافه می‌کنیم.
پس درنهایت مقادیر آپشن میشه:&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;options&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;method&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'POST'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;uri&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'https://fcm.googleapis.com/fcm/send'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;s1&quot;&gt;'Content-Type'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'application/json'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;s1&quot;&gt;'Authorization'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;API_KEY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;priority&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;high&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// or set it on -normal- priority&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;timeToLive&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// this message has 24hours to be expired&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;collapseKey&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;discount&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//or what ever you want&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h2 id=&quot;conclusion&quot;&gt;نتیجه گیری&lt;/h2&gt;

&lt;p&gt;فکر نمیکنم دیگه موردی برای گفتن مونده باشه. سعی کردم تمام چیزهایی که لازمه رو ذکر کرده باشم. فقط میمونه ارسال پیام ناتیفیکیشن از داخل خود کنسول فایربیس که اون بمونه بعد از قسمت Analytics بهش می‌پردازم، چون بخش‌هایی از سرویس Analytics در اون دخیل هستند.&lt;/p&gt;

&lt;p&gt;امیدوارم به راحتی بتونید از این سرویس استفاده کنید. اگه سوال یا مشکلی بود می‌تونید از طریق &lt;a href=&quot;https://twitter.com/sadra_amlashi&quot;&gt;توییتر&lt;/a&gt; یا &lt;a href=&quot;https://t.me/amlashi&quot;&gt;تلگرام&lt;/a&gt; پیام بدید تا باهم در ارتباط باشیم. 😉&lt;/p&gt;

&lt;p&gt;درصورتی که به موارد جدیدی برخوردم، این پست رو به‌روزرسانی خواهم کرد.&lt;/p&gt;</content><author><name>صدرا املشی</name></author><category term="Google" /><category term="Firebase" /><category term="Android" /><summary type="html">بنا بر قولی که در پست قبلی داده بودم، میخوام در یک مجموعه نوشته درباره پیاده سازی و استفاده از سرویس‌های مختلف فایربیس (تا جایی که این امکان برای ما در ایران وجود داشته باشه) صحبت کنم. شما می‌تونید پست‌های این بلاگ را، در رابطه با سرویس‌های فایربیس، از این لینک موضوعی مطالعه کنید.</summary></entry><entry><title type="html">با Firebase مشکلاتتان را به آتش بکشید!</title><link href="//isapanah.com/2017/set-fire-into-the-problems-with-firebase" rel="alternate" type="text/html" title="با Firebase مشکلاتتان را به آتش بکشید!" /><published>2017-10-18T00:00:00+03:30</published><updated>2017-10-18T00:00:00+03:30</updated><id>//isapanah.com/2017/set-fire-into-the-problems-with-firebase</id><content type="html" xml:base="//isapanah.com/2017/set-fire-into-the-problems-with-firebase">&lt;h2 id=&quot;مصائب-مسیح&quot;&gt;مصائب مسیح!&lt;/h2&gt;

&lt;p&gt;تا به امروز اگر می‌خواستیم از سرویسی جهت جمع آوری اطلاعات و آمار درباره وبسایت یا اپلیکیشنمون استفاده کنیم، بی‌شک اولین انتخابمون &lt;strong&gt;&lt;a href=&quot;https://analytics.google.com/&quot;&gt;Google Analytics&lt;/a&gt;&lt;/strong&gt; بود، در درجه بعد سرویس‌هایی مثل &lt;strong&gt;&lt;a href=&quot;https://fabric.io&quot;&gt;Fabric&lt;/a&gt;&lt;/strong&gt; خودنمایی می‌کردند. وای به روزی که نیاز می‌شد تا از سرویسی برای ارسال &lt;strong&gt;PushNotification&lt;/strong&gt; استفاده کنیم، اونوقت باید از &lt;strong&gt;&lt;a href=&quot;https://developers.google.com/cloud-messaging/&quot;&gt;GCM&lt;/a&gt;&lt;/strong&gt;، &lt;strong&gt;&lt;a href=&quot;&quot;&gt;Parse&lt;/a&gt;&lt;/strong&gt; یا &lt;strong&gt;&lt;a href=&quot;&quot;&gt;پوشه&lt;/a&gt;&lt;/strong&gt; استفاده می‌کردیم. بماند که برای اطلاع از کرش‌های اپلیکیشن باید از &lt;strong&gt;&lt;a href=&quot;https://fabric.io/kits/crashlytics&quot;&gt;CrashLystic&lt;/a&gt;&lt;/strong&gt; استفاده می‌کردیم.&lt;/p&gt;

&lt;p&gt;تنها برای همین ۳سرویس باید ۳ الی ۵ لایبرری مختلف از لایبرریهای گوگل گرفته تا توییتر و فیسبوک نصب می‌شد. چه روزهای طاقت‌فرسایی که برای مدیریت و نَویگِیت کردن بین این سرویس‌ها طی نشد. همه اینها یک‌طرف، اینکه این سرویس‌های اختصاص برای اپلیکیشن‌های موبایلی لانچ نشده و سرویس‌های هزارپاره هستند در طرفی دیگه.&lt;/p&gt;

&lt;h2 id=&quot;شب-برمیآید&quot;&gt;شب برمی‌آید&lt;/h2&gt;

&lt;p&gt;در سال ۲۰۱۱ دو مهندس به نام‌های &lt;a href=&quot;https://angel.co/james-tamplin&quot;&gt;James Tamplin&lt;/a&gt; و &lt;a href=&quot;https://angel.co/andrew-lee&quot;&gt;Andrew Lee&lt;/a&gt; استارتاپی بنام Firebase لانچ کردند. این سرویس در ابتدا یه API چت بود که به توسعه دهنده‌ها این امکان رو میداد تا سرویس چت رو در سایتشون پیاده کنن. بعد از مدتی به اطلاعات زیاد و عجیب منتقل شده بر این بستر مشکوک شدن،‌ و پس از بررسی‌ها معلوم شد که توسعه دهنده‌ها از این سرویس برای ارسال اطلاعات در بازی یا نرم‌افزارهاشون استفاده می‌کردند، درواقع یه سرویس realtime انتقال دیتا.&lt;/p&gt;

&lt;p&gt;در سال ۲۰۱۲ Andrew و James تصمیم گرفتن سرویس چت رو از ساختار RealTime اون جدا کنند، و  اینگونه بود که فایربیس (بگونه‌ای که الان می‌شناسیمش) خلق شد!&lt;/p&gt;

&lt;p&gt;در سال ۲۰۱۴ شرکت گوگل، فایربیس رو خرید. پس از افزودن چند سرویس (مثل Analytics، Crash Report و … ) نهایتا در سال ۲۰۱۵ با خریدن &lt;a href=&quot;https://divshot.com/&quot;&gt;Divshot&lt;/a&gt;  (که یک سرویس کلاد خدمات وب، مثل Storage, CDN, SSL, API و غیره، است) و ادقام آن با سرویس‌های قبلی، اَبَر سرویس فعلی فایبریس رو تشکیل داد.&lt;/p&gt;

&lt;h2 id=&quot;فایربیس-چه-کارهایی-میکند&quot;&gt;فایربیس چه کارهایی می‌کند؟&lt;/h2&gt;

&lt;p&gt;در ادامه به سرویس‌ها و خدمات بی‌شمار، کاربردی و بعضا جالبی که فایربیس ارائه میده اشاره می‌کنم.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;h3 id=&quot;firebase-analytics&quot;&gt;Firebase Analytics&lt;/h3&gt;
    &lt;p&gt;سرویس رایگان آنالیتیک فایبرس که مشابه Google Analytics، مُنتهی اختصاصی شده برای اپلیکیشن های موبایلی. این سرویس اطلاعات جالبی مثل تعداد نصب، تعداد Uninstall، نرخ بازگشت به اپ و غیره به ما میده. همچنین میتونیم با ایجاد فانل های آماری و دسته بندی کاربران اطلاعات دقیق، مورد به مورد و هدف گذاری شده نیز داشته باشیم.  (بیشتر بدانید: &lt;a href=&quot;https://firebase.google.com/docs/analytics&quot;&gt;متن&lt;/a&gt; -‌ &lt;a href=&quot;https://youtu.be/8iZpH7O6zXo&quot;&gt;ویدئو&lt;/a&gt; )&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;h3 id=&quot;firebase-cloud-messagin&quot;&gt;Firebase Cloud Messagin&lt;/h3&gt;
    &lt;p&gt;اگه با سرویس  آشنایی دارید باید بگم، که &lt;a href=&quot;https://en.wikipedia.org/wiki/Firebase_Cloud_Messaging&quot;&gt;FCM&lt;/a&gt; هم مشابه &lt;a href=&quot;https://en.wikipedia.org/wiki/Google_Cloud_Messaging&quot;&gt;Google Cloud Messaging&lt;/a&gt; یک سرویس کراس پلتفرم و بهینه شده برای اپلیکیشن‌های موبایلی Android, iOA و همچنین WebApplicationها ست، که بطور کاملا رایگان میتونید ازش استفاده کنید. (بیشتر بدانید: &lt;a href=&quot;https://firebase.google.com/docs/cloud-messaging&quot;&gt;متن&lt;/a&gt; -‌ &lt;a href=&quot;https://youtu.be/sioEY4tWmLI?list=PLl-K7zZEsYLmOF_07IayrTntevxtbUxDL&quot;&gt;ویدئو&lt;/a&gt; )&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;h3 id=&quot;firebase-auth&quot;&gt;Firebase Auth&lt;/h3&gt;
    &lt;p&gt;سرویسی‌ست که به شما این امکان رو میده تا از Client-Side کابرتون رو احراز هویت کنید. کاربر میتونه از طریق شبکه‌های اجتماعی مثل Facebook, Github, Twitter و Google به اپ لاگین کنه، همینطور شما می‌تونید فرآیند احراز هویت رو از طریق ایمیل پسورد انجام بدید. (بیشتر بدانید: &lt;a href=&quot;https://firebase.google.com/docs/auth/&quot;&gt;متن&lt;/a&gt; -‌ &lt;a href=&quot;https://youtu.be/8sGY55yxicA?list=PLl-K7zZEsYLmOF_07IayrTntevxtbUxDL&quot;&gt;ویدئو&lt;/a&gt; )&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;h3 id=&quot;realtime-database&quot;&gt;Realtime Database&lt;/h3&gt;
    &lt;p&gt;سرویسی که به شما امکان ایجاد سرویس‌های سمت بک‌اند (بر پایه REST API) و یک پایگاه داده Realtime میده. از این سرویس می‌تونید برای ایجاد بک‌اند خودتون برای استفاده در اپلیکیشن های Android, iOS, JavaScript, Java, Swift, NodeJs و غیره استفاده کنید. از دیتابیس Realtime هم با دسترسی بر پایه RESTP API میتونید در فریم‌ورک‌های جاوااسکریپتی مثل AngulatJs, React, Ember.js و BackBone.js استفاده کنید. (بیشتر بدانید: &lt;a href=&quot;https://firebase.google.com/products/realtime-database/&quot;&gt;متن&lt;/a&gt; -‌ &lt;a href=&quot;https://youtu.be/U5aeM5dvUpA&quot;&gt;ویدئو&lt;/a&gt; )&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;h3 id=&quot;firebase-cloud-store&quot;&gt;Firebase Cloud Store&lt;/h3&gt;
    &lt;p&gt;فایربیس به شما امکان میده تا بتونید از یک فضای کلاد جهت ذخیره فایل‌هاتون مثل Audio, Image,Video و دیگر انواع فایل استفاده کنید. برای مثال اگه یه اپلیکیشن چت داشته باشید می‌تونید اطلاعاتش رو اونجا هاست کنید و کاربر بصورت کلاد به همه دیتاش در همه پلتفرم‌های ممکن سرویستون دسترسی داره. (بیشتر بدانید: &lt;a href=&quot;https://firebase.google.com/products/firestore/&quot;&gt;متن&lt;/a&gt; -‌ &lt;a href=&quot;https://youtu.be/QcsAb2RR52c&quot;&gt;ویدئو&lt;/a&gt; )&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;h3 id=&quot;firebase-hosting&quot;&gt;Firebase Hosting&lt;/h3&gt;
    &lt;p&gt;این سرویس هم به عنوان یک هاست برای شما عمل می‌کنه. روی این هاست میتونید از CSS, HTML و هرچیز Javascriptی استفاده کنید، در فرانت اند هرچیزی که میشناسین و در بک‌اند تنها Node.js. این سرویس از CDN و SSL پشتیبانی می‌کنه.(بیشتر بدانید: &lt;a href=&quot;https://firebase.google.com/products/hosting&quot;&gt;متن&lt;/a&gt; -‌ &lt;a href=&quot;https://youtu.be/jsRVHeQd5kU&quot;&gt;ویدئو&lt;/a&gt; )&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;h3 id=&quot;firebase-test-lab-برای-android&quot;&gt;Firebase Test Lab برای Android&lt;/h3&gt;
    &lt;p&gt;این FT‌B یکی از جالبترین بخشهای فایربیسه. با این سرویس می‌تونید اپلیکیشنتون رو در انواع مختلفی از گوش‌های اندروید با برند‌های مختلف تست کنید و نتیجه رو بصورت Log، تصویر یا ویدئو دریافت کنید. فایربیس کلیه مراحل تست رو حتی اگر UnitTest برای اپتون ننوشته باشید انجام میده. با این سرویس شما این امکان رو دارید که علاوه بر UnitTestها، تست‌های CI رو هم مورد آزمایش قرار داده و تست‌ها رو پاس کنید. و در نهایت نتیجه و آنالیز تست‌هارو در اختیار داشته باشید. (بیشتر بدانید: &lt;a href=&quot;https://firebase.google.com/products/test-lab/&quot;&gt;متن&lt;/a&gt; -‌ &lt;a href=&quot;https://youtu.be/4_ZEEX1x17k&quot;&gt;ویدئو&lt;/a&gt; )&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;h3 id=&quot;firebase-crash-reporting&quot;&gt;Firebase Crash Reporting&lt;/h3&gt;
    &lt;p&gt;اگه می‌خواید بدونید اپتون چه مواقعی کرش میکنه یا کاربرانتون معمولا با چه مشکلاتی و به چه دلیل مواجه میشن، این سرویس بهترین کمک رو بهتون میکنه.(بیشتر بدانید: &lt;a href=&quot;https://firebase.google.com/products/crash/&quot;&gt;متن&lt;/a&gt; -‌ &lt;a href=&quot;https://youtu.be/B7mlLVAkcfU&quot;&gt;ویدئو&lt;/a&gt; )&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;h3 id=&quot;firebase-perforamnce-monitoring&quot;&gt;Firebase Perforamnce Monitoring&lt;/h3&gt;
    &lt;p&gt;سرویس FPM به شما کمک میکنه تا از پرفرمنس و عملکرد اپلیکیشن Android یا iOSتون در دستگاه‌های کاربرانتون اطلاعات دقیقی کسب کنید. با استفاده از SDK این سرویس اطلاعات مورد نیازتون جهت سنجش عملکرد اپ از تلفن همراه تک تک کاربرانتون جمع‌اوری میشه و پس آنالیز دیتا‌ها در کنسول فایربیس قابل رویت هست. این سرویس به شما کمک میکنه تا بدونید چه کار‌های باید انجام بدید تا عملکرد یا Perfromance اپ‌تون رو بهبود ببخشید یا اینکه مشکلات حاصله رو رفع کنید. (بیشتر بدانید: &lt;a href=&quot;https://firebase.google.com/docs/perf-mon/&quot;&gt;متن&lt;/a&gt; - &lt;a href=&quot;https://youtu.be/0EHSPFvH7vk?list=PLl-K7zZEsYLmOF_07IayrTntevxtbUxDL&quot;&gt;ویدئو&lt;/a&gt; )&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;h3 id=&quot;firebase-cloud-function&quot;&gt;Firebase Cloud Function&lt;/h3&gt;
    &lt;p&gt;یکی از امکانات کاربردی فایبریس همین سرویس FCF هست. با این سرویس شما می‌تونید سمت بک اند مورد‌نیازتون رو هم طراحی کنید و درنهایت یکسری API بر بستر پروتوکل HTTPS در دسترس داشته باشید. با استفاده از این سرویس شما دیگه نگران Scale کردن و نگهداری سرویس‌هاتون ندارید، تا موقعی که شما هستین، سرویس‌هاتون بر بستر امن و کلاد در اختیار کاربرانتون قرار داره. (بیشتر بدانید: &lt;a href=&quot;https://firebase.google.com/docs/functions/&quot;&gt;متن&lt;/a&gt; - &lt;a href=&quot;https://youtu.be/vr0Gfvp5v1A&quot;&gt;ویدئو&lt;/a&gt; )&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;سرویسهای-درحال-پیشرفت&quot;&gt;سرویس‌های درحال پیشرفت&lt;/h2&gt;
&lt;ol&gt;
  &lt;li&gt;
    &lt;h3 id=&quot;firebase-notifications&quot;&gt;Firebase Notifications&lt;/h3&gt;
    &lt;p&gt;شما می‌تونید بدون استفاده از API و تنها از داخل پنل فایربیس‌تون برای کاربران اپ نوتیفیکیشن بفرستید. این امکان رو دارید که کاربران رو فیلتر کنید و بر اساس User Propertyهایی که در پنل آنالیتیک فایبربیس‌تون ایجاد کردید (مثلا جنسیت فلان) پیام‌هارو ارسال کنید.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;h3 id=&quot;firebase-app-indexing&quot;&gt;Firebase App Indexing&lt;/h3&gt;
    &lt;p&gt;از این سرویس برای بهبود رتبه اپ در جست‌جوی گوگل استفاده کنید، این سرویس همچنین بهتون کمک میکنه تا در query search گوگل پلی، پیشنهاد شده و راحت‌تر پیدا بشید. (بیشتر بدانید: &lt;a href=&quot;https://firebase.google.com/products/app-indexing/&quot;&gt;متن&lt;/a&gt; -‌ &lt;a href=&quot;https://youtu.be/C35OSHlTNwA&quot;&gt;ویدئو&lt;/a&gt; )&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;h3 id=&quot;firebase-dynamic-links&quot;&gt;Firebase Dynamic Links&lt;/h3&gt;
    &lt;p&gt;داینامیک لینک‌ها این امکان رو به شما میدن تا بتونید لینک‌های هوشمند بسازید که در مواقع مختلف رفتار متفاوتی از خودشون نشون بدن. برای مثال شما در وبسایتتون یک محصول برای فروش گذاشتید، کاربر بعد از کلیک روی اون لینک (اگر سایت رو در موبایلش باز کرده باشه و بر اساس پلتفرم سیستم عاملش) به سمت اون صفحه از اپلیکیشن هدایت میشه که محصول بهش نشون داده یا همونجا فاکتور برای پرداخت براش صادر میشه تا خریدش رو سریعتر انجام بده. (بیشتر بدانید: &lt;a href=&quot;https://firebase.google.com/docs/dynamic-links/&quot;&gt;متن&lt;/a&gt; - &lt;a href=&quot;https://www.youtube.com/watch?v=LvY1JMcrPF8&quot;&gt;ویدئو&lt;/a&gt; )&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;h3 id=&quot;firebase-invites&quot;&gt;Firebase Invites&lt;/h3&gt;
    &lt;p&gt;این سرویس به شما کمک میکنه تا امکانی رو فراهم کنید برای اینکه کاربرانتون با ایمیل، SMS یا پیام در شبکه‌های اجتماعی دیگر دوستناشون رو برای نصب اپلیکیشن دعوت کنن، و البته این امکان رو هم در اختیار دارید تا میزان بازگشت و استفاده کاربران از دعوت‌های انجام شده رو با آمار دقیق در اختیار داشته باشید. (بیشتر بدانید: &lt;a href=&quot;https://firebase.google.com/docs/invites/&quot;&gt;متن&lt;/a&gt; -‌ &lt;a href=&quot;https://youtu.be/LkaIJCZ_HyM?list=PLl-K7zZEsYLmOF_07IayrTntevxtbUxDL&quot;&gt;ویدئو&lt;/a&gt; )&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;h3 id=&quot;firebase-remote-config&quot;&gt;Firebase Remote Config&lt;/h3&gt;
    &lt;p&gt;سرویس FRC یکی از امکانات دیگه‌ی فایربیسه، که به شما این توانایی رو میده تا بصورت کلاد امکان تغییر تنظیمات اپلیکیشنتون رو داشته باشید، بدون اینکه نیاز باشه تا اپ رو آپدیت کنید. برای مثال تمامی استرینگ و متن‌هایی که در اپتون استفاده کردید بصورت یک فایل XML درمیارید، پسفردا اگه به مشکلی برخوردید و خواستید متن رو عوض کنید، یا مثلا رنگ دکمه رو عوض کنید یا هر تغییر دیگه‌ای، فقط کافیه در ریموت کانفیگ اطلاعات رو ویرایش کرده و ارسال کنید تا همه اپ‌ها رو عوض کنید. (بیشتر بدانید: &lt;a href=&quot;https://firebase.google.com/products/remote-config/&quot;&gt;متن&lt;/a&gt; -‌ &lt;a href=&quot;https://youtu.be/_CXXVFPO6f0&quot;&gt;ویدئو&lt;/a&gt; )&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;h3 id=&quot;adwords&quot;&gt;Adwords&lt;/h3&gt;
    &lt;p&gt;جالب اینجاست که گوگل سرویس Adwordsش رو هم به فایربیس انتقال داده و شما می‌تونید با استفاده از این سرویس مثل سابق کاربران مورد نظرتون رو هدف قرار داده و نتیجه رو در &lt;strong&gt;Firebase Analytics&lt;/strong&gt; مشاهده کنید.  (بیشتر بدانید: &lt;a href=&quot;https://firebase.google.com/docs/adwords/&quot;&gt;متن&lt;/a&gt; -‌ &lt;a href=&quot;https://youtu.be/YTgJjKU9GdQ&quot;&gt;ویدئو&lt;/a&gt; )&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;کسب-درآمد&quot;&gt;کسب درآمد&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;
    &lt;h3 id=&quot;admob&quot;&gt;Admob&lt;/h3&gt;
    &lt;p&gt;از سرویس admob جهت پخش تبلیغات و کسب درآمد در اپ‌تون می‌تونید استفاده کنید. (بیشتر بدانید: &lt;a href=&quot;https://firebase.google.com/docs/admob/&quot;&gt;متن&lt;/a&gt; -‌ &lt;a href=&quot;https://youtu.be/EPKmYheOmiw?list=PLl-K7zZEsYLmOF_07IayrTntevxtbUxDL&quot;&gt;ویدئو&lt;/a&gt; )&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;پروژه-های-متنباز&quot;&gt;پروژه های متن‌باز&lt;/h2&gt;
&lt;ol&gt;
  &lt;li&gt;
    &lt;h3 id=&quot;firepad&quot;&gt;Firepad&lt;/h3&gt;
    &lt;p&gt;این یک سرویس ویرایش متن در لحظه و قابل اشتراکه. فایرپد از ادیتور‌های مختلف مثل Altassian Stash Realtime و Koding در خودش استفاده می‌کنه. (&lt;a href=&quot;https://firepad.io/&quot;&gt;وبسایت&lt;/a&gt;)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;h3 id=&quot;firechat&quot;&gt;Firechat&lt;/h3&gt;
    &lt;p&gt;فایرچت هم یه اپلیکیشن چت Realtime و اوپن سورس هست. (&lt;a href=&quot;https://www.opengarden.com/firechat.html&quot;&gt;وبسایت&lt;/a&gt;)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;h3 id=&quot;geofire&quot;&gt;GeoFire&lt;/h3&gt;
    &lt;p&gt;جئوفایر هم بهمون کمک میکنه تا با استفاده از Firebase Databse بتونیم اطلاعات لوکیشن و جئومتریک کاربران اپلیکیشن رو در پایگاه داده آنلاین‌مون ذخیره کرده و نگهداری کنیم. (و احتمالا بعدا ازش استفاده کنیم 😈) (&lt;a href=&quot;https://github.com/firebase/geofire&quot;&gt;وبسایت&lt;/a&gt;)&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;نتیجه-گیری&quot;&gt;نتیجه گیری&lt;/h2&gt;

&lt;p&gt;پس بجای استفاده از چندین سرویس، از یک سرویس کامل استفاده کنید. البته امیدوارم این امر برای شرکت گوگل انحصار ایجاد نکنه و استارتاپ‌های مختلف بتونن با ارائه سرویس‌های خلاقانه و کاربردی مارو در مسیر بهبود خدمت و سرویس به کاربران یاری کنن.&lt;/p&gt;

&lt;p&gt;لازمه که این مورد رو یادآور بشم که فقط سرویس FCM کاملا رایگان هست، و باقی سرویس‌های فایبریس یا از پایه پولی‌هستن یا محدودیت دارن در حالت رایگان، پس قبل از برنامه ریزی برای توسعه،‌ به بخش بیزنسیش هم فکر کنید.&lt;/p&gt;

&lt;p&gt;اول که شروع کردم قرار بود راجع به پیاده‌سازی فایبربیس در اپلیکیشمون فایبرنت صحبت کنم. اما خب دلم نیومد راجع به سرویس‌های فایبربیس ننویسم (چون جایی هم در منابع فارسی ندیدم که کامل راجع بهش نوشته باشه). انشالله در پست یا پست‌های بعدی حسابی راجع به پیاده کردن چند سرویسی که استفاده کردم خواهم نوشت.&lt;/p&gt;

&lt;p&gt;پس تا پست بعدی، اگه سوال مورد یا چیزی بود لطفا در &lt;a href=&quot;https://twitter.com/sadra_amlashi&quot;&gt;توئیتر&lt;/a&gt; یا &lt;a href=&quot;https://t.me/amlashi&quot;&gt;تلگرام&lt;/a&gt; با هم در ارتباط باشیم.&lt;/p&gt;</content><author><name>صدرا املشی</name></author><category term="Google" /><category term="Firebase" /><category term="Android" /><category term="iOS" /><category term="WebApplication" /><summary type="html">مصائب مسیح!</summary></entry><entry><title type="html">بهبود رابط کاربری با BottomNavigationView</title><link href="//isapanah.com/2017/bottom-navigation-view-challenges" rel="alternate" type="text/html" title="بهبود رابط کاربری با BottomNavigationView" /><published>2017-10-11T00:00:00+03:30</published><updated>2017-10-11T00:00:00+03:30</updated><id>//isapanah.com/2017/bottom-navigation-view-challenges</id><content type="html" xml:base="//isapanah.com/2017/bottom-navigation-view-challenges">&lt;p&gt;اگر پست “&lt;a href=&quot;http://dcamp.ir/hamburger-menu-vs-bottom-navigation&quot;&gt;جایگزینی برای منوی همبرگر&lt;/a&gt;” شایان رو خونده باشید حتما متوجه شدید که ما در پروژمون بجای همبرگر منو از &lt;a href=&quot;https://developer.android.com/reference/android/support/design/widget/BottomNavigationView.html&quot;&gt;BottomNavigationView&lt;/a&gt; استفاده کردیم.&lt;/p&gt;

&lt;p&gt;در این پست قراره به چالش هایی که در روند پیاده سازی این مقوله برخوردیم اشاره کنم و اینکه به چه روشی اونهارو حل کردیم.&lt;/p&gt;

&lt;p&gt;خوشحال میشم اگه شما روش بهتری برای رفع این چالشها داشتین با ما به اشتراک بگذارین.&lt;/p&gt;

&lt;p&gt;اگه دنبال این هستین که چطوری میتونید BottomNavigationView رو در پروژه‌تون پیاده کنید تنها کافیه تو گوگل سرچ کنید کلی آموزش فارسی و انگلیسی پیدا میشه. با اینحال بنظرم کامل‌ترین آموزش برای این قضیه &lt;a href=&quot;https://medium.com/@hitherejoe/exploring-the-android-design-support-library-bottom-navigation-drawer-548de699e8e0&quot;&gt;پست Joe Brich&lt;/a&gt; هست، البته اگه دنبال یه آموزش ویدئویی هستین بنظرم &lt;a href=&quot;https://www.youtube.com/watch?v=wcE7IIHKfRg&quot;&gt;این ویدئو در یوتیوب&lt;/a&gt; هم گزینه خوبیه.&lt;/p&gt;

&lt;h2 id=&quot;چالش-اول-حالت-shiftmode-منوی-انتخابی&quot;&gt;چالش اول: حالت ShiftMode منوی انتخابی&lt;/h2&gt;

&lt;p&gt;اولین چالشی که باهاش مواجه شدیم این بود که موقع کلیک روی یک منو در &lt;strong&gt;BottomNavigationView&lt;/strong&gt; اون منو به اصطلاح مَگنیفاید یا بزرگ شده و متن زیرش پنهان میشد، که به این حالت &lt;code class=&quot;highlighter-rouge&quot;&gt;ShiftMode&lt;/code&gt; میگن . مثل انیمیشن پایین:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-10-11/bottom-navigation-menu-0.gif&quot; alt=&quot;Bottom Navigation View&quot; /&gt;&lt;/p&gt;

&lt;p&gt;در نظر داشتیم تا همه آیکون و متن منو در زیر نشون داده بشه. تمایلی هم به بزرگ شدن آیکون ها نداشتیم، فقط کافی بود که رنگ آیتم انتخاب شده تغییر کنه و فقط آیکون کمی بالا بیاد که نشون بده انتخاب شده.&lt;/p&gt;

&lt;p&gt;خب برای اینکار اول از همه یه کلاس &lt;code class=&quot;highlighter-rouge&quot;&gt;BottomNavigationViewHelper&lt;/code&gt; درست کردم. در این کلاس با کمک متد &lt;strong&gt;disableShiftMode&lt;/strong&gt; قابلیت ShiftingMode رو از تک تک منو ها گرفته، سپس حذف و جایگزین می‌کنیم.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;BottomNavigationViewHelper&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;disableShiftMode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BottomNavigationView&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;BottomNavigationMenuView&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;menuView&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BottomNavigationMenuView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getChildAt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;Field&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shiftingMode&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;menuView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getDeclaredField&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;mShiftingMode&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;shiftingMode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setAccessible&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;shiftingMode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setBoolean&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;menuView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;shiftingMode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setAccessible&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;menuView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getChildCount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;BottomNavigationItemView&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BottomNavigationItemView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;menuView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getChildAt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;c1&quot;&gt;//noinspection RestrictedApi&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setShiftingMode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;c1&quot;&gt;// set once again checked value, so view will be updated&lt;/span&gt;
                &lt;span class=&quot;c1&quot;&gt;//noinspection RestrictedApi&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setChecked&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getItemData&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;isChecked&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NoSuchFieldException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;Log&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;BNVHelper&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Unable to get shift mode field&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IllegalAccessException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;Log&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;BNVHelper&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Unable to change value of shift mode&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;کلاس BottomNavigationViewHelper رو به پروژه‌تون اضافه کنید. حالا کافیه بعد از کست کردن BottomNavigationView مون، اون رو به کلاس هلپر معرفی کرده تا قابلیت ShiftMode شدن رو ازش صلب کنه.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;BottomNavigationView&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bottomNavigationView&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BottomNavigationView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;findViewById&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;bottomNavigationView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;BottomNavigationViewHelper&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;disableShiftMode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bottomNavigationView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h2 id=&quot;چالش-دوم-تغییر-رنگ-آیکون-انتخاب-شده&quot;&gt;چالش دوم: تغییر رنگ آیکون انتخاب شده&lt;/h2&gt;

&lt;p&gt;ما میخواستیم موقع انتخاب شدن آیتم، آیکون‌ش به شکل یا رنگ خاصی تبدیل بشه. اما این امکان درحال عادی وجود نداشت. پس چیکار کردیم؟&lt;/p&gt;

&lt;p&gt;من یکبار قبل شروع همه چیز برای همه آیتم ها یک آیکون پیشرفض تعریف کرده،‌ سپس یک متد به نام &lt;code class=&quot;highlighter-rouge&quot;&gt;changeIcon&lt;/code&gt; ایجاد کردم، تا هربار که کاربر آیتمی رو انتخاب میکنه این متد صدا زده بشه. این متد ابتدا آیکونِ همه‌ی آیتم‌هارو روی پیشفرض قرار میده و سپس بر اساس &lt;code class=&quot;highlighter-rouge&quot;&gt;ID&lt;/code&gt; آیتم انتخاب شده، آیکون پیشفرض‌ش رو با آیکون اَکتیو شده، تعویض میکنه.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;changeIcon&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;itemIndex&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;bottomNavigationView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getMenu&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getItem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setIcon&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;mipmap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;bnv_menu_ic_home&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;bottomNavigationView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getMenu&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getItem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setIcon&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;mipmap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;bnv_menu_ic_news&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;bottomNavigationView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getMenu&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getItem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setIcon&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;mipmap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;bnv_menu_ic_support&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;bottomNavigationView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getMenu&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getItem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setIcon&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;mipmap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;bnv_menu_ic_profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;switch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;itemIndex&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;bottomNavigationView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getMenu&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getItem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setIcon&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;mipmap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;bnv_menu_ic_home_active&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;bottomNavigationView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getMenu&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getItem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setIcon&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;mipmap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;bnv_menu_ic_news_active&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;bottomNavigationView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getMenu&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getItem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setIcon&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;mipmap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;bnv_menu_ic_support_active&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;bottomNavigationView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getMenu&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getItem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setIcon&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;mipmap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;bnv_menu_ic_profile_active&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;بعدش، یک &lt;strong&gt;listener&lt;/strong&gt; برای bottomNavigationView مون تعریف کردم که هرموقع آیتمی انتخاب شد، این متد رو صدا بزنه تا آیکونش به آیکون مورد نظر ما تغییر کنه.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;bottomNavigationView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setOnNavigationItemSelectedListener&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BottomNavigationView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;OnNavigationItemSelectedListener&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;onNavigationItemSelected&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nd&quot;&gt;@NonNull&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MenuItem&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;switch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getItemId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;action_mainFragments_home&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;changeIcon&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;action_mainFragments_news&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;changeIcon&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;action_mainFragments_support&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;changeIcon&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;action_mainFragments_profile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;changeIcon&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;و در نهایت با توجه به برداشتن حالت مگنیفای و تغییر آیکون چیزی که انتظار داشتیم این شکلی شد:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-10-11/bottom-navigation-menu-1.gif&quot; alt=&quot;Bottom Navigation View&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;چالش-سوم-قرار-دادن-badge-در-هنگام-دریافت-ناتیفیکیشن&quot;&gt;چالش سوم: قرار دادن Badge در هنگام دریافت ناتیفیکیشن&lt;/h2&gt;

&lt;p&gt;یکی از پر دردسرترین چیزهایی که باهاش روبرو شدیم، بَج گذاشتن کنار یکی از آیتم‌های BNV بود. در اولین تلاش یه shape قرمز رنگ از نوع oval ساختم، بعدش به این فکر کردم که میخوام برای آیتم دومی یه بج نشون بدم، پس عرض صفحه رو گرفته، تقسیم بر ۴ کرده و سپس صربدر ۲.۵ میکردم تا بیافته در مرکز آيتممون! در نهایت هم ویوو مربوطه رو به BNV اضافه میکردم. همه چی درست کار می‌کرد تا موقعی که قرار نبود در سایزهای غیر موبایلی (مثل تبلت) نشون داده بشه، اونموقع دیگه مثل سابق جاش اونجایی نبود که باید باشه و روی هر اسکرین چندین پیکسل جابجا می‌شد.&lt;/p&gt;

&lt;p&gt;در اقدام بعدی برای حل این مشکل یه کلاس &lt;code class=&quot;highlighter-rouge&quot;&gt;BadgeView&lt;/code&gt; درست کردم که از نوع AppCompatTextView هست، و تمام حالات ممکن رو براش پیاده کردم تا روی اسکرین های مختلف مشکلی نداشته باشیم، حتی مشکل حالت count یا empty بج رو هم براش در نظر گرفتم. لازم نیست خودتون رو درگیر این اینکه این کلاس چطوری کار میکنه بکنید، فقط کافیه کلاس رو &lt;a href=&quot;https://gist.github.com/sadra/d13b354d6205360fc03c80aa2d3fd32b&quot;&gt;از اینجا&lt;/a&gt; دریافت کرده و به پروژتون اضافه کنید.&lt;/p&gt;

&lt;p&gt;حالا برای اضافه کردن Badge اول از همه آیتم منوی مورد نظرتون رو باید انتخاب کنید.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;BottomNavigationMenuView&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;menuView&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BottomNavigationMenuView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bottomNavigationView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getChildAt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;View&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;targetView&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;menuView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getChildAt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//I' select second menu item&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;سپس، از BadgeView یه نمونه ایجاد کرده و آیتم منوی مورد نظر رو براش تعریف می‌کنیم.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;badgeView&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BadgeView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;badgeView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setTargetView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;targetView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;اگه میخوایین Badge تون شماره داشته باشه (مثلا تعداد پیام‌های دریافتی)، متد &lt;code class=&quot;highlighter-rouge&quot;&gt;setBadgeCount&lt;/code&gt; رو صدا کرده و داخلش مقدار مورد نظرتون رو وارد کنید. اگر نه مثل اینستاگرام یه نقطه کوچیک خالی کنار آیتم مورد نظر خواستین فقط کافیه متد &lt;code class=&quot;highlighter-rouge&quot;&gt;setEmptyBadge&lt;/code&gt; و یا حتی برای سایز کوچیکتر &lt;code class=&quot;highlighter-rouge&quot;&gt;setEmptySmallerBadge&lt;/code&gt; رو صدا کنید.&lt;/p&gt;

&lt;p&gt;بطور پیشفرض بَج در بالا سمت راست قرار میگیره. برای اینکه بَج مورد نظر در همه سایز ها و اسکرین ها یکسان و در یک جا قرار داشته باشه (سمت راست آیتم با فاصله ۵ پیکسل از سمت چپ) اول از همه باید اون رو در مرکز آیتم قرار بدیم، بعدش با استفاده از متد &lt;code class=&quot;highlighter-rouge&quot;&gt;setBadgeMargin&lt;/code&gt; مقدار لازمه رو برای فاصله گرفتن از مرکز به سمت بالا سمت راست، یا هرجایی که شما دوست داشتین وارد می‌کنیم.&lt;/p&gt;

&lt;p&gt;خب درنهایت، چیزی نوشتیم برای یه &lt;em&gt;بج empty&lt;/em&gt; اینه:&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;insertBadge&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(){&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;BottomNavigationMenuView&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;menuView&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BottomNavigationMenuView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bottomNavigationView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getChildAt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;View&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;targetView&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;menuView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getChildAt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;badgeView&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BadgeView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;badgeView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setTargetView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;targetView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;badgeView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setEmptyBadge&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;badgeView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setBadgeGravity&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Gravity&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;CENTER&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;badgeView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setBadgeMargin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;اگر از Badge با شمارنده استفاده کردین، برای افزایش مقدار داخل بَج هم میتونید بصورت دستی مقدار جدید بهش بدید، و هم میتونید با صدا زدن متد &lt;code class=&quot;highlighter-rouge&quot;&gt;incrementBadgeCount&lt;/code&gt; یا &lt;code class=&quot;highlighter-rouge&quot;&gt;decrementBadgeCount&lt;/code&gt; اون رو کم یا زیاد کنید.&lt;/p&gt;

&lt;p&gt;برای حذف کردن بج از روی منوی آیتم فقط کافیه متد &lt;code class=&quot;highlighter-rouge&quot;&gt;removeBadge&lt;/code&gt; رو صدا بزنید.&lt;/p&gt;

&lt;p&gt;در نهایت چیزی که انتظارشو داشتیم، به همین سادگی به همین خوشمزگی :)&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-10-11/bottom-navigation-menu-2.png&quot; alt=&quot;Bottom Navigation View&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-10-11/bottom-navigation-menu-3.png&quot; alt=&quot;Bottom Navigation View&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-10-11/bottom-navigation-menu-4.png&quot; alt=&quot;Bottom Navigation View&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;نتیجه-گیری&quot;&gt;نتیجه گیری&lt;/h2&gt;

&lt;p&gt;نتیجه اینکه کس نخوارد پشت من جز ناخن انگشت من! به هرحال این بندگان خدا در شرکت google خودشون رو به هر دری میزنن تا راه توسعه رو برای ما هموارتر کنن ولی خوب نمیشه در هرچیزی کمال مطلق آفرید، ابزارها آفریده میشن،‌و تکمیل کردنشون وظیفه ما توسعه دهنده‌هاست، مثل همین چالش‌هایی که در این مقوله پیش اومد.&lt;/p&gt;

&lt;p&gt;اگر شما تو استفاده از این BottomNavigationView به چالشی برخوردید و حلش کردید یا برای همین موارد پیش اومده پیشنهاد بهتری داشتین ممنون میشم اگه روی &lt;a href=&quot;https://twitter.com/sadra_amlashi&quot;&gt;توییتر&lt;/a&gt; یا &lt;a href=&quot;https://t.me/Amlashi&quot;&gt;تلگرام&lt;/a&gt; با من درمیون بگذارید.&lt;/p&gt;</content><author><name>صدرا املشی</name></author><category term="Android" /><category term="UI" /><category term="BottomNavigationView" /><summary type="html">اگر پست “جایگزینی برای منوی همبرگر” شایان رو خونده باشید حتما متوجه شدید که ما در پروژمون بجای همبرگر منو از BottomNavigationView استفاده کردیم.</summary></entry><entry><title type="html">انیمیشن در اندروید با Lottie</title><link href="//isapanah.com/2017/oh-my-android-lottie" rel="alternate" type="text/html" title="انیمیشن در اندروید با Lottie" /><published>2017-08-07T00:00:00+04:30</published><updated>2017-08-07T00:00:00+04:30</updated><id>//isapanah.com/2017/oh-my-android-lottie</id><content type="html" xml:base="//isapanah.com/2017/oh-my-android-lottie">&lt;p&gt;همونطور که قبلا بهتون در پست  “ &lt;a href=&quot;http://isapanah.com/2017/oh-my-lottie&quot;&gt;استفاده از انیمیشن در توسعه اپلیکیشن&lt;/a&gt; “ قول داده بودم، در این پست قراره به آموزش استفاده از &lt;a href=&quot;https://github.com/airbnb/lottie-android&quot;&gt;لایبرری Lottie&lt;/a&gt; و اضافه کردن منابع بصری انیمه به پروژه اندروید بپردازیم.&lt;/p&gt;

&lt;p&gt;فهرست:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;&lt;a href=&quot;#bodymovin&quot;&gt;پلاگین BodyMovin&lt;/a&gt;&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;#bodymovin-install&quot;&gt;نصب پلاگین&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#bodymovin-usage&quot;&gt;گرفتن خروجی JSON از پروژه انیمیشن&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;&lt;a href=&quot;#lottie&quot;&gt;لایبرری Lottie برای اندروید&lt;/a&gt;&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;#lottie-install&quot;&gt;نصب و آماده‌سازی اولیه&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#lottie-basic&quot;&gt;مبانی اولیه و استفاده از یک انیمیشن ساده&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#lottie-progress&quot;&gt;انیمیشن با قابلیت کنترل progress&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#lottie-animated-button&quot;&gt;پیاده‌سازی دکمه‌های انیمیشنی&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#lottie-animated-font&quot;&gt;پیاده سازی فونت انیمیشنی&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#lottie-intro&quot;&gt;طراحی صفحه خوش‌آمد گویی با انیمیشن&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;&lt;a href=&quot;#lottie-tips&quot;&gt;نکات مهم&lt;/a&gt;&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;&lt;a href=&quot;#lottie-final&quot;&gt;صحبت پایانی&lt;/a&gt;&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;bodymovin&quot;&gt;پلاگین BodyMovin&lt;/h2&gt;

&lt;h3 id=&quot;bodymovin-install&quot;&gt;1.  نصب پلاگین&lt;/h3&gt;

&lt;p&gt;در اولین گام، فرض میکنیم که شما انیمیشن مورد نظر خودتون رو در AfterEffect طراحی کردین و حالا وقتشه که ازش خروجی بگیرید. خب برای اینکار لازمه که اول پلاگین &lt;a href=&quot;https://github.com/bodymovin/bodymovin&quot;&gt;BodyMovin&lt;/a&gt; روی افترافکت نصب کرده باشید.&lt;/p&gt;

&lt;p&gt;میتونید پلاگین رو از &lt;a href=&quot;http://aescripts.com/bodymovin/&quot;&gt;aescripts&lt;/a&gt; یا &lt;a href=&quot;https://creative.adobe.com/addons/products/12557&quot;&gt;adobe store&lt;/a&gt; دریافت کنید؛ اما چون دانلود کردن از اینجا خیلی دردسر داشت، من گذاشتمش در ریپوی پروژه و میتونید از گیتهاب مستقیما دانلودش کنید. ( &lt;a href=&quot;https://github.com/sadra/LottieExampleProject/blob/master/repo/plugin/bodymovin_v4.10.2.zip&quot;&gt;دانلود پلاگین BodyMovin&lt;/a&gt; )&lt;/p&gt;

&lt;p&gt;فایل دانلودی رو آنزیپ کنید، درون پوشه یک فایل &lt;strong&gt;bodymovin.zxp&lt;/strong&gt; وجود داره. باید اون رو به عنوان اکستنشن به پروژه اضافه کنید، که اونم خیلی دردسر داره! برای راحتتر پیش رفتن این موضوع از ابزاری به نام &lt;strong&gt;zxp&lt;/strong&gt; استفاده میکنیم. نرم‌افزار zxp-installer رو از &lt;a href=&quot;http://aescripts.com/learn/zxp-installer/&quot;&gt;aescripts&lt;/a&gt; دانلود و نصب کنید. بعد از اجرا کردنش کافیه فایل bodymovin.zxp رو به zxp درگ اند دراپ کنید.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-08-10/zxp-0.png&quot; alt=&quot;ZXP Installer&quot; /&gt;&lt;/p&gt;

&lt;p&gt;حالا اکستنشن نصب شده و فقط لازمه AfterEffect رو ری استارت کنید.&lt;/p&gt;

&lt;p&gt;قبل از استفاده از BodyMovin لطفا به &lt;code class=&quot;highlighter-rouge&quot;&gt;Edit &amp;gt; Preferences &amp;gt; General&lt;/code&gt; رفته، و تیک &lt;strong&gt;Allow Scripts to Write Files and Access Network&lt;/strong&gt; رو فعال کنید.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-08-10/zxp-1.png&quot; alt=&quot;ZXP Installer&quot; /&gt;&lt;/p&gt;

&lt;p&gt;تمامی این روند در هردو سیستم عامل Windows و MacOS به همین ترتیبی که گفتم انجام میشه.&lt;/p&gt;

&lt;h3 id=&quot;bodymovin-usage&quot;&gt;2.  گرفتن خروجی JSON از پروژه انیمیشن&lt;/h3&gt;

&lt;p&gt;خب حالا وقته خروجی گرفتنه.اول از همه پروژه AfterEffect تون رو باز کنید و بعد کافیه به مسیر &lt;code class=&quot;highlighter-rouge&quot;&gt;Edit &amp;gt; Extionstions &amp;gt; BodyMovin&lt;/code&gt; رفته تا بادی‌مووین آماده خروجی گرفتن بشه.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-08-10/bodymovin-0.png&quot; alt=&quot;ZXP Installer&quot; /&gt;&lt;/p&gt;

&lt;p&gt;خب حالا باید مسیر خروجی رو مشخص کنید.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-08-10/bodymovin-1.png&quot; alt=&quot;ZXP Installer&quot; /&gt;&lt;/p&gt;

&lt;p&gt;انمیشین‌ی که میخوایید ازش خروجی بگیرید رو انتخاب کنید‌.&lt;/p&gt;

&lt;p&gt;توجه کنید که میتونید در همینجا Preview انیمیشن رو هم مشاهده کنید، یا میتونید اینکارو با نصب پلیر مخصوص بادی‌مووین انجام بدید، فقط کافیه روی Get the Player کلیک کرده و نصبش کنید.&lt;/p&gt;

&lt;p&gt;و در آخر روی Render کلیک کنید.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-08-10/bodymovin-2.png&quot; alt=&quot;ZXP Installer&quot; /&gt;&lt;/p&gt;

&lt;p&gt;حالا همه چی تموم شده و روی Done کلیک کنید و تمام.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-08-10/bodymovin-3.png&quot; alt=&quot;ZXP Installer&quot; /&gt;&lt;/p&gt;

&lt;p&gt;تمامی مراحل نصب و خروجی گرفتن از BodyMovin رو پشت‌سر گذاشتیم. فقط کافیه فایل json خروجی گرفته شده رو به پروژه اندروید، iOS و یا ReactNative اضافه کنیم.&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;lottie&quot;&gt;لایبرری Lottie برای اندروید&lt;/h2&gt;

&lt;h3 id=&quot;lottie-install&quot;&gt;1.  نصب و آماده‌سازی اولیه&lt;/h3&gt;

&lt;p&gt;قبل از شروع همه چیز، من برای نمونه و تمرین یه پروژه اندروید ساخته و در گیتهابم گذاشتم، میتونید به &lt;a href=&quot;https://github.com/sadra/LottieExampleProject&quot;&gt;صفحه گیتهاب این پروژه&lt;/a&gt; مراجعه کرده و به تمامی فایلها مثل پلاگینها، نمونه های انیمیشن و کدهای سمپل در همون ریپوزیتوری دسترسی داشته باشد.&lt;/p&gt;

&lt;p&gt;در اولین گام باید لایبرری &lt;strong&gt;Lottie&lt;/strong&gt; رو به پروژمون اضافه کنیم. کافیه اون رو در Dependencie های پروژه در فایل &lt;code class=&quot;highlighter-rouge&quot;&gt;build.gradle&lt;/code&gt; معرفی کنیم و بعدشم هم پروژه رو یکبار سینک میکنیم.&lt;/p&gt;

&lt;div class=&quot;language-groovy highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;dependencies&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;compile&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'com.airbnb.android:lottie:2.1.0'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;شما باید فایلهای انیمیشن رو در پوشه &lt;strong&gt;assets&lt;/strong&gt; قرار بدید. اگر قبلا پوشه رو تعریف کردین که هیچ، اما اگه اینکارو نکردین کافیه یه دایرکتوری به اسم assets در مسیر &lt;code class=&quot;highlighter-rouge&quot;&gt;app/src/main&lt;/code&gt; ایجاد کرده و بعد فایلهای json انیمیشن رو بریزید اونجا.&lt;/p&gt;

&lt;p&gt;فایلهای JSON ای که در این پروژه استفاده کردم رو میتونید مستقیما از &lt;a href=&quot;https://github.com/sadra/LottieExampleProject/tree/master/app/src/main/assets&quot;&gt;ریپوی گیتهاب&lt;/a&gt; دریافت کنید.&lt;/p&gt;

&lt;h3 id=&quot;lottie-basic&quot;&gt;2.  مبانی اولیه و استفاده از یک انیمیشن ساده&lt;/h3&gt;

&lt;p&gt;اول باید view مربوط به لاتی رو به Layout مورد نظرتون اضافه کنید.&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;com.airbnb.lottie.LottieAnimationView&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;android:id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;@+id/animation_view&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;android:layout_width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;wrap_content&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;android:layout_height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;wrap_content&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;app:lottie_fileName=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;gift.json&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;app:lottie_loop=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;true&quot;&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;app:lottie_autoPlay=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;true&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;قبل از هرچیزی بهتره با پارامتر‌های اصلی که به ویوومون دادیم آشنا بشیم. پارامتر &lt;strong&gt;lottie_fileName&lt;/strong&gt; اشاره به نام و محل فایل json انیمیشنتون داره. توجه کنید که اگه فایل json رو همینجوری در assets قرار دادید که هیچ، فقط کافیه اسم فایل رو نام ببرید؛ اما اگه اون رو در یک پوشه درون assets تجمیع کردین، یادتون نره که حتما نام پوشه رو قبل از فایل ذکر کنید مثلا: &lt;code class=&quot;highlighter-rouge&quot;&gt;myFolder/anim.json&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;پارامتر &lt;strong&gt;lottie_loop&lt;/strong&gt; اشاره به این مورد داره که این انیمیشن بصورت  با یا بدون لوپ (بی پایان) پخش بشه. اگه اشاره ای بهش نکنید بصورت پیشفرض &lt;code class=&quot;highlighter-rouge&quot;&gt;false&lt;/code&gt; هست، ولی اگه میخواهید انیمیشنتون لوپ داشته باشه، یادتون نره که به &lt;code class=&quot;highlighter-rouge&quot;&gt;true&lt;/code&gt; بودنش اشاره کنید.&lt;/p&gt;

&lt;p&gt;و مورد آخر هم &lt;strong&gt;lottie_autoPlay&lt;/strong&gt; هست، که میگه میخوایید همون موقع که ویوو ظاهر شده، شروع کنه به پخش یا نه؟ این هم بصورت پیشفرض &lt;code class=&quot;highlighter-rouge&quot;&gt;false&lt;/code&gt; هست.&lt;/p&gt;

&lt;p&gt;خب حالا اگه پروژه رو بیلد کنید، میبینید که به چه آسونی انیمیشن به پروژتون اضافه شده ^_^&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-08-10/lottie-anim-0.gif&quot; alt=&quot;Lottie Simple Animation Demo&quot; /&gt;&lt;/p&gt;

&lt;p&gt;همه این موارد رو در خود کلاستون هم میتونید انجام بدید. اول ویوو رو در کلاستون معرفی و کَست کنید.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;LottieAnimationView&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;animationView&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LottieAnimationView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;findViewById&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;animation_view&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;و بعد مورادی مثل محل و نام انیمیشن، لوپ بودنش، و پخش اتوماتیک رو به همون راحتی متیونید واسش تعریف کنید.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;animationView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setAnimation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;hello-world.json&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;animationView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;loop&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;animationView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;playAnimation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;ما در حالت کد، امکانات خیلی زیادی داریم. برای مثال اگه بخوایم سرعت انیمیشن رو کم یا زیاد کنیم کافیه متد &lt;code class=&quot;highlighter-rouge&quot;&gt;.setSpeed(floatValue)&lt;/code&gt; رو صدا بزنیم و مقدار دهی کنیم. مقدار 1.0 یعنی همون سرعت نرمال خودش. حالا هرچی از یک بالاتر یا پایینتر باشه، انیمیشن به همون نسبت سریعتر یا کندتر نمایش داده میشه.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
&lt;span class=&quot;n&quot;&gt;animationView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setSpeed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//normal speed&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;animationView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setSpeed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//2x faster&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;animationView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setSpeed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//2x slower&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;شما همچنین میتونید انیمیشن رو Pause یا متوقف کنید و سپس اقدام به ادامه پخش اون کنید.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;animationView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;pauseAnimation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//Pause the animation&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;animationView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;resumeAnimation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//and Resume it again&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;توجه کنید که اگر یکبار Pause کنید انیمیشن متوقف میشه، اما مجددا اگر pauseAnimation رو صدا کنید انیمیشن به نمایش خودش ادامه می‌دهد( Resume میشه ). این مورد درباره resumeAnimation هم صادق هست! احساس میکنم مشکلی در خود لایبرریه، و این مورد رو واسشون issue کردم تا بررسی کنن، پس حواستون بهش باشه.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;یکی دیگه از امکاناتی که در کد به ما داده میشه، اینه که بتونیم به انیمشن رنگ دلخواه خودمون رو بدیم. یه &lt;code class=&quot;highlighter-rouge&quot;&gt;PorterDuffColorFilter&lt;/code&gt; ایجاد کرده و رنگ مورد نظرتون رو بهش بدین. این موضوع رو در نظر داشته باشن که &lt;strong&gt;Mode&lt;/strong&gt; رنگ هم روی &lt;code class=&quot;highlighter-rouge&quot;&gt;PorterDuff.Mode.SRC&lt;/code&gt; باشه بهترین حالته، در مودهای دیگه رنگ تغییر میکنه.&lt;/p&gt;

&lt;p&gt;خب، حالا برای اضافه کردن رنگ ۲متد اصلی داریم. برای اینکه به کل ویوو انیمیشنمون رنگ بدیم، باید از متد &lt;code class=&quot;highlighter-rouge&quot;&gt;addColorFilter(colorFilter)&lt;/code&gt; استفاده کنیم. مواقعی پیش میاد که میخواییم به یه لایه خاص از انیمیشنمون رنگ بدیم، برای اینکار از متد &lt;code class=&quot;highlighter-rouge&quot;&gt;addColorFilterToLayer(“layerName”, colorFilter)&lt;/code&gt; استفاده می‌کنیم. لازمه که اول اسم لایه ای که میخواید رنگ بگیره رو نام برده، و سپس فیلتر رنگ خودتون رو مشخص کنید.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PorterDuffColorFilter&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;colorFilter1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PorterDuffColorFilter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;parseColor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;#CC0321&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PorterDuff&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Mode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;SRC&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;animationView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addColorFilter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;colorFilter1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PorterDuffColorFilter&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;colorFilter2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PorterDuffColorFilter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;RED&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PorterDuff&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Mode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;SRC&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;animationView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addColorFilterToLayer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;LAYER_NAME&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;colorFilter1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;برای پاک شدن رنگ هم کافیه متد clear رو صدا بزنید.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;animationView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;clearColorFilters&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;البته شما میتونید فیلتر رنگ رو در خود Layout هم تعریف کنید. البته در اونجا فقط میتونید رنگ رو برای کل ویوو در نظر بگیرید، نه برای یک لایه خاص.&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;com.airbnb.lottie.LottieAnimationView&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;app:lottie_colorFilter=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;@android:color/holo_purple&quot;&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;android:id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;@+id/animation_view&quot;&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;android:layout_width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;wrap_content&quot;&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;android:layout_height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;wrap_content&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;و آدرس تمامی کدهای و نمونه‌هایی که در این قسمت پیاده کردیم:&lt;/p&gt;

&lt;div class=&quot;div-ltr&quot;&gt;

  &lt;p&gt;&lt;strong&gt;Get it from github:&lt;/strong&gt; &lt;a href=&quot;https://github.com/sadra/LottieExampleProject/blob/master/app/src/main/java/com/isapanah/lottieeexampleproject/SimpleAnimation.java&quot;&gt;Class&lt;/a&gt; / &lt;a href=&quot;https://github.com/sadra/LottieExampleProject/blob/master/app/src/main/res/layout/simple_animation.xml&quot;&gt;Layout&lt;/a&gt; / &lt;a href=&quot;https://github.com/sadra/LottieExampleProject/blob/master/app/src/main/assets/gift.json&quot;&gt;JSON Animation&lt;/a&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;lottie-progress&quot;&gt;3.  انیمیشن با قابلیت کنترل Progress  &lt;/h3&gt;

&lt;p&gt;یکی از قابلیت های کاربردی که Lottie در اختیار شما میگذاره، اینه که شما بتونید روند یا Progress انیمیشنتون رو کنترل کنید. هر انیمیشنی شامل یک بازه &lt;strong&gt;0.0&lt;/strong&gt; تا &lt;strong&gt;1.0&lt;/strong&gt; میشه (اشاره به همون ۰ تا ۱۰۰ درصد داره)، برای اینکه بتونید مشخص کنید که انیمیشنتون از کجا شروع بشه، یا اینکه الان در کدوم فریم باشه، فقط کافیه متد &lt;code class=&quot;highlighter-rouge&quot;&gt;setProgress(floatValue)&lt;/code&gt; رو صدا زده و مقدار مورد نظر رو بهش بدید.&lt;/p&gt;

&lt;p&gt;من برای اینکه این تمرین رو انجام بدم، یه seekBar در لی‌اَوت‌م گذاشتم، و با &lt;strong&gt;onProgressChanged&lt;/strong&gt; اون رو ردیابی کرده،‌ و به ازای هر تغییر، مقدار &lt;code class=&quot;highlighter-rouge&quot;&gt;((float)progress)/100&lt;/code&gt; رو به progress انیمیشنمون مقداردهی میکنم:&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;seekBar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setOnSeekBarChangeListener&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SeekBar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;OnSeekBarChangeListener&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;onProgressChanged&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SeekBar&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seekBar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;progress&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fromUser&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;animation_view&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setProgress&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;progress&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;و خب، نتیجش میشه این:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-08-10/lottie-anim-1.gif&quot; alt=&quot;Lottie Progress Animation Demo&quot; /&gt;&lt;/p&gt;

&lt;p&gt;شما حتی میتونین برای انیمیشنتون یه رنج هم تعریف کنید. در &lt;a href=&quot;#lottie-animated-button&quot;&gt;بخش بعدی&lt;/a&gt; بصورت عینی در مورد این موضوع مثال زدم.&lt;/p&gt;

&lt;p&gt;و آدرس تمامی کدهای و نمونه‌هایی که در این قسمت پیاده کردیم:&lt;/p&gt;

&lt;div class=&quot;div-ltr&quot;&gt;

  &lt;p&gt;&lt;strong&gt;Get it from github:&lt;/strong&gt; &lt;a href=&quot;https://github.com/sadra/LottieExampleProject/blob/master/app/src/main/java/com/isapanah/lottieeexampleproject/ProgressAnimation.java&quot;&gt;Class&lt;/a&gt; / &lt;a href=&quot;https://github.com/sadra/LottieExampleProject/blob/master/app/src/main/res/layout/progress_animation.xml&quot;&gt;Layout&lt;/a&gt; / &lt;a href=&quot;https://github.com/sadra/LottieExampleProject/blob/master/app/src/main/assets/starwars.json&quot;&gt;JSON Animation&lt;/a&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;lottie-animated-button&quot;&gt;4.  پیاده‌سازی دکمه‌های انیمیشنی&lt;/h3&gt;

&lt;p&gt;یکی از مواردی که خیلی در زیبایی و تجربه کاربری لذت‌بخش تاثیر داره و در &lt;a href=&quot;https://material.io/guidelines/motion/material-motion.html&quot;&gt;منابع متریال&lt;/a&gt; هم به اون اشاره شده، استفاده کردن از دکمه‌هاییه که افکت‌های انیمیشنی دارند. برای مثال همبرگر منويي که با کلیک میچرخه و از Hamburger به Back Button تبدیل میشه.&lt;/p&gt;

&lt;p&gt;سوال اینجاست که چطوری باید همچین چیزی رو طراحی کنیم!؟ بگذارید موضوع رو ساده کنیم، ما یه انیمیشن از دکمه سوییچ داریم. این انیمیشن از پراگرس &lt;strong&gt;0.0&lt;/strong&gt; تا &lt;strong&gt;0.5&lt;/strong&gt; نشون میده که سوییچ &lt;code class=&quot;highlighter-rouge&quot;&gt;On&lt;/code&gt; میشه، و از پراگرس &lt;strong&gt;0.5&lt;/strong&gt; تا &lt;strong&gt;1.0&lt;/strong&gt; نشون میده که سوییچ &lt;code class=&quot;highlighter-rouge&quot;&gt;Off&lt;/code&gt; میشه.&lt;/p&gt;

&lt;p&gt;حالا موقعی که کاربر سویچ on رو تپ کرد، انیمیشن رو از پراگرس &lt;strong&gt;0.0&lt;/strong&gt; به &lt;strong&gt;0.5&lt;/strong&gt; انیمیت می‌کنیم. و وقتی سویچ رو off کرد، میتونیم ۲ کار انجام بدیم:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;یا انیمیشن رو از 0.5 به 1.0، انیمیت کنیم.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;یا اینکه انیمیشن رو بصورت &lt;strong&gt;reverse&lt;/strong&gt; پخش کنیم. یعنی پراگرس از 0.5 به 0.0 انیمیت میشه.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;من در نمونه اپلیکیشنی که در گیتهاب گذاشتم، چند مثال در این مورد آوردم:&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;دکمه سوییچ:&lt;/strong&gt; در این مثال من یه مقدار بولین به اسم &lt;code class=&quot;highlighter-rouge&quot;&gt;switchIsOn&lt;/code&gt; ایجاد کردم تا باز یا بسته بودن سوییچ رو بتونم دنبال کنم. وقتی که کاربر کلیک کرد یکبار متد &lt;code class=&quot;highlighter-rouge&quot;&gt;playAnimation()&lt;/code&gt; و دفعه بعد &lt;code class=&quot;highlighter-rouge&quot;&gt;reverseAnimation()&lt;/code&gt; رو صدا میزنم.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;switchIsOn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;animatedSwitchButton&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;reverseAnimation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;switchIsOn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;animatedSwitchButton&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;playAnimation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;switchIsOn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;همبرگر منو:&lt;/strong&gt; در این مثال بازم هم من یه مقدار بولین برای دنبال کردن باز/بسته بودن منو درست کردم. حالا موقع بازشدن همبرگر منو، با استفاده از کلاس &lt;code class=&quot;highlighter-rouge&quot;&gt;ValueAnimator&lt;/code&gt; یک رنج از پراگرس ایجاد کرده &lt;code class=&quot;highlighter-rouge&quot;&gt;(0.05f, 0.45f)&lt;/code&gt; و مقداری هم برای مدت زمان سپری کردن این انیمیشن تعریف میکنم &lt;code class=&quot;highlighter-rouge&quot;&gt;setDuration(2000)&lt;/code&gt;. برای بسته شدن همبرگر منو هم، یه رنج دیگه با مقادیری بلعکس ایجاد کردم. خب، از الان هربار که کاربر روی دکمه کلیک کنه، انیمیشن نمایش داده میشه و انگار که منو باز و بسته میشه.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;//With ValueAnimator&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ValueAnimator&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;animator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hamburgerIsOpen&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;animator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ValueAnimator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;ofFloat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.05f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.45f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setDuration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2000&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;hamburgerIsOpen&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;animator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ValueAnimator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;ofFloat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.45f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.05f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setDuration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2000&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;hamburgerIsOpen&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;animator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addUpdateListener&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ValueAnimator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;AnimatorUpdateListener&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;onAnimationUpdate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ValueAnimator&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;animation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;animatedHamburger&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setProgress&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Float&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;animation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getAnimatedValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;});&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;animator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;دکمه رادیو:&lt;/strong&gt; در مورد کیس رادیو باتن هم برای اکتیو کردن سلکشن، یکبار انیمیشن کامل به نمایش درمیاد، بار دوم که کاربر کلیک میکنه، پراگرس روی &lt;strong&gt;0.0&lt;/strong&gt; یعنی موقعی که رادیو انتخاب نشده بود سِت میشه. و این روند همینجوری ادامه خواهد داشت.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;animatedRadioButton&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getProgress&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;animatedRadioButton&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;playAnimation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;animatedRadioButton&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setProgress&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;دنبال کردن انیمیشن:&lt;/strong&gt; ما میتونیم هم &lt;strong&gt;مراحل&lt;/strong&gt; و هم &lt;strong&gt;روند&lt;/strong&gt; انیمیشنمون رو دنبال کنیم. برای مثال من در مورد کیس دکمه قطع صدا، میخواستم وقتی که انیمیشن تموم شد یه Toast نشون بدم و به کاربر بگم که صدا تموم شد. برای همین متد &lt;code class=&quot;highlighter-rouge&quot;&gt;addAnimatorListener&lt;/code&gt; رو برای ویوومون تعریف کردم که به ما ۴تا متد دیگه میده:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;onAnimationStart&lt;/code&gt; هنگام شروع انیمیشن&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;onAnimationEnd&lt;/code&gt; هنگام پایان انیمیشن&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;onAnimationCancel&lt;/code&gt; هنگام لغو شدن انیمیشن&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;onAnimationRepeat&lt;/code&gt; هنگام تکرار انیمیشن&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;پس من هم از &lt;code class=&quot;highlighter-rouge&quot;&gt;onAnimationEnd&lt;/code&gt; استفاده کردم و موقعی که انیمیشن تموم میشه به کاربر میگم که صدا قطع شد یا وصل شد.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;//Animator Listener&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;animatedMuteButton&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addAnimatorListener&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Animator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;AnimatorListener&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;onAnimationStart&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Animator&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;animation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;onAnimationEnd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Animator&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;animation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;Toast&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;makeText&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;InteractionAnimation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;isMute&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Sound is mute.&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Sound isn't mute.&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Toast&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;LENGTH_SHORT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;onAnimationCancel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Animator&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;animation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;onAnimationRepeat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Animator&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;animation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;ایطوری میتونید مراحل و مقاطع انیمیشن رو دنبال کنید. خب یه وقتایی هم هست که نیازه تا روند اپلیکیشن رو دنبال کنیم. برای اینکه این قضیه رو واستون روشن کنم از‌ انیمیشن یه ساعت استفاده کردم، میخوام به فلان تایم یا فلان درصد از پراگرس که رسید، رنگش عوض بشه. وقتی هم که زمان تموم شد، یه اسنک نشون بده که زمانت تموم شده. برای این لازمه که هرلحظه بدونم در چه درصدی از انیمیشن قرار داریم. واسه پیاده کردن این موضو از متدی به اسم &lt;code class=&quot;highlighter-rouge&quot;&gt;addAnimatorUpdateListener&lt;/code&gt; برای ترک کردن هربار آپدیت شدن یا تغییر کرد یکی از مشخصه های انیمیشن استفاده میکنیم (که ساده‌ترینش همین تغییر پراگرس هست). یه سری &lt;strong&gt;if&lt;/strong&gt; هم گذاشتم و با &lt;code class=&quot;highlighter-rouge&quot;&gt;getAnimatedValue()&lt;/code&gt; چک کردم که اگه در فلان بازه ای قرار گرفت، رنگش تغییر کنه یا اسنک نشون بده. که نهایتا شد این:&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;//Animator Update Listener&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;animatedWatch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addAnimatorUpdateListener&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ValueAnimator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;AnimatorUpdateListener&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;onAnimationUpdate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ValueAnimator&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;animation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Float&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;animation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getAnimatedValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;animatedWatch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addColorFilter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PorterDuffColorFilter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;RED&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PorterDuff&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Mode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;SRC&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Float&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;animation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getAnimatedValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Float&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;animation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getAnimatedValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;animatedWatch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addColorFilter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PorterDuffColorFilter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;MAGENTA&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PorterDuff&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Mode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;SRC&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Float&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;animation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getAnimatedValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Float&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;animation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getAnimatedValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.75&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;animatedWatch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addColorFilter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PorterDuffColorFilter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;CYAN&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PorterDuff&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Mode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;SRC&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;animatedWatch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addColorFilter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PorterDuffColorFilter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;BLUE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PorterDuff&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Mode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;SRC&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Float&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;animation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getAnimatedValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.93f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;Snackbar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;make&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;findViewById&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;container&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt;  &lt;span class=&quot;s&quot;&gt;&quot;Oh My Lottie, your time is finished!&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Snackbar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;LENGTH_LONG&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;خب فکر میکنم تمام چیزهایی که در این بخش لازم بود رو گفتم. حالا میتونید باقی سناریوهارو بر اساس همین‌ تمرین پیاده کنید.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-08-10/lottie-anim-2.gif&quot; alt=&quot;Lottie Interaction With User Demo&quot; /&gt;&lt;/p&gt;

&lt;p&gt;و آدرس تمامی کدهای و نمونه‌هایی که در این قسمت پیاده کردیم:&lt;/p&gt;

&lt;div class=&quot;div-ltr&quot;&gt;

  &lt;p&gt;&lt;strong&gt;Get it from github:&lt;/strong&gt; &lt;a href=&quot;https://github.com/sadra/LottieExampleProject/blob/master/app/src/main/java/com/isapanah/lottieeexampleproject/InteractionAnimation.java&quot;&gt;Class&lt;/a&gt; / &lt;a href=&quot;https://github.com/sadra/LottieExampleProject/blob/master/app/src/main/res/layout/interaction_animation.xml&quot;&gt;Layout&lt;/a&gt;&lt;/p&gt;

  &lt;p&gt;&lt;strong&gt;JSON Animations:&lt;/strong&gt;&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;
      &lt;p&gt;&lt;a href=&quot;https://github.com/sadra/LottieExampleProject/blob/master/app/src/main/assets/radio_button.json&quot;&gt;radio_button&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li&gt;
      &lt;p&gt;&lt;a href=&quot;https://github.com/sadra/LottieExampleProject/blob/master/app/src/main/assets/switch.json&quot;&gt;switch&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li&gt;
      &lt;p&gt;&lt;a href=&quot;https://github.com/sadra/LottieExampleProject/blob/master/app/src/main/assets/hamburger.json&quot;&gt;hamburger&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li&gt;
      &lt;p&gt;&lt;a href=&quot;https://github.com/sadra/LottieExampleProject/blob/master/app/src/main/assets/mute.json&quot;&gt;mute&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li&gt;
      &lt;p&gt;&lt;a href=&quot;https://github.com/sadra/LottieExampleProject/blob/master/app/src/main/assets/watch.json&quot;&gt;watch&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ul&gt;

&lt;/div&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;lottie-animated-font&quot;&gt;5.  پیاده سازی فونت انیمیشنی&lt;/h3&gt;

&lt;p&gt;فونت انیمیشنی، یکی از چیزهای جالبی که لاتی داشت و بنده خیلی درد کشیدم تا پیادش کنم! قبل از شروع این قسمت دعوت میکنم با دیدن انیمیشن زیر، با این پدیده آشنا بشید:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-08-10/lottie-anim-3.gif&quot; alt=&quot;Lottie Animation Font Demo&quot; /&gt;&lt;/p&gt;

&lt;p&gt;اما واقعا چطوری یه همچین چیزیو میشه درست کرد؟ اجازه بدید تا تکنیک این بخش رو تشریح کنم.&lt;/p&gt;

&lt;p&gt;مایه پوشه داریم که درون این پوشه به ازای هر حرف از حروف الفبا، یه انیمیشن وجود داره، مثلا یه انیمیشنی که انیمیت میشه تا حرف A رو نشون بده. ازونور ما گوش میدیم و هروقت که یه حرف از حروف الفبا تایپ شد، ما هم انیمیشنش رو پیدا کرده و به متن نوشته شده قبلی ( درواقع انیمیشن های بهم چسبیده قبلی) اضافه میکنم. یه انیمیشن هم واسه cursor داریم که مثلا نشون میده نشانه نوشتار ما الان کجاست. به همین سادگی.&lt;/p&gt;

&lt;p&gt;خب، اول از همه نیازه که یه کلاس ایجاد کنیم به اسم &lt;strong&gt;LottieFontViewGroup&lt;/strong&gt; که از FrameLayout اکستند شده و نگهدارنده انیمیشن‌های ماست. این کلاس برای ما ۳تا کار انجام میده:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;ایجاد ویوو برای ادیتور متن&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ثبت کردن اکشن ها به عنوان انیمیشن (مثل نشانگر، حروف و خط فاصله)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;نگهدارندی و کنترل کردن انیمیشن ها&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;نمونه ای که الان در گیتهاب خود Lottie هست، با زبان کاتلین نوشته شده &lt;a href=&quot;https://github.com/airbnb/lottie-android/blob/master/LottieSample/src/main/kotlin/com/airbnb/lottie/samples/LottieFontViewGroup.kt&quot;&gt;LottieFontViewGroup.kt&lt;/a&gt; و من همون نمونه رو به جاوا کمی تغییر دادم و سایز فونت‌هارو اصلاح کردم و نهایت گذاشتمش توی گیتهاب همین پروژه که از اینجا میتونید &lt;a href=&quot;https://github.com/sadra/LottieExampleProject/blob/master/app/src/main/java/com/isapanah/lottieeexampleproject/LottieFontViewGroup.java&quot;&gt;LottieFontViewGroup.java&lt;/a&gt; دریافتش کنید.&lt;/p&gt;

&lt;p&gt;خب، فقط کافیه که ویوو مربوطه رو در لایه ای که مد نظرتون هست قرار بدید، بدون اینکه نیاز باشه با چیز دیگه‌ای درگیر بشین.&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;com.example.yourproject.LottieFontViewGroup&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;android:id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;@+id/fontView&quot;&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;android:layout_width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;match_parent&quot;&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;android:layout_height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;wrap_content&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;ممکنه بپرسین این فونت انیمیشنی به چه دردی میخوره؟ شاید خود ادیتورش بدردتون نخوره، ولی میتونید ازش استفاده کنید و متنی که دلتون میخواد (مثلا اسم شرکت یا پروژه) رو بصورت انیمیشنی به کاربر نمایش بدید.&lt;/p&gt;

&lt;p&gt;میتونید از فونت دیگه ای هم استفاه کنید؟ صد در صد، فقط باید زحمت طراحی انیمیشن برای تمامی حروف رو خودتون بکشید :)) چون غیر از همین نمونه ای که روی وب بود، چیز دیگه ای پیدا نکردم.&lt;/p&gt;

&lt;p&gt;و آدرس تمامی کدهای و نمونه‌هایی که در این قسمت پیاده کردیم:&lt;/p&gt;

&lt;div class=&quot;div-ltr&quot;&gt;

  &lt;p&gt;&lt;strong&gt;Get it from github:&lt;/strong&gt; &lt;a href=&quot;https://github.com/sadra/LottieExampleProject/blob/master/app/src/main/java/com/isapanah/lottieeexampleproject/LottieFontViewGroup.java&quot;&gt;LottieFontViewGroup&lt;/a&gt; / &lt;a href=&quot;https://github.com/sadra/LottieExampleProject/blob/master/app/src/main/java/com/isapanah/lottieeexampleproject/AnimatedFont.java&quot;&gt;Class&lt;/a&gt; / &lt;a href=&quot;https://github.com/sadra/LottieExampleProject/blob/master/app/src/main/res/layout/activity_typography_demo.xml&quot;&gt;Layout&lt;/a&gt; / &lt;a href=&quot;https://github.com/sadra/LottieExampleProject/tree/master/app/src/main/assets/Mobilo&quot;&gt;Animation Font Folder&lt;/a&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;lottie-intro&quot;&gt;6.  طراحی صفحه خوش‌آمد گویی با انیمیشن&lt;/h3&gt;

&lt;p&gt;و تمرین آخر، در این قسمت میخواهیم یک صفحه خوش‌آمدی گویی، Intro یا OnBoarding بسازیم.&lt;/p&gt;

&lt;p&gt;اول بیایم منطق قضیه رو باهم بررسی کنیم. در این پروژه به یک فایل انیمیشن که شامل تمامی مراحل Intro باشه نیاز داریم. هر مرحله یک آغاز و پایانی داره و ما باید زمان شروع و پایان تمامی مراحل رو در بیاریم، برای مثال صفحه دوم Intro از پراگرس 0.25 شروع و در 0.42 تموم میشه. حالا موقعی که کاربر Swipe میکنه یا روی دکمه ‘بعدی’ کلیک میکنه ما هم همگام با اسکرول شدن صفحه، پراگرس انیمیشن رو به همون نسبت جلو میبریم.&lt;/p&gt;

&lt;p&gt;در این تمرین برای صفحه خوش‌امدگویی از لایبرری &lt;a href=&quot;https://github.com/MatthewTamlin/SlidingIntroScreen&quot;&gt;SlidingIntroScreen&lt;/a&gt; و انیمیشن &lt;a href=&quot;https://github.com/sadra/LottieExampleProject/blob/master/app/src/main/assets/services_intro.json&quot;&gt;services_intro&lt;/a&gt; استفاده کردم. و زمان تمامی مراحل انیمیشن رو به ترتیب زیر لیست کردم:&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ANIMATION_TIMES&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]{&lt;/span&gt;
    &lt;span class=&quot;mf&quot;&gt;0.06f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;mf&quot;&gt;0.25f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;mf&quot;&gt;0.42f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;mf&quot;&gt;0.57f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;mf&quot;&gt;0.71f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;mf&quot;&gt;0.9f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;};&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;توجه کنید که ۲ مقدار پایانی باید با پراگرس آخری یکی باشن، تا موقع اسکرول کردن آرایه سرریز نکنه.&lt;/p&gt;

&lt;p&gt;و بعدش هم به تعداد صفحاتی که قرار اسکرول کنیم نمونه ساختم:&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Collection&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;?&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Fragment&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;generatePages&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Bundle&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;savedInstanceState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ArrayList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;EmptyFragment&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

        &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pages&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pages&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;EmptyFragment&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;newInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;pages&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;--;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;o&quot;&gt;}};&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;هرموقع که صفحه خوش‌آمدگویی درحال اسکرول شد، متد setAnimationProgress صدا میزنم، در این متد مقدار پاگرس فعلی و بعدی رو میگیرم و مقدار اسکرول رو هم داریم و میزان پراگرس رو به انیمیشنمون اضافه میکنم:&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;setAnimationProgress&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;position&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;positionOffset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;startProgress&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ANIMATION_TIMES&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;position&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;endProgress&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ANIMATION_TIMES&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;position&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;animationView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setProgress&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lerp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;startProgress&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;endProgress&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;positionOffset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;برای اینکه انیمیشنمون تمیز و زیبا انجام بشه از متدی به نام lerp استفاده میکنیم. این متد بهمون کمک میکنه که زمان انیمیشنمون رو متناسب به مقدار اسکرولی که انجام شده جلو ببریم و این تغییر انیمیشن‌ها با نرمی بیشتری انجام بشه:&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;lerp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;startValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;endValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;startValue&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;endValue&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;startValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;خب تمومه. حالا یه صفحه خوش‌امد گویی ترو تمیز داریم. و اینم کاریه که انجام دادیم:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-08-10/lottie-anim-4.gif&quot; alt=&quot;Lottie Intro Animation Demo&quot; /&gt;&lt;/p&gt;

&lt;p&gt;از همین متد میتونید توی بقیه لایبرری هایی که کار Intro یا onBoarding رو انجام میدن استفاده کنید.&lt;/p&gt;

&lt;p&gt;و آدرس تمامی کدهای و نمونه‌هایی که در این قسمت پیاده کردیم:&lt;/p&gt;

&lt;div class=&quot;div-ltr&quot;&gt;

  &lt;p&gt;&lt;strong&gt;Get it from github:&lt;/strong&gt; &lt;a href=&quot;https://github.com/sadra/LottieExampleProject/blob/master/app/src/main/java/com/isapanah/lottieeexampleproject/AppIntroActivity.java&quot;&gt;AppIntroActivity&lt;/a&gt; / &lt;a href=&quot;https://github.com/sadra/LottieExampleProject/blob/master/app/src/main/res/layout/app_intro_animation_view.xml&quot;&gt;app_intro_animation_view&lt;/a&gt; / &lt;a href=&quot;https://github.com/sadra/LottieExampleProject/blob/master/app/src/main/res/layout/fragment_empty.xml&quot;&gt;fragment_empty&lt;/a&gt; / &lt;a href=&quot;https://github.com/sadra/LottieExampleProject/blob/master/app/src/main/assets/services_intro.json&quot;&gt;JSON Animation&lt;/a&gt;&lt;/p&gt;

&lt;/div&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;lottie-tips&quot;&gt;7.  نکات مهم&lt;/h3&gt;

&lt;p&gt;در ادامه مطلب قصد دارم نکاتی درباره استفاده از لایبرری Lottie به شما یادآور بشم:&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;استفاده از انیمیشن‌های آماده:&lt;/strong&gt; همونطور که در بخش‌های ابتدایی ذکر کرده بودم، شما متیونید از انمیمیشن‌های آماده در پروژتون استفاده کنید. توجه کنید که بعضی از این اینیمیشن‌ها ناقص هستند یا مشکلی دارند. فقط چند مورد مثال میزنم.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;فضای خالی دور انیمیشن:&lt;/strong&gt; بعضی از انیمیشن ها مثل &lt;a href=&quot;https://www.lottiefiles.com/425-bold-button&quot;&gt;این&lt;/a&gt;، &lt;a href=&quot;https://www.lottiefiles.com/422-onoff-switch-2&quot;&gt;این&lt;/a&gt; و &lt;a href=&quot;https://www.lottiefiles.com/416-thumbs-up&quot;&gt;این&lt;/a&gt; حدودا به اندازه ۵۰۰پیکسلِ مربع فضای خالیه اطرافشون! خیلی سعی کردم با خود فایل JSON ور برم و از فضای خالیش کم کنم، اما نشد که نشد. وقتی ازینها در پروژه استفاده می‌کنید ممکنه بیش از حد کوچیک به نظر بیان. تنها راه حلی که به ذهنم رسید این بود که ویوو انیمیشن رو اسکیل بدم. متاسفانه این اسکیل دادن در بعضی مواقع باعث میشه که انیمیشن پیکسله بشه.&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;com.airbnb.lottie.LottieAnimationView&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;android:id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;@+id/animatedView&quot;&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;android:scaleX=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1.5&quot;&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;android:scaleY=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1.5&quot;&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;android:layout_width=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;60dp&quot;&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;android:layout_height=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;60dp&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;تکرار بی‌جهت انیمیشن:&lt;/strong&gt; در بعضی انیمیشن‌ها مثل &lt;a href=&quot;https://www.lottiefiles.com/334-bamburge&quot;&gt;این&lt;/a&gt; و &lt;a href=&quot;https://www.lottiefiles.com/444-mute&quot;&gt;این&lt;/a&gt; دیده شده که انیمیشن بعد از پایان، دوباره تا چند فریم حرکت اضافی داره! دو راه پیش پای ماست، یا اینکه رنج شروع و پایان برای انیمیشن تعریف کنیم. یا اینکه در فایل JSON انیمیشن دست ببریم. اما چطوری. هر فایل JSON انیمیشنی رو که باز کنید، دارای دو پارامتر ip و op هستند. ip نشون دهنده فریم شروع کننده انمیشین و op نشون دهنده فریم پایانی انیمیشن هست. با تغییر این دو فاکتور در فایل JSON میتونید شروع و پایان انیمیشنتون رو دستکاری کنید.&lt;/p&gt;

&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;ip&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;op&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;27.05&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;استفاده از AnimatedVectorDrawable:&lt;/strong&gt; همین چند روز پیش بود که نیک بوچر در &lt;a href=&quot;https://medium.com/google-design/bodymovin-to-android-6e53e5f7a96&quot;&gt;وبلاگش نوشت&lt;/a&gt; که با استفاده از نسخه ۴ پلاگین BodyMovin میتونین برای AVD مستقیما خروجی بگیرین. باین اوصاف یعنی دیگه نیازی به Lottie نیست؟ خیر، شما فعلا فقط میتونید اون خروجی رو نمایش بدید. اما این دلیل نمیشه که تمام امکاناتی که Lottie داره، AVD هم داشته باشه. سعی میکنم در یه پست جداگانه نحوه استفاده از AVD رو هم آموزش بدم اما الان فقط میخوام به خواص هرکدوم اشاره میکنم:&lt;/p&gt;

&lt;p&gt;خوبی‌های Lottie:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;بیشتر از هر لایبرری و پلاگین دیگه از انیمیشن‌های افترافکت پشتیبانی میکنه&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;شما دسترسی کاملا دستی و Manual به انیمیشن دارید و میتونید eventها و کلیک‌هارو مدیریت کنید&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;میتونید خود فایل رو مستقیما از اینترنت دریافت کرده و نمایش بدید&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;میتونید بصورت برعکس پخش کنید و سرعتشو کنترل کنید&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;با در اختیار گذاشتن پراگرس شما میتونید حتی نحوه پخش انیمیشن رو هم مدیریت کنید&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;خوبی AVD:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;انیمیشن با سرعت و پرفرمنس بهتری در &lt;a href=&quot;https://medium.com/@workingkills/understanding-the-renderthread-4dc17bcaf979&quot;&gt;Render Thread&lt;/a&gt; نسبت به Main Thread اجرا میشه.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;پشتیبانی از AfterEffect:&lt;/strong&gt; لایبرری لاتی یه &lt;a href=&quot;http://airbnb.io/lottie/supported-features.html&quot;&gt;لیست&lt;/a&gt; از انیمیشن‌ها و افکت‌هایی از افترافکت که پشتیبانی می‌کنه آماده کرده. قبل از طراحی انیمیشن در AfterEffect حتما این &lt;a href=&quot;http://airbnb.io/lottie/supported-features.html&quot;&gt;فیچر‌ها&lt;/a&gt; رو بررسی کنید تا خدای نکرده انیمیشنتون ناقص اجرا نشه.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;سایز انیمیشن:&lt;/strong&gt; اگه براتون سوال بوجود اومد که سایز انیمیشن هارو چطوری ست کنم؟ بهتون پیشنهاد میکنم این &lt;a href=&quot;https://material.io/devices/&quot;&gt;چیت شیت&lt;/a&gt; از متریال رو مطالعه کنید تا دستتون بیاد که چه سایز px رو باید برای انیمیشنهاتون تا در اندروید با سایز dp همخونی داشته باشه.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;کش کردن انیمیشن:&lt;/strong&gt; ممکنه بعضی از انیمیشن‌ها به کَرّات استفاده بشه. برای اینکار حتما برای انیمیشنتون CacheStartegy رو فعال کنید. CacheStrategy رو بر اساس میزان استفاده‌تون میتونید روی ۳ حالت &lt;code class=&quot;highlighter-rouge&quot;&gt;Strong&lt;/code&gt; ، &lt;code class=&quot;highlighter-rouge&quot;&gt;Weak&lt;/code&gt; و &lt;code class=&quot;highlighter-rouge&quot;&gt;None&lt;/code&gt; قرار بدید.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;lottieView&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LottieAnimationView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;findViewById&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;simpleAnimation_lottieView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;lottieView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setAnimation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;gift.json&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LottieAnimationView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;CacheStrategy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Strong&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;رنگ دادن به یک لایه خاص از انیمیشن&lt;/strong&gt;: مشابه مثالی که در بخش اول زدم، ممکنه شما بخوایید رنگ یک لایه خاص از انیمیشنتون رو تغییر بدید. مثلا در همون مثال ما رنگ بدنه و درپوش جعبه کادو رو تغییر دادیم. اما برای این کار، اگر انیمیشنتون رو خودتون طراحی کردین، میدونید که اسم لایه‌هاتون چیه و اسم لایه مورد نظر رو میبرید و رنگ بهش الصاق میشه. اما اگر از فایل آماده برای انیمیشنتون استفاده کردین، باید فایل JSON رو باز کرده و ببنید کدوم پارامتر‌ها با لیبل &lt;code class=&quot;highlighter-rouge&quot;&gt;nm&lt;/code&gt; مشخص شدن و دونه دونه اونهارو سعی و خطا تست کنید تا معلوم بشه کدومشون لایه مورد نظر شماست. برای مثال همین جعه دو لایه به نام های &lt;code class=&quot;highlighter-rouge&quot;&gt;body Konturen&lt;/code&gt; و &lt;code class=&quot;highlighter-rouge&quot;&gt;top Konturen&lt;/code&gt; اشاره به درپوش و بدنه جعبه داشت که پیدا کرده و رنگ رو بهش الصاق کردیم.&lt;/p&gt;

&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;err&quot;&gt;//gift.json&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;ddd&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;ind&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;ty&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;nm&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;body Konturen&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;ddd&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;ind&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;ty&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&quot;nm&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;top Konturen&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;زمان بندی در انیمیشن خوش‌آمدگویی:&lt;/strong&gt; اگه یادتون باشه در اون بخش گفتم که انیمیشن به نسبت اسکرول جلو و عقب میره. میدونیم که میزان فاصله دو صفحه از یک Viepager همیشه یکتا و بین همه صفحات مساویه. پس شما هم سعی کنید در انیمیشنی که طراحی میکنید این قانون رو نظر داشته باشید. اگه به همین انیمیشن دقت کنید  در بعضی بخشها سریع و در بعضی دیگه کند به نمایش درمیومد، دلیلش هم عدم توازن زمانی بین دو تغییر انیمیشن بود.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;آپدیت: این بخش در صورت مواجه شدن با مسايل جدید ممکنه به‌روزرسانی بشه.&lt;/strong&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;lottie-final&quot;&gt;8.  صحبت پایانی&lt;/h3&gt;

&lt;p&gt;این بلندترین پستی بود که تا به امروز نوشتم. چیزی نزدیک به 29هزار کَرکتر. امیدوارم این پست بدردتون خورده باشه. متن خیلی طولانیه، برای همین در بالای صفحه فهرستی از عنوانها آماده کردم تا شما به راحتی تونید به بخش‌های که میخوایید مراجعه کنید.&lt;/p&gt;

&lt;p&gt;اگه قصد داشتین از این پست در وبلاگتون استفاده کنید، درخواست میکنم حتما به همین پست و بخش مربوطه رفرنس بدید ^_^&lt;/p&gt;

&lt;p&gt;و در آخر من کامنت‌های وبلاگ رو بستم و دوست دارم با شما در شبکه‌های اجتماعی تعامل داشته باشم. اگر سوال یا موردی بود در &lt;a href=&quot;https://twitter.com/sadra_amlashi&quot;&gt;توییتر&lt;/a&gt; مطرح کرده و من رو با آیدی &lt;a href=&quot;https://twitter.com/sadra_amlashi&quot;&gt;@sadra_amlashi&lt;/a&gt; منشن کنید. متشکرم.&lt;/p&gt;</content><author><name>صدرا املشی</name></author><category term="Android" /><category term="UI" /><category term="Animation" /><category term="Lottie" /><summary type="html">همونطور که قبلا بهتون در پست “ استفاده از انیمیشن در توسعه اپلیکیشن “ قول داده بودم، در این پست قراره به آموزش استفاده از لایبرری Lottie و اضافه کردن منابع بصری انیمه به پروژه اندروید بپردازیم.</summary></entry><entry><title type="html">استفاده از انیمیشن در توسعه اپلیکیشن</title><link href="//isapanah.com/2017/oh-my-lottie" rel="alternate" type="text/html" title="استفاده از انیمیشن در توسعه اپلیکیشن" /><published>2017-07-26T00:00:00+04:30</published><updated>2017-07-26T00:00:00+04:30</updated><id>//isapanah.com/2017/oh-my-lottie</id><content type="html" xml:base="//isapanah.com/2017/oh-my-lottie">&lt;p&gt;یکی از موضوعاتی که چندوقت اخیر ذهن منو مشغول کرده بود، این بوده که بتونم از منابع گرافیکی و انیمیشن‌های پیچیده در پروژم استفاده کنم. ولی هربار پیگیری این قضیه رو عقب مینداختم. تا اینکه دیروز &lt;a href=&quot;https://www.instagram.com/farid_landi&quot;&gt;فرید&lt;/a&gt; ازم پرسید آیا برای این قضیه راه حلی دارم؟ و این موضوع بهونه‌ای شد، تا با &lt;a href=&quot;http://dcamp.ir/&quot;&gt;شایان&lt;/a&gt; دنبال یه سرویس خوب بگردیم. امروز قصد ندارم کد‌نویسی کنم و فقط میخوام مورادی که پیدا کردیم رو به شما معرفی کنم.&lt;/p&gt;

&lt;h2 id=&quot;لایبرری-اندروید-glide&quot;&gt;لایبرری اندروید Glide&lt;/h2&gt;

&lt;p&gt;لایبرری &lt;a href=&quot;https://github.com/bumptech/glide&quot;&gt;Glide&lt;/a&gt; یکی از گزینه‌ها برای استفاده از انیمیشن (یا همون فایل gif) در پروژه اندرویده. و استفاده کردن از اون هم خیلی ساده ست:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;فقط لایبرری رو به پروژتون اضافه میکنید&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;و بعد ویو رو به لی‌اَوت‌-تون اضافه می‌کنید&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;و در آخر ویوو رو در کلاستون کَست کرده و انیمیشن خودتون رو بهش معرفی میکنید&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;در نهایت این میشه نتیجش&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-07-30/oh-my-lottie-10.gif&quot; alt=&quot;Glide Result&quot; /&gt;&lt;/p&gt;

&lt;p&gt;این لایبرری علاوه بر همه خوبیهاش، مشکلاتی هم داره:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;میزان استفاده از رم رو به شدت بالا میبره&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;شما کنترل مناسبی روی انیمیشن ندارید&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;و موقع Scale شدن انیمه، ممکنه تصویرتون پیکسله بشه&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;محیط-توسعه-supernova-studio&quot;&gt;محیط توسعه SuperNova Studio&lt;/h2&gt;

&lt;p&gt;این ابزار چیزی شبیه Sketch ست. با این تفاوت که میتونید از تمام لایه‌هایی که در این محیط طراحی میکنید، بصورت Native خروجی گرفته و در پروژتون،‌ ایمپورتش کنید.&lt;/p&gt;

&lt;p&gt;با استفاده از ابزارهای زیادی که &lt;a href=&quot;https://supernova.studio/&quot;&gt;SuperNova Studio&lt;/a&gt; در اختیارتون گذشته، شما میتونید برای سه پلتفرم Android ، iOS و React خروجی بگیرید.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-07-30/oh-my-lottie-2.png&quot; alt=&quot;SuperNova Studio&quot; /&gt;&lt;/p&gt;

&lt;p&gt;سوپرنوا این امکان رو به شما میده که بتونید قبل از ورود به مرحله توسعه،‌در داخل همون استدیو، لایه‌هاتون رو تست بگیرید. این امکان وجود داره که پیشنمایش لایه‌ها در هر سایزی روی شبیه ساز Android ، iOS و البته مرورگر، اجرا کنید. این ابزار به شما کمک میکنه که قبل از شروع به نوشتن حتی یک خط کد، از UI و UX اپتون مطمئن بشید.&lt;/p&gt;

&lt;p&gt;چرا راجع به SuperNova گفتم؟ برای اینکه در محیط توسعه این استدیو، میتونید انیمیشن‌های خودتون رو پیاده سازی کرده و خروجی که دریافت میکنید رو عینا توی پروژتون استفاده کنید.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-07-30/oh-my-lottie-3.png&quot; alt=&quot;SuperNova Studio&quot; /&gt;&lt;/p&gt;

&lt;p&gt;لازم به ذکره که هنوز خودم از این سرویس استفاده نکردم و چیزهایی که گفتم بعضا از روی داکیومنتهاش و ویدئوهایی بود که درباره استدیوشون منتشر کردند. SuperNova Studio الان در نسخه بتاست و شما میتونید به رایگان دانلود کرده و ازش استفاده کنید.&lt;/p&gt;

&lt;h2 id=&quot;فریمورک-متن-باز-lottie&quot;&gt;فریم‌ورک متن باز Lottie&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;لاتی&lt;/strong&gt;، نخونید &lt;strong&gt;لوتی&lt;/strong&gt;! چیزیه که من اینهمه واسش سروصدا راه انداختم! فریم ورک &lt;a href=&quot;https://airbnb.design/lottie/&quot;&gt;Lottie&lt;/a&gt;، دقیقا همه‌ی همونچیزیه که ما بهش احتیاج داشتیم. یا بهتر بگم،‌ فریم‌ورک‌های قبل از تو، سؤتفاهم بود :))&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-07-30/oh-my-lottie-9.png&quot; alt=&quot;Lottie&quot; /&gt;&lt;/p&gt;

&lt;p&gt; لاتی به همین سادگیه:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;منابع گرافیکی‌تو در After Effect بساز&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ازش خروجی JSON بگیر&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;حالا Lottie بهت کمک میکنه که در iOS، Android و ReactNative از اون استفاده کنی.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;strong&gt;لاتی چیه؟&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;لاتی یک فریم‌ورک رایگان و متن بازه که توسط بروبچه‌های &lt;a href=&quot;https://airbnb.design&quot;&gt;AirBnb&lt;/a&gt; توسعه داده شده. تا قبل از این برای استفاده کردن از انیمیشن‌های پیچیده، مجبور بودیم کلی کدهای مسخره و پیچیده رو بکار ببریم و کلی پروسه الکی به اپمون اضافه کنیم. حتی لازم بود واسه اینکه انیمه ها پیکسله نشن، برای هر نمونهِ انیمه، در سایزهای مختلف خروجی بگیریم و به پروژمون اضافه کنیم! یا اینکه هزارخط کد بنویسیم تا یه انیمیشن احمقانه رو پیاده کنیم :(&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-07-30/oh-my-lottie-4.gif&quot; alt=&quot;Lottie&quot; /&gt;&lt;/p&gt;

&lt;p&gt;با اینکه انیمیشن بسیار بسیار در زیبا شدن اپ و بالا بردن تجربه کاربری کمک میکنه، اما بخاطر همین مشکلات خیلی از توسعه دهنده ها کلا از انیمیشن استفاده نمیکنند و تنها به همون منابع محدودی که خود محیط توسعه در اختیارشون میگذاره، بسنده میکنن! اما AirBnb کلا این تصور و تفکر رو تغییر داد.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ماجرای Lottie&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;لاتی ابزاریه که به شما کمک میکنه تا بدون محدودیت، منابع گرافیکی رندر شده در افترافکت رو خروجی بگیرین و بصورت Native در iOS ، Android و ReactNative استفاده کنید. سال ۲۰۱۵ بود که &lt;a href=&quot;https://twitter.com/airnanan&quot;&gt;Hernan Torrisi&lt;/a&gt; ایتالیایی یک افزونه برای افترافکت به نام &lt;a href=&quot;https://github.com/bodymovin/bodymovin&quot;&gt;BodyMovin&lt;/a&gt; ساخت، تا به کاربرا کمک کنه از پروژه هاشون بصورت HTML ، JSON و فرمتهای دیگه خروجی بگیرن.&lt;/p&gt;

&lt;p&gt;بعد از این بود که چهارنفر نفر از بروبچه‌های AirBnb تصمیم گرفتن تا با استفاده از اون فایل JSON شروع کنن برای هرسه پلتفرم، فریم‌ورک Lottie رو پیاده کنن. بدین صورت بود که ‌‌&lt;a href=&quot;http://github.com/buba447&quot;&gt;Brandon Withrow&lt;/a&gt; برای &lt;a href=&quot;https://github.com/airbnb/lottie-ios&quot;&gt;iOS&lt;/a&gt;، سپس &lt;a href=&quot;https://twitter.com/gpeal8&quot;&gt;Gabriel Peal&lt;/a&gt; برای &lt;a href=&quot;https://github.com/airbnb/lottie-android&quot;&gt;Android&lt;/a&gt; و بعدش &lt;a href=&quot;https://twitter.com/intelligibabble&quot;&gt;Leland Richardson&lt;/a&gt; برای &lt;a href=&quot;https://github.com/airbnb/lottie-react-native&quot;&gt;ReactNative&lt;/a&gt; این سرویس رو پیاده کردن. ناگفته نمونه که &lt;a href=&quot;https://twitter.com/therealsalih?lang=en&quot;&gt;Salih Abdul-Karim&lt;/a&gt; مدیریت این تیم و پیاده سازی User Experience رو بر عهده داشته. و اینجوری بود که Lottie خلق شد. و چقدر خوب این فریم‌روک پیاده شده.&lt;/p&gt;

&lt;div class=&quot;image-wrapper&quot;&gt;
    
    &lt;a href=&quot;#&quot; title=&quot;Salih Abdul-Karim&quot; target=&quot;_blank&quot;&gt;
        
        &lt;img src=&quot;/assets/img/post/2017-07-30/oh-my-lottie-5.jpg&quot; alt=&quot;Salih Abdul-Karim&quot; /&gt;
        
    &lt;/a&gt;
    
    
    &lt;p class=&quot;image-caption&quot;&gt;صلیح عبدالکریم، جیگر منه :))&lt;/p&gt;
    
&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;قالَ شایان: ازونجایی که دونفر از ۳ فاندر AirBnb طراح و گرافیست بودن، به همین دلیل به شدت روی گرافیک و منابع بصری سرویس‌هاشون تاکید و توجه ویژه ای داشتند. پس دور از ذهن نیست که چرا همچین چیزی مثل Lottie انقدر خوب، با کیفیت و کاربردی پیاده میشه.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;strong&gt;وقتی روزهای بد تموم میشن&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;روند کار همیشه اینطور بوده که تیم طراحی، طرح رابط کاربری اپ رو توی اسکچ یا فتوشاپ پیاده می‌کرد. و بعد طرح به توسعه دهنده سپرده میشد و ایشون هم بر اساس پروتوتایپی که دریافت کرده شروع به کد زدن میکرد:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;این پروسه معمولا خیلی طول میکشید&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;و معمولا چیزی که پیاده میشد، با طرحی که زده شده بود، نسبتا اختلاف داشت&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;اوضاع وقتی بدتر میشد که در پروتوتایپ انیمیشن هم وجود داشت! اونوقت توسعه دهنده باید برای هر انیمیشن یه ریسورس تعریف کنه. اوضاع وقتی حزن‌انگیز میشه که انیمیشن پیچیده میشه در نتیجه باید برای Line art یه سری ریسورس، برای Charecter-based animation یه سری ریسورس، و برای Logo animation هم یه سری ریسورس دیگه تعریف کنه. تصور کنید وقتی که بخواید اینارو ریفکتور کنه یا تغییری در اونها بده. چقدر کد، چقدر فایل، چقدر زحمت و چقدر دردسر!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-07-30/oh-my-lottie-7.gif&quot; alt=&quot;Lottie&quot; /&gt;&lt;/p&gt;

&lt;p&gt;اما حالا طراح یکبار انیمیشن رو طراحی میکنه،‌ یه خروجی جیسون تحویل توسعه دهنده‌ها میده، و روی هرسه پلتفرم یک چیز واحد رو تحویل میگیره! هرموقع هم نیاز به تغییر بود، تو افترک‌افکت تغییرات انجا میشه و فایل جیسون پاس میشه به توسعه دهنده ها. به همین سادگی‌، به همین خوشمزگی!&lt;/p&gt;

&lt;p&gt;یکی از امکانات خوب لاتی اینه که به ما اجازه کنترل کامل ویوو ساخته شده رو میده. شما میتونید انیمه رو جلو برده یا برعکس شروع به پخش کنید (بشدت پرکاربرد در onboarding). و میتونید بر اساس اینترکت‌ی که کاربر با ویوو داره اون رو تغییر بدید، مثل همربرگر منو.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;یه راه حل انعطاف‌‌پذیر و کاربردی&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;دو ابزار دیگه مثل لاتی که کاربرد مشابهی دارن، &lt;a href=&quot;http://www.marcuseckert.com/squall/&quot;&gt;Squall&lt;/a&gt; که توسط &lt;a href=&quot;https://twitter.com/marcus_eckert&quot;&gt;Marcus Eckert&lt;/a&gt; توسعه داده شده و &lt;a href=&quot;https://github.com/facebookincubator/Keyframes&quot;&gt;Keyframes&lt;/a&gt; که محصولی از فیسبوکه. لایبرری Keyframes متاسفانه یه بخش کوچیکی از خصوصیات After Effect رو پشتیبانی میکنه و بیشتر روی interactionها تمرکز داره، درصورتی که ممکنه انیمیشن‌های ما خصوصیات خاصی داشته باشن و از ابزارهای پیچیده افترافکت در منابعمون استفاده شده باشه. برعکس Squall، بسیار ابزار خوب و کاملیه و اکثر خصوصیات پیاده شده در افترافکت رو پشتیبانی میکنه. با اینحال، متاسفانه فقط iOS رو پیشتیبانی میکنه. شاید جالب باشه بدونید که برو بچه های Lottie از خصوصیات و الگورتیم های Squall تو سرویسهاشون استفاده کردن، الالخصوص برای تفسیر و خوندن فایل جیسون که از AfterEffect خروجی گرفته شده.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-07-30/oh-my-lottie-6.gif&quot; alt=&quot;Lottie&quot; /&gt;&lt;/p&gt;

&lt;p&gt;علاوه بر اینها، لاتی امکانت دیگه هم داره تا سرویس رو هرچه بیشتر کاربردی کنه. برای مثال، شما میتونید فایلهای JSON رو مستقیما از روی وب فراخونی کنید، که خیلی خیلی خیلی برای A/B Testing مفید و کاربردیه. همینطور که قبلا گفتم شما میتونید کنترل کاملی روی انیمیشنتون داشته باشید، اون رو عقب (Reverse) جلو (Forward) کنید، یا سرعتش رو کم و زیاد کنید، موقع اینترکت با کاربر ظاهرش رو عوض کرده یا افکت‌های خاصی بهش بدید، همه اینها با یه نیم خط کد قابل پیاده‌سازیه.&lt;/p&gt;

&lt;p&gt;موضوع جالبتر میشه وقتی که بدونید شما در iOS میتونید بصورت Native از Lottie برای پیاده سازی ترنزیشن انیمیشن استفاده کنید، اونم انیمیشن‌های پیچیده.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;جامعه توسعه دهنده‌ها&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ازونجای که Lottie یه فریم‌ورک متن‌باز هست، تونسته یه جامعه قوی از طراح‌ها و توسعه‌دهندگان رو دور هم جمع کنه تا اونها با کمک همدیگه، هم بتونن Lottie رو ارتقاع بدن هم کلی ریسورس خوب و با کیفیت تولید کنن. اگه حال کار کردن با افترافکت رو ندارید، یا توی تیمتون گرافیست ماهر برای کار کردن با این ابزار موجود نیست، میتونید از انیمیشن‌های آماده استفاده کنید، اونها در &lt;a href=&quot;http://9-squares.tumblr.com/&quot;&gt;9Squares&lt;/a&gt;، &lt;a href=&quot;https://motioncorpse.tumblr.com/&quot;&gt;Motion Corpse&lt;/a&gt;، &lt;a href=&quot;https://animography.net/products/mobilo&quot;&gt;AnimoGraphy&lt;/a&gt; و &lt;a href=&quot;https://www.lottiefiles.com&quot;&gt;LottieFiles&lt;/a&gt; به راحتی در دسترس شما هستن&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2017-07-30/oh-my-lottie-8.gif&quot; alt=&quot;Lottie&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;خب اینهمه تعریف کردی، حالا چطوری ازش استفاده کنم؟&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;برنامه من اینه که در این هفته جاری نحوه استفاده از Lottie رو در هرسه پلتفرم Android، iOS و ReactNative به شما نشون بدم. پس اگه تاحالا از این فریم‌ورک استفاده نکردین، منتظر پست‌های بعدی تو هفته جاری باشین. یا اگه استفاده کردین و جاییش مشکل یا سوالی دارین، در &lt;a href=&quot;https://twitter.com/intent/tweet?screen_name=sadra_amlashi&quot;&gt;توییتر&lt;/a&gt; من رو &lt;a href=&quot;https://twitter.com/intent/tweet?screen_name=sadra_amlashi&quot;&gt;منشن&lt;/a&gt; کنید و سوالتون رو بپرسید تا در پستهای بعدی ‌به اون موارد رو حتما بررسی کنم.&lt;/p&gt;</content><author><name>صدرا املشی</name></author><category term="Android" /><category term="iOS" /><category term="ReactNative" /><category term="UI" /><category term="Animation" /><category term="Lottie" /><summary type="html">یکی از موضوعاتی که چندوقت اخیر ذهن منو مشغول کرده بود، این بوده که بتونم از منابع گرافیکی و انیمیشن‌های پیچیده در پروژم استفاده کنم. ولی هربار پیگیری این قضیه رو عقب مینداختم. تا اینکه دیروز فرید ازم پرسید آیا برای این قضیه راه حلی دارم؟ و این موضوع بهونه‌ای شد، تا با شایان دنبال یه سرویس خوب بگردیم. امروز قصد ندارم کد‌نویسی کنم و فقط میخوام مورادی که پیدا کردیم رو به شما معرفی کنم.</summary></entry><entry><title type="html">گرفتن نام‌کاربری گیتهابی که توسط فرد دیگری قبلا ثبت شده</title><link href="//isapanah.com/2017/how-getting-useless-github-username" rel="alternate" type="text/html" title="گرفتن نام‌کاربری گیتهابی که توسط فرد دیگری قبلا ثبت شده" /><published>2017-07-26T00:00:00+04:30</published><updated>2017-07-26T00:00:00+04:30</updated><id>//isapanah.com/2017/how-getting-useless-github-username</id><content type="html" xml:base="//isapanah.com/2017/how-getting-useless-github-username">&lt;p&gt;شاید براتون پیش اومده باشه که توی گیتهاب میخواستین یک نام کاربری ثبت کنین، اما این نام‌کاربری قبلا توسط یه نفر دیگه گرفته شده. اوضاع وقتی ضدحالتر میشه که، میبینی طرف فقط اون رو اشغال کرده و تابحال هیچ استفاده‌ای ازش نشده!&lt;/p&gt;

&lt;p&gt;برای من هم این موقعیت پیش اومده! قبلا حساب کاربری من در گیتهاب &lt;strong&gt;amlashi-sadra&lt;/strong&gt; بود، اما با راهنمایی یکی از دوستانم تونستم نام‌کاربری &lt;strong&gt;Sadra&lt;/strong&gt;، که توسط یه نفر دیگه رجیستر شده و البته بلااستفاده بود رو برای خودم ثبت کنم. اما چطوری؟&lt;/p&gt;

&lt;p&gt;بر اساس پستی که در راهنمای گیتهاب چندوقت پیش منتشر شد - &lt;a href=&quot;https://help.github.com/articles/name-squatting-policy/&quot;&gt;Name Squatting Policy&lt;/a&gt; - شما می‌تونید درخواست کنید اون نام‌کاربری بلا استفاده‌ای که اشغال شده رو تحویل شما بدن.&lt;/p&gt;

&lt;p&gt;برای اینکه یوزر Sadra رو بگیرم به &lt;a href=&quot;https://github.com/contact&quot;&gt;صفحه تماس&lt;/a&gt; گیتهاب رفتم و براشون نوشتم که من تو اکثر صفحه های اجتماعی این با این شناسه شناخته میشم و این نام‌کاربری از موقعی که اشغال شده هیچ فعالیتی نداشته و هزارتا بهوونه دیگه که بتونم نشون بدم من بیشتر استحقاق این دامنه رو دارم.&lt;/p&gt;

&lt;p&gt;بیشتر از ۱۵ دقیقه از پیام من نگذشته بود که برام این پاسخ رو فرستادن:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Hi Sadra,&lt;/p&gt;

  &lt;p&gt;You are in luck — we have classified the sadra account as inactive and released the username for you to claim, as per our Name Squatting Policy:&lt;/p&gt;

  &lt;p&gt;https://help.github.com/articles/name-squatting-policy&lt;/p&gt;

  &lt;p&gt;Be quick, as the username is now publicly available. Glad to help!&lt;/p&gt;

  &lt;p&gt;Thanks,&lt;/p&gt;

  &lt;p&gt;Jacqui&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;بله، اون حساب کاربری رو آزاد کرده بودن و منم سریع رفتم و بر اساس راهنمای &lt;a href=&quot;https://help.github.com/articles/changing-your-github-username/&quot;&gt;Change your GitHub Username&lt;/a&gt; ، حساب کاربریم رو به یوزر Sadra تغییر دادم.&lt;/p&gt;

&lt;p&gt;حرف آخر، مطابق راهنمای&lt;a href=&quot;What happens when I change my username&quot;&gt; What happens when I change my username &lt;/a&gt;توجه کنید که اگر نام کاربریتون رو تغییر بدین، پروژه‌های که تعریف کرده بودین به آدرس جدید ریدایرکت نمیشن. پس یادتون باشه بعد تغییر نام‌کاربری، حتما لینکهایی که قبلا به پروژتون داده بودید (مثل وبلاگ یا اگر لایبرری ریلیز شده) رو هم اصلاح کنید.&lt;/p&gt;</content><author><name>صدرا املشی</name></author><category term="Github" /><category term="گیتهاب" /><summary type="html">شاید براتون پیش اومده باشه که توی گیتهاب میخواستین یک نام کاربری ثبت کنین، اما این نام‌کاربری قبلا توسط یه نفر دیگه گرفته شده. اوضاع وقتی ضدحالتر میشه که، میبینی طرف فقط اون رو اشغال کرده و تابحال هیچ استفاده‌ای ازش نشده!</summary></entry><entry><title type="html">برنامه نویسی ۲ نفره</title><link href="//isapanah.com/2016/pair-programing" rel="alternate" type="text/html" title="برنامه نویسی ۲ نفره" /><published>2016-08-29T00:00:00+04:30</published><updated>2016-08-29T00:00:00+04:30</updated><id>//isapanah.com/2016/pair-programing</id><content type="html" xml:base="//isapanah.com/2016/pair-programing">&lt;p&gt;در این پست قصد دارم درباره Pair Programming يا برنامه نویسی ۲نفره (جفتی) صحبت کنم. اگر میدونید برنامه نویسی ۲نفره چیه لازم نیست پارگراف بعدی رو بخونید:&lt;/p&gt;

&lt;p&gt;یکی از مواردی که در مدل XP (یکی از متدهاي اجایل) به وضوح مشاهده می شود، مفهومی است تحت عنوان Pair Programming. منظور از این اصطلاح این است که دو برنامه نویس در کنار یکدیگر شروع به کار کردن می کنند. یکی کدنویسی می‌کند و دیگری به کدهای همکارش نگاه می‌کند و در صورتی که نظری در مورد بهتر شدن کد داشت، به همکارش اعلام می کند. (&lt;a href=&quot;https://www.sokanacademy.com/categories/programming/coding/tutorials/457/%D8%A2%D8%B4%D9%86%D8%A7%DB%8C%DB%8C-%D8%A8%D8%A7-%D9%85%D8%AF%D9%84-%D9%87%D8%A7%DB%8C-%D8%A7%D8%AC%D8%A7%DB%8C%D9%84&quot;&gt;سکان آکادمی&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2016-8-29/1-intro.jpg&quot; alt=&quot;Intro&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;چرا-کد-نویسی-دو-نفره&quot;&gt;چرا کد نویسی دو نفره؟&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;اشتراک گذاری دانش:&lt;/strong&gt; وقتی که باهم روی یه کد کار میکنید اشتباه احتمالیتون رو پیدا کرده و یاد می‌گیرید که دیگه اون اشتباه رو تکرار نکنید، این قضیه میتونه برعکس باشه و شما به دوستون یادآور بشید که فلان جای کدش اشتباست و درستش چیه. وقتی که دو نفری کد میزنید نسبت به وقتی که تنهایی کار می‌کنید، بهتر میتونید بفهمید که چی دارید مینویسید و یا چیکار دارید می‌کنید (چون دائما هی از هم میپرسید چرا؟ چرا باید اینکارو بکنم؟ مثلا وقتی بحث میکنید سر اینکه چرا بجای حلقه For باید از While استفاده کنید).&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;یه مقدمه خوب:&lt;/strong&gt; دو نفری کد زدن برای کسانی که تازه استخدام شدن یا تازه از دانشگاه (مثلا رشته برنامه نویسی) فارغ التحصیل شدن میتونه یه نمونه خوب و تمرینی باشه تا نحوه کد زدن صحیح و تفکر برنامه نویسی رو یاد بگیرن. این یه راه خیلی خوبیه تا بتونید اعضای تیمتون رو بهتر بشناسید (با تواناییهاشون آشنا بشید)، بفهمید که استایل کد زدنشون چطوره و ازتون انتظار داره که چطور باهم کار کنید و کد بزنید. برنامه نویسی دو نفری بهتون کمک میکنه تا افراد تیم رو بهتر بشناسید در نتیجه میدونید اگه يك روز به یه مشکل خاص برخوردید به کدوم یک از اعضای تیم باید مراجعه کنید و مشکلتون رو درمیون بگذارید تا حل بشه.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;متمرکز شدن موقع کد نویسی:&lt;/strong&gt; خیلی از ماها در کنار کد زدنمون با صدای ناتیفیکیشن پیام دوستامون تو شبکه های اجتماعی حواسمون پرت میشه و سریع میریم ببینیم کی چی پیام داده (مثلا تلگرام، فیسبوم، توییتر و …)، اما وقتی یکی کنارتون باشه و قرار باشه دو نفری کد بزنید اونوقته که دیگه خجالت می‌کشید و تمام تمرکزتون رو در اون زمان روی کد زدنتون میگذارید ( محاله که دیگه توییترو باز کنی ? )!&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;کد های بهتر و اصولی تر:&lt;/strong&gt; قائدتا موقعی که دو نفری کد میزنید (نسبت به تک نفری) سرعت کمتری دارید اما حتما کدها تمیزتر و اصولی تر بوده، همچنین با باگ یا خطای کمتری روبرو خواهید شد. (البته تحقیق مستندی در این باره صورت نگرفته که بخوام بهتون اثباتش کنم، اما شخصا فکر می‌کنم این حرف صادق باشه. نظر خودتون چیه؟ ? )&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;این موارد و فوایدی که درباره دونفری کد زدن گفتم شبیه فواید CodeReview نیست؟&lt;/strong&gt; (اگه دوس داری بدونی &lt;a href=&quot;https://en.wikipedia.org/wiki/Code_review&quot;&gt;Code Review&lt;/a&gt; چیه از &lt;a href=&quot;https://en.wikipedia.org/wiki/Code_review&quot;&gt;ویکی پدیا&lt;/a&gt; توضیحاتش رو بخون). اگرچه که دو نفری کد زدن خیلی فواید بیشتری بجای CodeReview داره: درواقع شما در لحظه کدهارو بازخوانی (CodeReview) میکنی.&lt;/p&gt;

&lt;h2 id=&quot;واو-اینکه-خیلی-عالیه-اما-چطوری-میتونم-شروع-کنم&quot;&gt;واو اینکه خیلی عالیه! اما چطوری میتونم شروع کنم؟&lt;/h2&gt;

&lt;p&gt;در این مقاله سعی كردم راجع به فرهنگ کد زدن دو نفره صحبت کنم، در جامعه ای که برنامه نویسی دو نفره خیلی کمه (البته اگه اصلا وجود داشته باشه!). پیشنهاد و بحث هایی که در این مقاله میشه ممکنه برای کساني که همین الان دارن دو نفری کد میزنن کمی عجیب و غریب باشه. البته من امیدوارم که این مقاله یه دید مثبت به شما بده در نتیجه ترغیب کنه شمارو که رو بیارید به برنامه نویسی دونفره. بعد از این شما می‌تونید برید تحقیق کنید، مقاله های بیشتری بخونید، حتی راجع بهش مقاله بنویسید، تیم خودتون رو تشکیل داده و این فرهنگ رو گسترش بدید.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;با کی باید جفت بشم؟&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;با کسی که میخواد یا تمایل داره با شما جفت بشه! کسی که تمایل داره در کنار شما کد نویسی کنه بهتر از کسی هست که “بهترین همسان” برای دونفره کد زدنه.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;اگه برای اولین باره، ابتدا در کنار تعدادی برنامه نویس (کمتر از ۵ تا) بنشینید و دو نفره کد زدن رو تجربه کنید تا بفهمید اصلا ۲نفری کد زدن با روحیات شما سازگاره و میتونید اون رو قبول کنید؟&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt; خیلی از مردم دوست ندارن شما وقتتون رو سر نگاه کردن به کد های پروژه اونها (در فکر خودشون) هدر بدید! اگه واسه اونها سخته که (یا تمایل ندارن) بیان سراغ کد های شما، این به دور از ادب هست که شما هم سراغ کدهای اونها رفته و بخوایید که دونفره برنامه نویسی کنید.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;در اولین دفعات اول شما به سراغ دوستتون رفته، و در بازخوانی یا Review کدها بهش کمک کنید. این امر باعث میشه اون هم رغبت پیدا کنه و بیاد پیش شما و وقتش رو روی پروژه شما بزاره.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;خیلی از مردم دوست ندارن دو نفره کد بنویسین (یکی کنارشون بشینه و مثلا کدهاشونو تماشا کنه!)، خودتونو آماده کنید که با تواضع جواب “نه” اونهارو بپذیرید.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;چطوری باید جفتمو پیدا کنم؟&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;با__درخواست مستقیم__ شروع کنید (مثلا: سعید میای کنارم بشینی و باهم روی این پروژه کار کنیم؟). موفق نشدید؟ خوب اشکالی نداره. یه تقویم آماده کنید و زمان و تاریخ هایی که دوست دارین در اون تایم بصورت دو نفری رو پروژه خاص کار کنید رو مشخص کرده و برای اونها بفرستید. (مردم وقتی ببینن شما چقدر مصمم هستید و برای کارهاتون برنامه و زمان بندی مشخص دارید تمایل پیدا میکنن که باهاتون همکاری کنن).&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;این دعوت نامه تقویمی رو برای همه اعضای تیم بفرستید. سعی کنید یه سری برنامه منظم برای یادگیری، آموزش و درگیر کردن اونها با پروژه های برنامه نویسی جفتی تهیه و تدارک ببینید.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2016-8-29/2-finally-ill-find-you.jpg&quot; alt=&quot;Finally I Found You&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;چه مدت باید جفتی کار کنم؟&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;بعضی ها ۹۰ دقیقه رو مناسب میدونن، بعضی ها هم هستن که کل روز رو جفتی کار می‌کنن، این کار باید هرروز تا تموم شدن یک اسپرینت (دوره های ۲ تا ۴ هفته ای برای اتمام یک فاز از پروژه در مدل اسکرام از متد اجایل – &lt;a href=&quot;https://en.wikipedia.org/wiki/Scrum_(software_development)#Sprint_Backlog&quot;&gt;اطلاعات بیشتر&lt;/a&gt; ) انجام بشه. البته در تحقیقات انجام شده مشخص شده دوره های زمانی کوتاه تر نتیجه بهتری در برنامه نویسی جفتی می‌گیریند (Article: &lt;a href=&quot;http://csis.pace.edu/~grossman/dcs/XR4-PromiscuousPairing.pdf&quot;&gt;Promiscuous Pairing&lt;/a&gt;). البته حتما با دوستتون مشورت کنید و ببینید که اون چقدر میتونه یا تمایل داره که در روز با شما وقت بگذاره و باهم برنامه نویسی کنید!&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;سعی کنید برنامه تون رو بصورت دوره های ۱.۵ تا ۲ ساعته طراحی کنید.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2016-8-29/3-how-long-pair-programming.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;چند بار میتونم جفتی کار کنم؟&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;این یه موضوعه بین شما، جفت برنامه نویستون و تیمی که توش کار می‌کنید؛ فقط مطمئن بشید همتون باهم سر این موضوع موافقید.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;اگر ممکن بود، سعی کنید با دونفر (مختلف) در طول هفته کار کنید. این به شما کمک می‌کنه تا حس کنید که کار کردن با آدمهای مختلف چطوریه و چطور میتونید خودتون رو با اونها وفق بدید.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;strong&gt;خب، حالا باید چیکار کنم؟&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;دو تا واژه خیلی مهم&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;کد زن (Driver) :&lt;/strong&gt; کدهارو می‌نویسه، طرح کلی از برنامه تو ذهنشه، در باره کدها دید جزئی (Micro) داره.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;راهنما (Navigator) :&lt;/strong&gt; توی کد ها به دنبال مشکلات منطقی، باگ احتمالی و یا پیاده سازی بهتر می‌گرده،‌ مانند یه ناظر حرفه ای عمل میکنه، و از قبل به مشکلات بلقوه که ممکنه پیش بیاد فکر می‌کنه؛ در ضمن، به کد ها یه دید کلی (Macro) داره.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2016-8-29/4-pairing-vocab.jpg&quot; alt=&quot;Pairing Vocab&quot; /&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;راهنما کارش مثل کسیه که کدهارو بازبینی میکنه، درواقع یه Code Reviewer، اون دائما به یه راه حل یا روش بهتر توی نوشتن کدها فکر میکنه.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;انواع-برنامه-نویسی-دو-نفره&quot;&gt;انواع برنامه نویسی دو نفره:&lt;/h2&gt;

&lt;p&gt;اصطلاح‌هایی که در زیر میاد کاملا اختراع و ایده خودمه و اصلا ربطی به واژه های رسمی (برنامه نویسی دو نفره) نداره، فقط واسه اینه که یه دید بهتر بهتون بده.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;کلاسیک:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2016-8-29/5-classic.jpg&quot; alt=&quot;Classic&quot; /&gt;&lt;/p&gt;

&lt;p&gt;یه ماوس و کیبورد اضافی روی میز باشه که بتونید در لحظه نقش‌هاتون رو باهم عوض کنید، مثلا راهنما بشه کدزن و کدزن بشه راهنما. معمولا در هر ۱۵ دقیقه تا یکساعت حداقل یکبار این اتفاق میفته و مجبور میشید نقش‌هارو رو بهم پاس بدید؛ البته این مورد برای کسایی که تازه کارن حتی به دفعات بیشتر هم میرسه!&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;فواید: کمکتون میکنه تا باهم هماهنگ شده، باهم کار کنید و پیش برید&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;معایب: ممکنه روی میز فضای کافی برای گذاشتن یه کیبورد و ماوس اضافی نباشه&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;تیمی که من باهاشون کار می‌کنم اخیرا یه میز بزرگ واسه برنامه نویسی دو نفره تعیین کردن که دو تا کیبور، ماوس و مانیتور داره – هرموقع که اراده کنن در کثری از ثانیه نقش‌هاشون عوض میشه.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;کند:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;کارشون مثل همون بالاییه، فقط دیگه ماوس و کیبور اضافی در کار نیست!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2016-8-29/6-the-lazy.jpg&quot; alt=&quot;The Lazy&quot; /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;فواید: دیگه نمیتونین پوینتر ماوس همدیگه رو بدزدین و هی با کدا ور برین وسط کد زدن بقلی ؟ ، بدون هیچ دردسر و ابزار اضافه ای شروع به برنامه نویسی اشتراکی (دو نفره) میکنید (هر لحظه که اراده کردین ).&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;معایب: مجبورین دستتون رو درااااز کنید و اون نقطه از کد که مشکل داره رو نشون دوستتون بدین ( دهنت سرویس میشه ).&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;تازه کارانه:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;همزمان “راهنما” هم باشید.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2016-8-29/7-the-noob.jpg&quot; alt=&quot;The Noob&quot; /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;فواید: دیگه پر از استرس و نگرانی نخواهید بود،‌ فرصت بیشتری برای سوال پرسیدن دارید&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;معایب: این روش هیچوقت رضایت بخش نیست، و شما خیلی سخت می‌تونید روی کد زدن تمرکز کنید&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;من عاشق تازه کارام. این فرصت رو پیش میاره تا بتونید از راهنما سوال بپرسید، یاد بگیرین که تیم چطوری فکر و کار میکنه، و اینکه بفهمید جفتتون “راهنما” توی چه بخشی خیلی خوبه. این واسه تازه کارهایی مثل من وااااقعا یه فرصت عالیه.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;پریشانانه:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2016-8-29/8-the-distracted.jpg&quot; alt=&quot;The Distracted&quot; /&gt;&lt;/p&gt;

&lt;p&gt;مثل همون روش قبلی (تازه کارانه)، با این تفاوت که شما لپتابتونم میارین. اکثر زمان لپتاپاتون رو خیلی نزدیک بهم نگه می‌دارید و ازش برای بررسی کردن سینتسک، مترجم گوگل و یا حل و فصل یه مبحث استفاده می‌کنید. هیچ وقت بقل دستتیتون بیشتر از چند دقیقه معطل نکنید.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;فواید: میتونید خیلی راحت دنبال یه چیزی بگردین و پیداش کنید&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;معایب: خیلی راحت تمرکزتون از بین میره&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;مثل “تازه کارانه” شروع کنید به کار کردن، اما وقتی که احتیاج داشتید دنبال یه چیزی بگردین برید استراتژیتون رو به “پریشانانه” تغییر بدین. یه جورایی این مثل همون حالت کلاسیکه.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;strong&gt;آیا مورد یا چیز دیگه ای هست که باید بدونم؟&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;بهداشت فردیتون رو رعایت کنید!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2016-8-29/9-hygiene.jpg&quot; alt=&quot;Hygiene&quot; /&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;حتما دوش بگیرید، ادکلن خوشبو بزنید، مسواک کنید، خوشبو کننده دهان بخورید و حتما شب قبلش از خوردن پیاز و سیر خودداری کنید.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;strong&gt;باهم رفیق و شریک باشید&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2016-8-29/10-welcoming-pairing.png&quot; alt=&quot;Welcoming Pairing&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;من-اینکارو-شروع-کردم-و-عاشقش-شدمازش-متنفرم&quot;&gt;من اینکارو شروع کردم و عاشقش شدم/ازش متنفرم!&lt;/h2&gt;

&lt;p&gt;بعله! بجای تشکر از من این روش رو تست کنید. خیلی خوشحال می‌شم اگه بدونم شما چه تجربه ای از برنامه نویسی دو نفره داشتید.&lt;/p&gt;

&lt;p&gt;اگه شما ازش متنفر بودین، من واقعا متاسفم. برنامه نویسی دو نفره رو با فرد دیگه ای هم تست کردین؟ اگه نه، سعی کنید با چند نفر دیگه هم این روش رو تجربه کنید. خیلی ها اینجوری کار کردن رو دوست ندارن، اما فکر کنم شما واسه یه بارم که شده باید این روش کار کردن رو تجربه کنید.&lt;/p&gt;

&lt;div class=&quot;div-ltr&quot;&gt;

  &lt;p&gt;Translated from: &lt;a href=&quot;https://developer.atlassian.com/blog/2015/05/try-pair-programming/&quot;&gt;developer.atlassian.com&lt;/a&gt;&lt;/p&gt;

&lt;/div&gt;</content><author><name>صدرا املشی</name></author><category term="مقاله" /><category term="اسکرام" /><category term="اجایل" /><category term="مدیریت پروژه نرم‌افزاری" /><summary type="html">در این پست قصد دارم درباره Pair Programming يا برنامه نویسی ۲نفره (جفتی) صحبت کنم. اگر میدونید برنامه نویسی ۲نفره چیه لازم نیست پارگراف بعدی رو بخونید:</summary></entry><entry><title type="html">اینترنت اشیا، به سبک گیتار Sensus</title><link href="//isapanah.com/2016/sensus-iot-electronic-guitar" rel="alternate" type="text/html" title="اینترنت اشیا، به سبک گیتار Sensus" /><published>2016-08-29T00:00:00+04:30</published><updated>2016-08-29T00:00:00+04:30</updated><id>//isapanah.com/2016/sensus-iot-electronic-guitar</id><content type="html" xml:base="//isapanah.com/2016/sensus-iot-electronic-guitar">&lt;p&gt;یخچال هوشمند، فِر هوشمند، لامپ هوشمند، حتی قفل هوشمند و.. و… و..، مطمئنا اینا واژه هایی هستن که تو یک یا نهایت دو سال اخیر بارها شنیده ایم و البته در سالهای آینده بیشتر خواهیم شنید. همه دستگاه هایی که نام بردم یا چیزهای دیگه‌ای که خودتون شنیدید در دسته ای به نام اینترنت اشیا یا بطور مخفف IOT قرار میگیرند( البته خیلی ها از دوستان لطف دارن و میگن اینترنت اشیا نه! اینترنت چیزها! بعضی از دوستان هم که خسته ان میگن چیزنت! ) اما واقعا اینترنت اشیا چیه و چه تعریفی داره. بهتره برای روشن شدن ماجرا از ویکی‌پدیا کمک بگیرییم:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;اینترنت چیزها، یا چیزنت (به انگلیسی: Internet of Things) (یا IOT به اختصار) که گاهی در زبان انگلیسی اینترنت اشیا(Internet of Objects) هم برای این کلمه استفاده می شود، به طور کلی اشاره دارد به بسیاری از چیزها شامل اشیا و وسایل محیط پیرامون‌مان که به شبکه اینترنت متصل شده و بتوان توسط اپلیکیشن‌های موجود در تلفن‌های هوشمند و تبلت کنترل و مدیریت شوند. (&lt;a href=&quot;https://fa.wikipedia.org/wiki/%D8%A7%DB%8C%D9%86%D8%AA%D8%B1%D9%86%D8%AA_%D8%A7%D8%B4%DB%8C%D8%A7&quot;&gt;اینترنت اشیا در ویکیپدیا&lt;/a&gt;)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;اما نمیخوام درمورد اینترنت اشیا صبحت کنم، یا اینکه واقعا IOT چیه باهم بحث کنیم، کافیه خودتو این کلمه رو گوگل کنید تا هزاران هزار لینک، مقاله، ویدئو و .. بهتون پیشنهاد بشه!&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;چیزی که امروز من رو به وجد آورده تا با شما به اشتراک بگذارم، یه گیتاره! گیتار الکتریک.اما قبلش:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ایده پیدایش گیتار ازونجا شروع شد که در همنوازی ها، در مقابل سازهایی مثل &lt;a href=&quot;https://en.wikipedia.org/wiki/Bass_(instrument)&quot;&gt;بیس&lt;/a&gt; و &lt;a href=&quot;https://en.wikipedia.org/wiki/Drum_kit&quot;&gt;درامرز&lt;/a&gt;، صدای &lt;a href=&quot;https://fa.wikipedia.org/wiki/%DA%AF%DB%8C%D8%AA%D8%A7%D8%B1&quot;&gt;گیتار آکوستیک&lt;/a&gt; به خوبی شنیده نمیشد. در نتیجه موسیقی دانها برای حل این مشکل دست به‌-دامن علم الکترونیک شدن. در دهه ۳۰ بود که گیتار الکتریک وارد دنیای موسیقی شد. این یه انقلاب در صدا و تکنولوژی بود و تا هنوز هم ادامه داره. در دهه ۵۰ و با پیدایش &lt;a href=&quot;https://fa.wikipedia.org/wiki/%D8%B1%D8%A7%DA%A9_%D8%A7%D9%86%D8%AF_%D8%B1%D9%88%D9%84&quot;&gt;راک اند رول&lt;/a&gt;، گیتار های الکتریک با سرعت هرچه بیشتر جاشون رو در موسیقی باز کردن و به یکی از فراگیرترین ابزارهای موسیقی تبدیل شدن.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2016-12-30/1-guitar-timeline.jpg&quot; alt=&quot;Electronic Guitar Timeline&quot; /&gt;&lt;/p&gt;

&lt;p&gt;اگه دوست دارید بیشتر راجع به گیتار الکتریک بدونید از شما دعوت میکنم تا به صفحه &lt;a href=&quot;https://en.wikipedia.org/wiki/Electric_guitar&quot;&gt;گیتار الکتریک در ویکیپدیا&lt;/a&gt; مراجعه کنید. همانطور که در گیتار آکوستیک صدا به شدت به بدنه و جریان ارتعشات سیمها در داخلش بستگی داره، در گیتار الکتریک این مسئله به سیگنال هایی که از پیکاپ‌ها منتقل میشه بستگی داره (راجع به پیکاپ بیشتر بدانید: &lt;a href=&quot;https://en.wikipedia.org/wiki/Electric_guitar#Pickups&quot;&gt;لینک۱&lt;/a&gt; – &lt;a href=&quot;https://fa.wikipedia.org/wiki/%D9%BE%DB%8C%DA%A9%D8%A7%D9%BE&quot;&gt;لینک ۲&lt;/a&gt; و مفصل تر در &lt;a href=&quot;http://www.electricguitar.blogfa.com/post/6&quot;&gt;لینک ۳&lt;/a&gt;). میشه به این سیگنال ها توسط ابزاری که بهش اِفکت مگیم، &lt;a href=&quot;https://fa.wikipedia.org/wiki/%D8%AA%D9%85%D8%A8%D8%B1_(%D9%85%D9%88%D8%B3%DB%8C%D9%82%DB%8C)&quot;&gt;طنین&lt;/a&gt; یا در اصطلاح حرفه‌ای &lt;a href=&quot;https://fa.wikipedia.org/wiki/%D8%AA%D9%85%D8%A8%D8%B1_(%D9%85%D9%88%D8%B3%DB%8C%D9%82%DB%8C)&quot;&gt;تِیمبر&lt;/a&gt; داد و سپس اون رو به اَمپلیفایر منتقل کرد. بسیاری از گیتار های امروزی بصورت Built-in ابزاری جهت افکت و تیمبر کردن دارن، اما برای ایجاد بسامد و طیف های گسترده از افکت های مختلف و دیجیتالی اکسترنال یا پدالی استفاده میشه.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2016-12-30/2-guitar-tools.jpg&quot; alt=&quot;Electronic Guitar Timeline&quot; /&gt;&lt;/p&gt;

&lt;p&gt;امیدوارم اگر هم تاحالا با گیتار الکتریک آشنایی نداشتید، تا همینجا هم اطلاعات خوبی نصیبتون شده باشه. و اما از هرچه بگذریم، سخن یار خوشتر است .&lt;/p&gt;

&lt;p&gt;گیتار Sensus اولین گیتار هوشمند دنیاست. میشه باهاش مثل گیتار آکوستیک زد؟ یا یه گیتار الکتیریکه؟ میشه به عنوان گیتار بیس ازش استفاده کرد؟ حتی سیتی سایزر هم هست!!؟ باید به همه سوالهای که پرسیدین جواب بله! رو بدم. بله، گیتار هوشمند Sensus اجازه میده تا شما از مدولاسیون بینهایت بهره ببرین و بین گیتار آکوستیک و الکتریک سوییچ کنین، حتی میتونید افکت های سیتی‌سایزر رو باهاش پیاده کنین! میتونین باهاش رقص نور رو کنترل کنید! واسه گیتاریست های الکتریک (احتمالا مثل شما) میتونه هیجان انگیز باشه که وقتی بفهمید با Snesus میتونید از Spotify موزیک استریم کنین و با اون همنوازی کنین. تاز قراره در ادامه جالبترم هم بشه! این گیتار بدون هیچ اکسسوری مثل کامپیوتر یا اسپیکر کار میکنه. حتی بدون سیم! گیتار هوشمند Sensus به عبارتی دقیقتر توانایی های مارو در موزیک افزایش داده، بزارین راحت‌تر بگم، باید منتظر انقلابی که Seunsus خواهد آفرید باشیم.&lt;/p&gt;

&lt;div class=&quot;video-container&quot;&gt;&lt;style&gt;.h_iframe-aparat_embed_frame{position:relative;} .h_iframe-aparat_embed_frame .ratio {display:block;width:100%;height:auto;} .h_iframe-aparat_embed_frame iframe {position:absolute;top:0;left:0;width:100%; height:100%;}&lt;/style&gt;&lt;div class=&quot;h_iframe-aparat_embed_frame&quot;&gt; &lt;span style=&quot;display: block;padding-top: 57%&quot;&gt;&lt;/span&gt;&lt;iframe src=&quot;https://www.aparat.com/video/video/embed/videohash/GoLQc/vt/frame&quot; allowfullscreen=&quot;true&quot; webkitallowfullscreen=&quot;true&quot; mozallowfullscreen=&quot;true&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;گیتار هوشمند Sensus برای اولین بار در ۳ نوامبر ۲۰۱۵ در یک نمایش زنده در کنفرانس Web Summit Dubin توسط یک استارتاپ سوئدی-ایتالیایی به نام &lt;a href=&quot;http://www.mindmusiclabs.com/&quot;&gt;MIND Music Labs&lt;/a&gt; رونمایی شد. و در &lt;a href=&quot;https://en.wikipedia.org/wiki/Angel_investor&quot;&gt;همانجا از سوی فرشتگان کسب&lt;/a&gt; و کار مثل Jscob Key مدیر دیجیتال در شرکت Warner Music، سپس Per Briliton مدیر کمپانی Ludvig Linge و همچنین آقای Marcelo Benitez از Proaltus Capital سرمایه گذاری شد و حمایت شد. چیزی نزدیک به نیم میلیون دلار.&lt;/p&gt;

&lt;p&gt;Sensus برای نوازندگانی که بیش از ۵۰ دهه منتظر همچنین چیزی بودن، حد نهایت تکامل یک ابزار موسیقی به حساب میاد، و این تکنولوژی بود که توسط تیم منحصر بفرد MIND پیاده سازی شد، بقول Michele Benincaso موسس و مدیر MIND: “سنسُس ترکیبی از گیتار آکوستیک سنتی و پیشرفته ترین تکنولوژی‌هاست”&lt;/p&gt;

&lt;p&gt;بنیان‌گذار و ایده پرداز این گیتار &lt;a href=&quot;http://www.benincaso.com/&quot;&gt;Michele Benincaso&lt;/a&gt; ست که در مدرسه Cremona’s Antonio Stradivari Luthiery ایتالیا تحصیل موسیقی کرده. از دهه ۶۰ به بعد همگام با رشد و انقلاب در صنایع الکترونیک و کامپیوتر، صنعت موسیقی و خود موزیسین ها نیز دچار تحول شدن. همونطور که Stradivari در صده ۱۶ و فندر (&lt;a href=&quot;https://en.wikipedia.org/wiki/Fender_Musical_Instruments_Corporation&quot;&gt;Fender&lt;/a&gt; یکی از معتبر ترین شرکت ها در طراحی و تولید گیتار الکتریکی است) در دهه ۶۰ در موسیقی انقلابی به پا کردن، میشل بنینکاسو نیز با استفاده از آخرین تکنولوژی های موجود سعی کرد به نیاز های موزیسین ها پاسخ بده تا با استفاده از اون بتونن صداهای جدید خلق کنند، با روشهای جدید خودشون رو مطرح کرده در نتیجه بتونن مخاطبین بیشتری جذب کنن.&lt;/p&gt;

&lt;p&gt;گیتار Sensus با صدای 360 درجه، و سیستم موزیک وایرلس و امکان استفاده به عنوان یک واحد IOT میتونه امکانت محشر و بدون محدودیتی به موزیسین ها برای ساخت موزیک و افکت های بینظیر بده. شما میتونید همه اینکارهارو بطور طبیعی و بدون نیاز به ابزارهایی مثل امپ و افکت که در بالاتر هم ذکر کردم انجام بدید، چون همه چیزهایی که شما لازم دارین،‌ در داخل گیتار تعبیه شده. تمامی این امکانات بطور بلادرنگ انجام میشه و شما میتونید بلافاصله اونهارو به اشتراک بگذارید. گیتار Sensus با استفاده از سنسورهایی که طراحی کرده (مثل سنسور شتابسنج و سنوسور های لیزری) میتونه یه حلقه یا Loop بینهایت برای اون ملودی که زدید ایجاد کنه.&lt;/p&gt;

&lt;p&gt;به لطف فناوری MIND، تمامی صداهای HD تولید شده بطور مستقیم توسط بدنه چوبی همین گیتار تولید می‌شن. همون بدنه چوبی که با اتکا به اصول آکوستیک طراحی و از همون چوبی که برای ساخت ویالون مشهور &lt;a href=&quot;https://en.wikipedia.org/wiki/Stradivarius&quot;&gt;Stradivari&lt;/a&gt; ساخته شده. بدنه ای از چوب قرمزِ روشنِ کریستالیِ صنوبر.&lt;/p&gt;

&lt;div class=&quot;video-container&quot;&gt;&lt;style&gt;.h_iframe-aparat_embed_frame{position:relative;} .h_iframe-aparat_embed_frame .ratio {display:block;width:100%;height:auto;} .h_iframe-aparat_embed_frame iframe {position:absolute;top:0;left:0;width:100%; height:100%;}&lt;/style&gt;&lt;div class=&quot;h_iframe-aparat_embed_frame&quot;&gt; &lt;span style=&quot;display: block;padding-top: 57%&quot;&gt;&lt;/span&gt;&lt;iframe src=&quot;https://www.aparat.com/video/video/embed/videohash/i2Shl/vt/frame&quot; allowfullscreen=&quot;true&quot; webkitallowfullscreen=&quot;true&quot; mozallowfullscreen=&quot;true&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;گیتار هوشمند Senus رو واقعا میشه یک دستگاه تمام IOT به حساب آورد. با بکارگیری هوشمندانه سنسورهای حساس و به پشتیبانی از یک مغز دیجیتالی، میتونه در لحظه اطلاعات مورد نیاز رو دریافت، پردازش و سپس اون رو به اشتراک بگذاره. این گیتار ۱۰۰٪ اینترنت بیس هست، Sensus میتونه ملودی های ضبط شده رو پخش یا از پلتفرم مورد نظر شما استریم کنه، و صدالبته آثار شمارو با کیفیت HD روی شبکه های اجتماعی منتشر کنه. شما میتونید با استفاده از Spotify موزیک مورد نظرتون رو استریم کنید، شگفت انگیزه اگه بدونید که شما حتی میتونید با دوستی که خیلی خیلی خیلی از شما دوره، با استفاده از اینترنت بهم متصل بشید و باهم همنوازی کنید، و از اون جالبتر، بعد از اینکه موزیکتون رو نواختید، اون رو روی شبکه های اجتماعی مثل فیسبوک و ساندکلاود به اشتراک بزارید.&lt;/p&gt;

&lt;p&gt;همه چیز مهییجتر میشه وقتی بفهمید که اون میتونه با بقیه ابزارهایی که مجهز به سرویس IOT باشه ارتباط برقرار کنه، اونوقته که باید نشست و شنید و دید که این ابزارها چه کارهایی که به کمک هم نمیکنن! برای همینه که میگم این گیتار یک انقلاب در صنعت موسیقیه.&lt;/p&gt;

&lt;p&gt;میشل، با کمک یک تیم روییای از محقیقین و هنرمندان کاربلد تونست به این هدف خودش جامه عمل بپوشونه. نسخه هایی مدرن از صنعتگرانی مانند استاد Stradivari و پدر گیتار الکتریک (آنطور که ما میشناسیمش) آقای &lt;a href=&quot;https://en.wikipedia.org/wiki/Leo_Fender&quot;&gt;Leo Fender&lt;/a&gt;. در میان این تیم میتوانیم از پروفسور Carlo Fischione که یکی از محقیقن برجسته جهان در فن آوری IOT نام ببریم، فردی که کسوت استادی در هردو دانشگاه MIT و Harvard رو تجربه کرده، که ایشان مغز متفکر و طراح سرویس های اینترنت بیس در این گیتار بودند. همچنین دکتر Luca Truchet، مدیر بخش موسیقی در این تیم و متخصص تعامل موسیقی الکترونیک و انسان-کامپیوتری (روجوع شود به &lt;a href=&quot;https://en.wikipedia.org/wiki/Human_computer&quot;&gt;این مقاله&lt;/a&gt;). و در نهایت دکتر Stefano Zambon، متخصص طراحی صدا با استفاده از ابزارهای موسیقی دیجیتال هستند. برای آشنایی با دیگر اعضای به این &lt;a href=&quot;http://www.mindmusiclabs.com/team/&quot;&gt;لینک&lt;/a&gt; مراجعه کنید.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2016-12-30/3-sensus.jpg&quot; alt=&quot;Electronic Guitar Timeline&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2016-12-30/4-sensus.jpg&quot; alt=&quot;Electronic Guitar Timeline&quot; /&gt;&lt;/p&gt;

&lt;p&gt;شاید براتون این سوال پیش اومده خب! من عاشق این گیتار شدم! قیمتش چقدره و از کجا میتونم بخرمش؟ متاسفانه هنوز از قیمت دقیق و حتی تقریبی و زمان انتشار این محصول به بازار اطلاعی در دسترسی نیست. من ایمیل به تیم MIND ارسال کردم و در این باره ازشون پرسیدم. اما تا زمان نگارش این مطلب، هنوز پاسخی داده نشده. درصورتی که اطلاعای ازین بابت بدستم برسه حتما این پست رو آپدیت خواهم کرد.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post/2016-12-30/5-sensus.jpg&quot; alt=&quot;Electronic Guitar Timeline&quot; /&gt;&lt;/p&gt;

&lt;p&gt;مقاله های زیر رو هم جالب دیدم، اگه دوس داشتین میتونید مطالعه کنید:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;http://umgasmagazine.com/swedish-made-sensus-making-guitars-smart/&quot;&gt;Swedish-made SENSUS: making guitars ‘smart’&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;http://www.gitarist.nl/nieuws/artikel/3-17646/sensus-smartguitar&quot;&gt;Sensus Smartguitar’s werelds eerste smartguitar door Mind Music Labs&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;http://www.guitarworld.com/gear-news-electrics/meet-sensus-worlds-first-real-smart-guitar/29086&quot;&gt;Meet Sensus, “The World’s First Real Smart Guitar”&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;http://blog.thethings.io/how-iot-will-change-music/&quot;&gt;How IOT will Changes Music&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;</content><author><name>صدرا املشی</name></author><category term="راک" /><category term="اینترنت اشیاء" /><category term="گیتار" /><category term="گیتار الکتریک" /><category term="ابزار" /><summary type="html">یخچال هوشمند، فِر هوشمند، لامپ هوشمند، حتی قفل هوشمند و.. و… و..، مطمئنا اینا واژه هایی هستن که تو یک یا نهایت دو سال اخیر بارها شنیده ایم و البته در سالهای آینده بیشتر خواهیم شنید. همه دستگاه هایی که نام بردم یا چیزهای دیگه‌ای که خودتون شنیدید در دسته ای به نام اینترنت اشیا یا بطور مخفف IOT قرار میگیرند( البته خیلی ها از دوستان لطف دارن و میگن اینترنت اشیا نه! اینترنت چیزها! بعضی از دوستان هم که خسته ان میگن چیزنت! ) اما واقعا اینترنت اشیا چیه و چه تعریفی داره. بهتره برای روشن شدن ماجرا از ویکی‌پدیا کمک بگیرییم:</summary></entry></feed>